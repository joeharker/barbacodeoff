!function(window){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var paramPrefix,i,SKIP_INDEXES=2,templateArgs=arguments,code=templateArgs[0],message="["+(module?module+":":"")+code+"] ",template=templateArgs[1];for(message+=template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1),shiftedIndex=index+SKIP_INDEXES;return shiftedIndex<templateArgs.length?toDebugString(templateArgs[shiftedIndex]):match}),message+="\nhttp://errors.angularjs.org/1.5.8/"+(module?module+"/":"")+code,i=SKIP_INDEXES,paramPrefix="?";i<templateArgs.length;i++,paramPrefix="&")message+=paramPrefix+"p"+(i-SKIP_INDEXES)+"="+encodeURIComponent(toDebugString(templateArgs[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;if(isArray(obj)||isString(obj)||jqLite&&obj instanceof jqLite)return!0;var length="length"in Object(obj)&&obj.length;return isNumber(length)&&(length>=0&&(length-1 in obj||obj instanceof Array)||"function"==typeof obj.item)}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;key<length;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(isBlankObject(obj))for(key in obj)iterator.call(context,obj[key],key,obj);else if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);return obj}function forEachSorted(obj,iterator,context){for(var keys=Object.keys(obj).sort(),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function baseExtend(dst,objs,deep){for(var h=dst.$$hashKey,i=0,ii=objs.length;i<ii;++i){var obj=objs[i];if(isObject(obj)||isFunction(obj))for(var keys=Object.keys(obj),j=0,jj=keys.length;j<jj;j++){var key=keys[j],src=obj[key];deep&&isObject(src)?isDate(src)?dst[key]=new Date(src.valueOf()):isRegExp(src)?dst[key]=new RegExp(src):src.nodeName?dst[key]=src.cloneNode(!0):isElement(src)?dst[key]=src.clone():(isObject(dst[key])||(dst[key]=isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return setHashKey(dst,h),dst}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function merge(dst){return baseExtend(dst,slice.call(arguments,1),!0)}function toInt(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function hasCustomToString(obj){return isFunction(obj.toString)&&obj.toString!==toString}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isBlankObject(value){return null!==value&&"object"==typeof value&&!getPrototypeOf(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isFormData(obj){return"[object FormData]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isTypedArray(value){return value&&isNumber(value.length)&&TYPED_ARRAY_REGEXP.test(toString.call(value))}function isArrayBuffer(obj){return"[object ArrayBuffer]"===toString.call(obj)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),index}function copy(source,destination){function copyRecurse(source,destination){var key,h=destination.$$hashKey;if(isArray(source))for(var i=0,ii=source.length;i<ii;i++)destination.push(copyElement(source[i]));else if(isBlankObject(source))for(key in source)destination[key]=copyElement(source[key]);else if(source&&"function"==typeof source.hasOwnProperty)for(key in source)source.hasOwnProperty(key)&&(destination[key]=copyElement(source[key]));else for(key in source)hasOwnProperty.call(source,key)&&(destination[key]=copyElement(source[key]));return setHashKey(destination,h),destination}function copyElement(source){if(!isObject(source))return source;var index=stackSource.indexOf(source);if(index!==-1)return stackDest[index];if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var needsRecurse=!1,destination=copyType(source);return void 0===destination&&(destination=isArray(source)?[]:Object.create(getPrototypeOf(source)),needsRecurse=!0),stackSource.push(source),stackDest.push(destination),needsRecurse?copyRecurse(source,destination):destination}function copyType(source){switch(toString.call(source)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new source.constructor(copyElement(source.buffer),source.byteOffset,source.length);case"[object ArrayBuffer]":if(!source.slice){var copied=new ArrayBuffer(source.byteLength);return new Uint8Array(copied).set(new Uint8Array(source)),copied}return source.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new source.constructor(source.valueOf());case"[object RegExp]":var re=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]);return re.lastIndex=source.lastIndex,re;case"[object Blob]":return new source.constructor([source],{type:source.type})}if(isFunction(source.cloneNode))return source.cloneNode(!0)}var stackSource=[],stackDest=[];if(destination){if(isTypedArray(destination)||isArrayBuffer(destination))throw ngMinErr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");return isArray(destination)?destination.length=0:forEach(destination,function(value,key){"$$hashKey"!==key&&delete destination[key]}),stackSource.push(source),stackDest.push(destination),copyRecurse(source,destination)}return copyElement(source)}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return!!isDate(o2)&&equals(o1.getTime(),o2.getTime());if(isRegExp(o1))return!!isRegExp(o2)&&o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2)||isDate(o2)||isRegExp(o2))return!1;keySet=createMap();for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!(key in keySet)&&"$"!==key.charAt(0)&&isDefined(o2[key])&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;key<length;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=void 0:isWindow(value)?val="$WINDOW":value&&window.document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){if(!isUndefined(obj))return isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty)}function fromJson(json){return isString(json)?JSON.parse(json):json}function timezoneToOffset(timezone,fallback){timezone=timezone.replace(ALL_COLONS,"");var requestedTimezoneOffset=Date.parse("Jan 01, 1970 00:00:00 "+timezone)/6e4;return isNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset}function addDateMinutes(date,minutes){return date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+minutes),date}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var dateTimezoneOffset=date.getTimezoneOffset(),timezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset);return addDateMinutes(date,reverse*(timezoneOffset-dateTimezoneOffset))}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={};return forEach((keyValue||"").split("&"),function(keyValue){var splitPoint,key,val;keyValue&&(key=keyValue=keyValue.replace(/\+/g,"%20"),splitPoint=keyValue.indexOf("="),splitPoint!==-1&&(key=keyValue.substring(0,splitPoint),val=keyValue.substring(splitPoint+1)),key=tryDecodeURIComponent(key),isDefined(key)&&(val=!isDefined(val)||tryDecodeURIComponent(val),hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val))}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.getAttribute(attr)))return attr;return null}function angularInit(element,bootstrap){var appElement,module,config={};forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement&&(config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config))}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===window.document?"document":startingTag(element);throw ngMinErr("btstrpd","App already bootstrapped with this element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},void(isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap()))}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;if(!bindJQueryFired){var jqName=jq();jQuery=isUndefined(jqName)?window.jQuery:jqName?window[jqName]:void 0,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){for(var events,elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0}}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;i<len;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){for(var blockNodes,node=nodes[0],endNode=nodes[nodes.length-1],i=1;node!==endNode&&(node=node.nextSibling);i++)(blockNodes||nodes[i]!==node)&&(blockNodes||(blockNodes=jqLite(slice.call(nodes,0,i))),blockNodes.push(node));return blockNodes||nodes}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}function invokeLaterAndSetModuleName(provider,method){return function(recipeName,factoryFunction){return factoryFunction&&isFunction(factoryFunction)&&(factoryFunction.$$moduleName=name),invokeQueue.push([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLaterAndSetModuleName("$provide","provider"),factory:invokeLaterAndSetModuleName("$provide","factory"),service:invokeLaterAndSetModuleName("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),decorator:invokeLaterAndSetModuleName("$provide","decorator"),animation:invokeLaterAndSetModuleName("$animateProvider","register"),filter:invokeLaterAndSetModuleName("$filterProvider","register"),controller:invokeLaterAndSetModuleName("$controllerProvider","register"),directive:invokeLaterAndSetModuleName("$compileProvider","directive"),component:invokeLaterAndSetModuleName("$compileProvider","component"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"...";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):isUndefined(obj)?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,merge:merge,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{$$counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),(angularModule=setupModuleLoader(window))("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$animateCss:$CoreAnimateCssProvider,$$animateJs:$$CoreAnimateJsProvider,$$animateQueue:$$CoreAnimateQueueProvider,$$AnimateRunner:$$AnimateRunnerFactoryProvider,$$animateAsyncRun:$$AnimateAsyncRunFactoryProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$$forceReflow:$$ForceReflowProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpParamSerializer:$HttpParamSerializerProvider,$httpParamSerializerJQLike:$HttpParamSerializerJQLikeProvider,$httpBackend:$HttpBackendProvider,$xhrFactory:$xhrFactoryProvider,$jsonpCallbacks:$jsonpCallbacksProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$jqLite:$$jqLiteProvider,$$HashMap:$$HashMapProvider,$$cookieReader:$$CookieReaderProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteHasData(node){for(var key in jqCache[node.ng339])return!0;return!1}function jqLiteCleanData(nodes){for(var i=0,ii=nodes.length;i<ii;i++)jqLiteRemoveData(nodes[i])}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||window.document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function jqLiteWrapNode(node,wrapper){var parent=node.parentNode;parent&&parent.replaceChild(wrapper,node),wrapper.appendChild(node)}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;i<l;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type){var removeHandler=function(type){var listenerFns=events[type];isDefined(fn)&&arrayRemove(listenerFns||[],fn),isDefined(fn)&&listenerFns&&listenerFns.length>0||(removeEventListenerFn(element,type,handle),delete events[type])};forEach(type.split(" "),function(type){removeHandler(type),MOUSE_EVENT_MAP[type]&&removeHandler(MOUSE_EVENT_MAP[type])})}else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return void delete expandoStore.data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=void 0}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:void 0}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return!!element.getAttribute&&(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),existingClasses.indexOf(" "+cssClass+" ")===-1&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;i<length;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType==NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;i<ii;i++)if(isDefined(value=jqLite.data(element,names[i])))return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(name){return ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return event.immediatePropagationStopped===!0};var handlerWrapper=eventFns.specialHandlerWrapper||defaultHandlerWrapper;eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;i<eventFnsLength;i++)event.isImmediatePropagationStopped()||handlerWrapper(element,event,eventFns[i])}};return eventHandler.elem=element,eventHandler}function defaultHandlerWrapper(element,event,handler){handler.call(element,event)}function specialMouseHandlerWrapper(target,event,handler){var related=event.relatedTarget;related&&(related===target||jqLiteContains.call(target,related))||handler.call(target,event)}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"==objType||"object"==objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function stringifyFn(fn){return Function.prototype.toString.call(fn)+" "}function extractArgs(fn){var fnText=stringifyFn(fn).replace(STRIP_COMMENTS,""),args=fnText.match(ARROW_ARG)||fnText.match(FN_ARGS);return args}function anonFn(fn){var args=extractArgs(fn);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);argDecl=extractArgs(fn),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),
!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){assertArg(isUndefined(modulesToLoad)||isArray(modulesToLoad),"modulesToLoad","not an array");var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;i<ii;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&e.stack.indexOf(e.message)==-1&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function injectionArgs(fn,locals,serviceName){for(var args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName),i=0,length=$inject.length;i<length;i++){var key=$inject[i];if("string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return args}function isClass(func){return!(msie<=11)&&("function"==typeof func&&/^(?:class\b|constructor\()/.test(stringifyFn(func)))}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var args=injectionArgs(fn,locals,serviceName);return isArray(fn)&&(fn=fn[fn.length-1]),isClass(fn)?(args.unshift(null),new(Function.prototype.bind.apply(fn,args))):fn.apply(self,args)}function instantiate(Type,locals,serviceName){var ctor=isArray(Type)?Type[Type.length-1]:Type,args=injectionArgs(Type,locals,serviceName);return args.unshift(null),new(Function.prototype.bind.apply(ctor,args))}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],(!0)),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},protoInstanceInjector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,void 0,serviceName)}),instanceInjector=protoInstanceInjector;providerCache["$injector"+providerSuffix]={$get:valueFn(protoInstanceInjector)};var runBlocks=loadModules(modulesToLoad);return instanceInjector=protoInstanceInjector.get("$injector"),instanceInjector.strictDi=strictDi,forEach(runBlocks,function(fn){fn&&instanceInjector.invoke(fn)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){if("a"===nodeName_(element))return result=element,!0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(hash){hash=isString(hash)?hash:$location.hash();var elm;hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){newVal===oldVal&&""===newVal||jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function mergeClasses(a,b){return a||b?a?b?(isArray(a)&&(a=a.join(" ")),isArray(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType===ELEMENT_NODE)return elm}}function splitClasses(classes){isString(classes)&&(classes=classes.split(" "));var obj=createMap();return forEach(classes,function(klass){klass.length&&(obj[klass]=!0)}),obj}function prepareAnimateOptions(options){return isObject(options)?options:{}}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function getHash(url){var index=url.indexOf("#");return index===-1?"":url.substr(index)}function cacheStateAndFireUrlChange(){pendingLocation=null,cacheState(),fireUrlChange()}function cacheState(){cachedState=getCurrentState(),cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){lastBrowserUrl===self.url()&&lastHistoryState===cachedState||(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}var self=this,location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),pendingLocation=null,getCurrentState=$sniffer.history?function(){try{return history.state}catch(e){}}:noop;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?(sameBase||(pendingLocation=url),replace?location.replace(url):sameBase?location.hash=getHash(url):location.href=url,location.href!==url&&(pendingLocation=url)):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),pendingLocation&&(pendingLocation=url),self}return pendingLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$applicationDestroyed=function(){jqLite(window).off("hashchange popstate",cacheStateAndFireUrlChange)},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return!!pendingDeferIds[deferId]&&(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0)}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data=createMap(),capacity=options&&options.capacity||Number.MAX_VALUE,lruHash=createMap(),freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(!isUndefined(value)){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value}},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}key in data&&(delete data[key],size--)},removeAll:function(){data=createMap(),size=0,lruHash=createMap(),freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function UNINITIALIZED_VALUE(){}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName,isController){var LOCAL_REGEXP=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,bindings=createMap();return forEach(scope,function(definition,scopeName){if(definition in bindingCache)return void(bindings[scopeName]=bindingCache[definition]);var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition,isController?"controller bindings definition":"isolate scope definition");bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName},match[4]&&(bindingCache[definition]=bindings[scopeName])}),bindings}function parseDirectiveBindings(directive,directiveName){var bindings={isolateScope:null,bindToController:null};if(isObject(directive.scope)&&(directive.bindToController===!0?(bindings.bindToController=parseIsolateBindings(directive.scope,directiveName,!0),bindings.isolateScope={}):bindings.isolateScope=parseIsolateBindings(directive.scope,directiveName,!1)),isObject(directive.bindToController)&&(bindings.bindToController=parseIsolateBindings(directive.bindToController,directiveName,!0)),isObject(bindings.bindToController)){var controller=directive.controller,controllerAs=directive.controllerAs;if(!controller)throw $compileMinErr("noctrl","Cannot bind to controller without directive '{0}'s controller.",directiveName);if(!identifierForController(controller,controllerAs))throw $compileMinErr("noident","Cannot bind to controller without identifier for directive '{0}'.",directiveName)}return bindings}function assertValidDirectiveName(name){var letter=name.charAt(0);if(!letter||letter!==lowercase(letter))throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",name);if(name!==name.trim())throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",name)}function getDirectiveRequire(directive){var require=directive.require||directive.controller&&directive.name;return!isArray(require)&&isObject(require)&&forEach(require,function(value,key){var match=value.match(REQUIRE_PREFIX_REGEXP),name=value.substring(match[0].length);name||(require[key]=match[0]+key)}),require}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?:\:([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/,bindingCache=createMap();this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertValidDirectiveName(name),assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=getDirectiveRequire(directive),directive.restrict=directive.restrict||"EA",directive.$$moduleName=directiveFactory.$$moduleName,directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.component=function(name,options){function factory($injector){function makeInjectable(fn){return isFunction(fn)||isArray(fn)?function(tElement,tAttrs){return $injector.invoke(fn,this,{$element:tElement,$attrs:tAttrs})}:fn}var template=options.template||options.templateUrl?options.template:"",ddo={controller:controller,controllerAs:identifierForController(options.controller)||options.controllerAs||"$ctrl",template:makeInjectable(template),templateUrl:makeInjectable(options.templateUrl),transclude:options.transclude,scope:{},bindToController:options.bindings||{},restrict:"E",require:options.require};return forEach(options,function(val,key){"$"===key.charAt(0)&&(ddo[key]=val)}),ddo}var controller=options.controller||function(){};return forEach(options,function(val,key){"$"===key.charAt(0)&&(factory[key]=val,isFunction(controller)&&(controller[key]=val))}),factory.$inject=["$injector"],this.directive(name,factory)},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled};var TTL=10;this.onChangesTtl=function(value){return arguments.length?(TTL=value,this):TTL},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$sce,$animate,$$sanitizeUri){function flushOnChangesQueue(){try{if(!--onChangesTtl)throw onChangesQueue=void 0,$compileMinErr("infchng","{0} $onChanges() iterations reached. Aborting!\n",TTL);$rootScope.$apply(function(){for(var errors=[],i=0,ii=onChangesQueue.length;i<ii;++i)try{onChangesQueue[i]()}catch(e){errors.push(e)}if(onChangesQueue=void 0,errors.length)throw errors})}finally{onChangesTtl++}}function Attributes(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;i<l;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element}function setSpecialAttr(element,attrName,value){specialAttrHolder.innerHTML="<span "+attrName+">";var attributes=specialAttrHolder.firstChild.attributes,attribute=attributes[0];attributes.removeNamedItem(attribute.name),attribute.value=value,element.attributes.setNamedItem(attribute)}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes));for(var NOT_EMPTY=/\S+/,i=0,len=$compileNodes.length;i<len;i++){var domNode=$compileNodes[i];domNode.nodeType===NODE_TYPE_TEXT&&domNode.nodeValue.match(NOT_EMPTY)&&jqLiteWrapNode(domNode,$compileNodes[i]=window.document.createElement("span"))}var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),previousCompileContext&&previousCompileContext.needsNewScope&&(scope=scope.$parent.$new()),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node&&"foreignobject"!==nodeName_(node)&&toString.call(node).match(/SVG/)?"svg":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;i<ii;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,void 0,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:void 0,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){function boundTranscludeFn(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})}var boundSlots=boundTranscludeFn.$$slots=createMap();for(var slotName in transcludeFn.$$slots)transcludeFn.$$slots[slotName]?boundSlots[slotName]=createBoundTranscludeFn(scope,transcludeFn.$$slots[slotName],previousBoundTranscludeFn):boundSlots[slotName]=null;return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;j<jj;j++){var attrStartName=!1,attrEndName=!1;attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=name.replace(PREFIX_REGEXP,"").substr(8).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()}));var multiElementMatch=ngAttrName.match(MULTI_ELEMENT_DIR_RE);multiElementMatch&&directiveIsMultiElement(multiElementMatch[1])&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,!isNgAttr&&attrs.hasOwnProperty(nName)||(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if(className=node.className,isObject(className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:if(11===msie)for(;node.parentNode&&node.nextSibling&&node.nextSibling.nodeType===NODE_TYPE_TEXT;)node.nodeValue=node.nodeValue+node.nextSibling.nodeValue,node.parentNode.removeChild(node.nextSibling);addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective)}return directives.sort(byPriority),directives}function collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective){try{var match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue);if(match){var nName=directiveNormalize(match[1]);addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2]))}}catch(e){}}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType==NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function compilationGenerator(eager,$compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){var compiled;return eager?compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext):function(){return compiled||(compiled=compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext),$compileNodes=transcludeFn=previousCompileContext=null),compiled.apply(this,arguments)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement,slotName){var transcludeControllers;if(isScope(scope)||(slotName=futureParentElement,futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=void 0),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),!slotName)return boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);var slotTranscludeFn=boundTranscludeFn.$$slots[slotName];if(slotTranscludeFn)return slotTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);if(isUndefined(slotTranscludeFn))throw $compileMinErr("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',slotName,startingTag($element))}var i,ii,linkFn,isolateScope,controllerScope,elementControllers,transcludeFn,$element,attrs,scopeBindingInfo;compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),controllerScope=scope,newIsolateScopeDirective?isolateScope=scope.$new(!0):newScopeDirective&&(controllerScope=scope.$parent),boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn,transcludeFn.isSlotFilled=function(slotName){return!!boundTranscludeFn.$$slots[slotName]}),controllerDirectives&&(elementControllers=setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective)),newIsolateScopeDirective&&(compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0),isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,scopeBindingInfo=initializeDirectiveBindings(scope,attrs,isolateScope,isolateScope.$$isolateBindings,newIsolateScopeDirective),scopeBindingInfo.removeWatches&&isolateScope.$on("$destroy",scopeBindingInfo.removeWatches));for(var name in elementControllers){var controllerDirective=controllerDirectives[name],controller=elementControllers[name],bindings=controllerDirective.$$bindings.bindToController;controller.identifier&&bindings?controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective):controller.bindingInfo={};var controllerResult=controller();controllerResult!==controller.instance&&(controller.instance=controllerResult,$element.data("$"+controllerDirective.name+"Controller",controllerResult),controller.bindingInfo.removeWatches&&controller.bindingInfo.removeWatches(),controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective))}for(forEach(controllerDirectives,function(controllerDirective,name){var require=controllerDirective.require;controllerDirective.bindToController&&!isArray(require)&&isObject(require)&&extend(elementControllers[name].instance,getControllers(name,require,$element,elementControllers))}),forEach(elementControllers,function(controller){var controllerInstance=controller.instance;if(isFunction(controllerInstance.$onChanges))try{controllerInstance.$onChanges(controller.bindingInfo.initialChanges)}catch(e){$exceptionHandler(e)}if(isFunction(controllerInstance.$onInit))try{controllerInstance.$onInit()}catch(e){$exceptionHandler(e)}isFunction(controllerInstance.$doCheck)&&(controllerScope.$watch(function(){controllerInstance.$doCheck()}),controllerInstance.$doCheck()),isFunction(controllerInstance.$onDestroy)&&controllerScope.$on("$destroy",function(){controllerInstance.$onDestroy()})}),i=0,ii=preLinkFns.length;i<ii;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);
var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,void 0,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);forEach(elementControllers,function(controller){var controllerInstance=controller.instance;isFunction(controllerInstance.$postLink)&&controllerInstance.$postLink()})}previousCompileContext=previousCompileContext||{};for(var directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,newScopeDirective=previousCompileContext.newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,didScanForMultipleTransclusion=!1,mightHaveMultipleTransclusionError=!1,i=0,ii=directives.length;i<ii;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=void 0,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!didScanForMultipleTransclusion&&(directive.replace&&(directive.templateUrl||directive.template)||directive.transclude&&!directive.$$tlb)){for(var candidateDirective,scanningIndex=i+1;candidateDirective=directives[scanningIndex++];)if(candidateDirective.transclude&&!candidateDirective.$$tlb||candidateDirective.replace&&(candidateDirective.templateUrl||candidateDirective.template)){mightHaveMultipleTransclusionError=!0;break}didScanForMultipleTransclusion=!0}if(!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||createMap(),assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),directiveValue=directive.transclude)if(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue)hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(compile.$$createComment(directiveName,templateAttrs[directiveName])),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),$template[0].$$parentNode=$template[0].parentNode,childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective});else{var slots=createMap();if($template=jqLite(jqLiteClone(compileNode)).contents(),isObject(directiveValue)){$template=[];var slotMap=createMap(),filledSlots=createMap();forEach(directiveValue,function(elementSelector,slotName){var optional="?"===elementSelector.charAt(0);elementSelector=optional?elementSelector.substring(1):elementSelector,slotMap[elementSelector]=slotName,slots[slotName]=null,filledSlots[slotName]=optional}),forEach($compileNode.contents(),function(node){var slotName=slotMap[directiveNormalize(nodeName_(node))];slotName?(filledSlots[slotName]=!0,slots[slotName]=slots[slotName]||[],slots[slotName].push(node)):$template.push(node)}),forEach(filledSlots,function(filled,slotName){if(!filled)throw $compileMinErr("reqslot","Required transclusion slot `{0}` was not filled.",slotName)});for(var slotName in slots)slots[slotName]&&(slots[slotName]=compilationGenerator(mightHaveMultipleTransclusionError,slots[slotName],transcludeFn))}$compileNode.empty(),childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,void 0,void 0,{needsNewScope:directive.$$isolateScope||directive.$$newScope}),childTranscludeFn.$$slots=slots}if(directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));(newIsolateScopeDirective||newScopeDirective)&&markDirectiveScope(templateDirectives,newIsolateScopeDirective,newScopeDirective),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newScopeDirective:newScopeDirective!==directive&&newScopeDirective,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn);var context=directive.$$originalDirective||directive;isFunction(linkFn)?addLinkFns(null,bind(context,linkFn),attrStart,attrEnd):linkFn&&addLinkFns(bind(context,linkFn.pre),bind(context,linkFn.post),attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function getControllers(directiveName,require,$element,elementControllers){var value;if(isString(require)){var match=require.match(REQUIRE_PREFIX_REGEXP),name=require.substring(match[0].length),inheritType=match[1]||match[3],optional="?"===match[2];if("^^"===inheritType?$element=$element.parent():(value=elementControllers&&elementControllers[name],value=value&&value.instance),!value){var dataName="$"+name+"Controller";value=inheritType?$element.inheritedData(dataName):$element.data(dataName)}if(!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",name,directiveName)}else if(isArray(require)){value=[];for(var i=0,ii=require.length;i<ii;i++)value[i]=getControllers(directiveName,require[i],$element,elementControllers)}else isObject(require)&&(value={},forEach(require,function(controller,property){value[property]=getControllers(directiveName,controller,$element,elementControllers)}));return value||null}function setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective){var elementControllers=createMap();for(var controllerKey in controllerDirectives){var directive=controllerDirectives[controllerKey],locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controller=directive.controller;"@"==controller&&(controller=attrs[directive.name]);var controllerInstance=$controller(controller,locals,!0,directive.controllerAs);elementControllers[directive.name]=controllerInstance,$element.data("$"+directive.name+"Controller",controllerInstance.instance)}return elementControllers}function markDirectiveScope(directives,isolateScope,newScope){for(var j=0,jj=directives.length;j<jj;j++)directives[j]=inherit(directives[j],{$$isolateScope:isolateScope,$$newScope:newScope})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)try{if(directive=directives[i],(isUndefined(maxPriority)||maxPriority>directive.priority)&&directive.restrict.indexOf(location)!=-1){if(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),!directive.$$bindings){var bindings=directive.$$bindings=parseDirectiveBindings(directive,directive.name);isObject(bindings.isolateScope)&&(directive.$$isolateBindings=bindings.isolateScope)}tDirectives.push(directive),match=directive}}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr;dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){dst.hasOwnProperty(key)||"$"===key.charAt(0)||(dst[key]=value,"class"!==key&&"style"!==key&&(dstAttr[key]=srcAttr[key]))})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest(templateUrl).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectiveScope(templateDirectives,!0),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){function wrapModuleNameIfDefined(moduleName){return moduleName?" (module: "+moduleName+")":""}if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",previousDirective.name,wrapModuleNameIfDefined(previousDirective.$$moduleName),directive.name,wrapModuleNameIfDefined(directive.$$moduleName),what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=window.document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"form"==tag&&"action"==attrNormalizedName||"img"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var trustedContext=getTrustedContext(node,name);allOrNothing=ALL_OR_NOTHING_ATTRS[name]||allOrNothing;var interpolateFn=$interpolate(value,!0,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers=createMap());if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;i<ii;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;j<jj;j++,j2++)j2<jj?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=window.document.createDocumentFragment();for(i=0;i<removeCount;i++)fragment.appendChild(elementsToRemove[i]);for(jqLite.hasData(firstElementToRemove)&&(jqLite.data(newNode,jqLite.data(firstElementToRemove)),jqLite(firstElementToRemove).off("$destroy")),jqLite.cleanData(fragment.querySelectorAll("*")),i=1;i<removeCount;i++)delete elementsToRemove[i];elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}function initializeDirectiveBindings(scope,attrs,destination,bindings,directive){function recordChanges(key,currentValue,previousValue){isFunction(destination.$onChanges)&&currentValue!==previousValue&&(onChangesQueue||(scope.$$postDigest(flushOnChangesQueue),onChangesQueue=[]),changes||(changes={},onChangesQueue.push(triggerOnChangesHook)),changes[key]&&(previousValue=changes[key].previousValue),changes[key]=new SimpleChange(previousValue,currentValue))}function triggerOnChangesHook(){destination.$onChanges(changes),changes=void 0}var changes,removeWatchCollection=[],initialChanges={};return forEach(bindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,removeWatch,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":optional||hasOwnProperty.call(attrs,attrName)||(destination[scopeName]=attrs[attrName]=void 0),attrs.$observe(attrName,function(value){if(isString(value)||isBoolean(value)){var oldValue=destination[scopeName];recordChanges(scopeName,value,oldValue),destination[scopeName]=value}}),attrs.$$observers[attrName].$$scope=scope,lastValue=attrs[attrName],isString(lastValue)?destination[scopeName]=$interpolate(lastValue)(scope):isBoolean(lastValue)&&(destination[scopeName]=lastValue),initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]);break;case"=":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=destination[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",attrs[attrName],attrName,directive.name)},lastValue=destination[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,destination[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=destination[scopeName]):destination[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0,removeWatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),removeWatchCollection.push(removeWatch);break;case"<":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]);var initialValue=destination[scopeName]=parentGet(scope);initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]),removeWatch=scope.$watch(parentGet,function(newValue,oldValue){if(oldValue===newValue){if(oldValue===initialValue)return;oldValue=initialValue}recordChanges(scopeName,newValue,oldValue),destination[scopeName]=newValue},parentGet.literal),removeWatchCollection.push(removeWatch);break;case"&":if(parentGet=attrs.hasOwnProperty(attrName)?$parse(attrs[attrName]):noop,parentGet===noop&&optional)break;destination[scopeName]=function(locals){return parentGet(scope,locals)}}}),{initialChanges:initialChanges,removeWatches:removeWatchCollection.length&&function(){for(var i=0,ii=removeWatchCollection.length;i<ii;++i)removeWatchCollection[i]()}}}var onChangesQueue,SIMPLE_ATTR_NAME=/^\w/,specialAttrHolder=window.document.createElement("div"),onChangesTtl=TTL;Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&("href"===key||"xlinkHref"===key)||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key&&isDefined(value)){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;i<nbrUrisWith2parts;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||isUndefined(value)?this.$$element.removeAttr(attrName):SIMPLE_ATTR_NAME.test(attrName)?this.$$element.attr(attrName,value):setSpecialAttr(this.$$element[0],attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||!attrs.hasOwnProperty(key)||isUndefined(attrs[key])||fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol&&"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/,MULTI_ELEMENT_DIR_RE=/^(.+)Start$/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile.$$createComment=function(directiveName,comment){var content="";return debugInfoEnabled&&(content=" "+(directiveName||"")+": ",comment&&(content+=comment+" ")),window.document.createComment(content)},compile}]}function SimpleChange(previous,current){this.previousValue=previous,this.currentValue=current}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(i<=1)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function identifierForController(controller,ident){if(ident&&isString(ident))return ident;if(isString(controller)){var match=CNTRL_REG.exec(controller);if(match)return match[3]}}function $ControllerProvider(){var controllers={},globals=!1;this.has=function(name){return controllers.hasOwnProperty(name)},this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(match=expression.match(CNTRL_REG),!match)throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):void 0),assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name);var instantiate;return instantiate=extend(function(){var result=$injector.invoke(expression,instance,locals,constructor);return result!==instance&&(isObject(result)||isFunction(result))&&(instance=result,identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name)),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}function serializeValue(v){return isObject(v)?isDate(v)?v.toISOString():toJson(v):v}function $HttpParamSerializerProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)?forEach(value,function(v){parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(v)))}):parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(value))))}),parts.join("&")}}}function $HttpParamSerializerJQLikeProvider(){this.$get=function(){return function(params){function serialize(toSerialize,prefix,topLevel){null===toSerialize||isUndefined(toSerialize)||(isArray(toSerialize)?forEach(toSerialize,function(value,index){serialize(value,prefix+"["+(isObject(value)?index:"")+"]")}):isObject(toSerialize)&&!isDate(toSerialize)?forEachSorted(toSerialize,function(value,key){serialize(value,prefix+(topLevel?"":"[")+key+(topLevel?"":"]"))}):parts.push(encodeUriQuery(prefix)+"="+encodeUriQuery(serializeValue(toSerialize))))}if(!params)return"";var parts=[];return serialize(params,"",!0),parts.join("&")}}}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();if(tempData){var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)||isJsonLike(tempData))&&(data=fromJson(tempData))}}return data}function isJsonLike(str){var jsonStart=str.match(JSON_START);return jsonStart&&JSON_ENDS[jsonStart[0]].test(str)}function parseHeaders(headers){function fillInParsed(key,val){key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}var i,parsed=createMap();return isString(headers)?forEach(headers.split("\n"),function(line){i=line.indexOf(":"),fillInParsed(lowercase(trim(line.substr(0,i))),trim(line.substr(i+1)))}):isObject(headers)&&forEach(headers,function(headerVal,headerKey){fillInParsed(lowercase(headerKey),trim(headerVal))}),parsed}function headersGetter(headers){var headersObj;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return 200<=status&&status<300}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)||isFormData(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var useLegacyPromise=!0;this.useLegacyPromiseExtensions=function(value){return isDefined(value)?(useLegacyPromise=!!value,this):useLegacyPromise};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$$cookieReader,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function chainInterceptors(promise,interceptors){for(var i=0,ii=interceptors.length;i<ii;){var thenFn=interceptors[i++],rejectFn=interceptors[i++];
promise=promise.then(thenFn,rejectFn)}return interceptors.length=0,promise}function executeHeaderFns(headers,config){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?(headerContent=headerFn(config),null!=headerContent&&(processedHeaders[header]=headerContent)):processedHeaders[header]=headerFn}),processedHeaders}function mergeHeaders(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return executeHeaderFns(reqHeaders,shallowCopy(config))}function serverRequest(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),void 0,config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData).then(transformResponse,transformResponse)}function transformResponse(response){var resp=extend({},response);return resp.data=transformData(response.data,response.headers,response.status,config.transformResponse),isSuccess(response.status)?resp:$q.reject(resp)}if(!isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);if(!isString(requestConfig.url))throw minErr("$http")("badreq","Http request configuration url must be a string.  Received: {0}",requestConfig.url);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse,paramSerializer:defaults.paramSerializer},requestConfig);config.headers=mergeHeaders(requestConfig),config.method=uppercase(config.method),config.paramSerializer=isString(config.paramSerializer)?$injector.get(config.paramSerializer):config.paramSerializer;var requestInterceptors=[],responseInterceptors=[],promise=$q.when(config);return forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&requestInterceptors.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&responseInterceptors.push(interceptor.response,interceptor.responseError)}),promise=chainInterceptors(promise,requestInterceptors),promise=promise.then(serverRequest),promise=chainInterceptors(promise,responseInterceptors),useLegacyPromise?(promise.success=function(fn){return assertArgFn(fn,"fn"),promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return assertArgFn(fn,"fn"),promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise}):(promise.success=$httpMinErrLegacyFn("success"),promise.error=$httpMinErrLegacyFn("error")),promise}function createShortMethods(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend({},config||{},{method:name,url:url}))}})}function createShortMethodsWithData(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend({},config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData){function createApplyHandlers(eventHandlers){if(eventHandlers){var applyHandlers={};return forEach(eventHandlers,function(eventHandler,key){applyHandlers[key]=function(event){function callEventHandler(){eventHandler(event)}useApplyAsync?$rootScope.$applyAsync(callEventHandler):$rootScope.$$phase?callEventHandler():$rootScope.$apply(callEventHandler)}}),applyHandlers}}function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=status>=-1?status:0,(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);idx!==-1&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,url=buildUrl(config.url,config.paramSerializer(config.params));if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache&&(cachedResp=cache.get(url),isDefined(cachedResp)?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK"):cache.put(url,promise)),isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$$cookieReader()[config.xsrfCookieName||defaults.xsrfCookieName]:void 0;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType,createApplyHandlers(config.eventHandlers),createApplyHandlers(config.uploadEventHandlers))}return promise}function buildUrl(url,serializedParams){return serializedParams.length>0&&(url+=(url.indexOf("?")==-1?"?":"&")+serializedParams),url}var defaultCache=$cacheFactory("$http");defaults.paramSerializer=isString(defaults.paramSerializer)?$injector.get(defaults.paramSerializer):defaults.paramSerializer;var reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function $xhrFactoryProvider(){this.$get=function(){return function(){return new window.XMLHttpRequest}}}function $HttpBackendProvider(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function($browser,$jsonpCallbacks,$document,$xhrFactory){return createHttpBackend($browser,$xhrFactory,$browser.defer,$jsonpCallbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackPath,done){url=url.replace("JSON_CALLBACK",callbackPath);var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks.wasCalled(callbackPath)||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType,eventHandlers,uploadEventHandlers){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){isDefined(timeoutId)&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"===lowercase(method))var callbackPath=callbacks.createCallback(url),jsonpDone=jsonpReq(url,callbackPath,function(status,text){var response=200===status&&callbacks.getResponse(callbackPath);completeRequest(callback,status,response,"",text),callbacks.removeCallback(callbackPath)});else{var xhr=createXhr(method,url);xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,forEach(eventHandlers,function(value,key){xhr.addEventListener(key,value)}),forEach(uploadEventHandlers,function(value,key){xhr.upload.addEventListener(key,value)}),withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(isUndefined(post)?null:post)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function stringify(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value}function constantWatchDelegate(scope,listener,objectEquality,constantInterp){var unwatch;return unwatch=scope.$watch(function(scope){return unwatch(),constantInterp(scope)},listener,objectEquality)}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}}if(!text.length||text.indexOf(startSymbol)===-1){var constantInterp;if(!mustHaveExpression){var unescapedText=unescapeText(text);constantInterp=valueFn(unescapedText),constantInterp.exp=text,constantInterp.expressions=[],constantInterp.$$watchDelegate=constantWatchDelegate}return constantInterp}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];index<textLength;){if((startIndex=text.indexOf(startSymbol,index))==-1||(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))==-1){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1&&$interpolateMinErr.throwNoconcat(text),!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;i<ii;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;i<ii;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue})}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q","$browser",function($rootScope,$window,$q,$$q,$browser){function interval(fn,delay,count,invokeApply){function callback(){hasParams?fn.apply(null,args):fn(iteration)}var hasParams=arguments.length>4,args=hasParams?sliceArgs(arguments,4):[],setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.$$intervalId=setInterval(function(){skipApply?$browser.defer(callback):$rootScope.$evalAsync(callback),deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return!!(promise&&promise.$$intervalId in intervals)&&(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0)},interval}]}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=toInt(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function startsWith(haystack,needle){return 0===haystack.lastIndexOf(needle,0)}function stripBaseUrl(base,url){if(startsWith(url,base))return url.substr(base.length)}function stripHash(url){var index=url.indexOf("#");return index==-1?url:url.substr(0,index)}function trimEmptyHash(url){return url.replace(/(#.+)|#$/,"$1")}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,appBaseNoFile,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"",parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=stripBaseUrl(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return isDefined(appUrl=stripBaseUrl(appBase,url))?(prevAppUrl=appUrl,rewrittenUrl=isDefined(appUrl=stripBaseUrl(basePrefix,appUrl))?appBaseNoFile+(stripBaseUrl("/",appUrl)||appUrl):appBase+prevAppUrl):isDefined(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,appBaseNoFile,hashPrefix){parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return startsWith(url,base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutHashUrl,withoutBaseUrl=stripBaseUrl(appBase,url)||stripBaseUrl(appBaseNoFile,url);isUndefined(withoutBaseUrl)||"#"!==withoutBaseUrl.charAt(0)?this.$$html5?withoutHashUrl=withoutBaseUrl:(withoutHashUrl="",isUndefined(withoutBaseUrl)&&(appBase=url,this.replace())):(withoutHashUrl=stripBaseUrl(hashPrefix,withoutBaseUrl),isUndefined(withoutHashUrl)&&(withoutHashUrl=withoutBaseUrl)),parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url,relHref){return stripHash(appBase)==stripHash(url)&&(this.$$parse(url),!0)}}function LocationHashbangInHtml5Url(appBase,appBaseNoFile,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;var appBaseNoFile=stripFile(appBase);$location=new LocationMode(appBase,appBaseNoFile,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!=event.which&&2!=event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),$window.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($location.absUrl())!=trimEmptyHash(initialUrl)&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){return isUndefined(stripBaseUrl(appBaseNoFile,newUrl))?void($window.location.href=newUrl):($rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;newUrl=trimEmptyHash(newUrl),$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),void($rootScope.$$phase||$rootScope.$digest()))}),$rootScope.$watch(function(){var oldUrl=trimEmptyHash($browser.url()),newUrl=trimEmptyHash($location.absUrl()),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==newUrl||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&arg.stack.indexOf(arg.message)===-1?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function getStringValue(name){return name+""}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function ensureSafeAssignContext(obj,fullExpression){if(obj&&(obj===(0).constructor||obj===(!1).constructor||obj==="".constructor||obj==={}.constructor||obj===[].constructor||obj===Function.constructor))throw $parseMinErr("isecaf","Assigning to a constructor is disallowed! Expression: {0}",fullExpression)}function ifDefined(v,d){return"undefined"!=typeof v?v:d}function plusFn(l,r){return"undefined"==typeof l?r:"undefined"==typeof r?l:l+r}function isStateless($filter,filterName){var fn=$filter(filterName);return!fn.$stateful}function findConstantAndWatchExpressions(ast,$filter){var allConstants,argsToWatch;switch(ast.type){case AST.Program:allConstants=!0,forEach(ast.body,function(expr){findConstantAndWatchExpressions(expr.expression,$filter),allConstants=allConstants&&expr.expression.constant}),ast.constant=allConstants;break;case AST.Literal:ast.constant=!0,ast.toWatch=[];break;case AST.UnaryExpression:findConstantAndWatchExpressions(ast.argument,$filter),ast.constant=ast.argument.constant,ast.toWatch=ast.argument.toWatch;break;case AST.BinaryExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.left.toWatch.concat(ast.right.toWatch);break;case AST.LogicalExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.ConditionalExpression:findConstantAndWatchExpressions(ast.test,$filter),findConstantAndWatchExpressions(ast.alternate,$filter),findConstantAndWatchExpressions(ast.consequent,$filter),ast.constant=ast.test.constant&&ast.alternate.constant&&ast.consequent.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.Identifier:ast.constant=!1,ast.toWatch=[ast];break;case AST.MemberExpression:findConstantAndWatchExpressions(ast.object,$filter),ast.computed&&findConstantAndWatchExpressions(ast.property,$filter),ast.constant=ast.object.constant&&(!ast.computed||ast.property.constant),ast.toWatch=[ast];break;case AST.CallExpression:allConstants=!!ast.filter&&isStateless($filter,ast.callee.name),argsToWatch=[],forEach(ast.arguments,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=ast.filter&&isStateless($filter,ast.callee.name)?argsToWatch:[ast];break;case AST.AssignmentExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=[ast];break;case AST.ArrayExpression:allConstants=!0,argsToWatch=[],forEach(ast.elements,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ObjectExpression:allConstants=!0,argsToWatch=[],forEach(ast.properties,function(property){findConstantAndWatchExpressions(property.value,$filter),allConstants=allConstants&&property.value.constant&&!property.computed,property.value.constant||argsToWatch.push.apply(argsToWatch,property.value.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ThisExpression:ast.constant=!1,ast.toWatch=[];break;case AST.LocalsExpression:ast.constant=!1,ast.toWatch=[]}}function getInputs(body){if(1==body.length){var lastExpression=body[0].expression,candidate=lastExpression.toWatch;return 1!==candidate.length?candidate:candidate[0]!==lastExpression?candidate:void 0}}function isAssignable(ast){return ast.type===AST.Identifier||ast.type===AST.MemberExpression}function assignableAST(ast){if(1===ast.body.length&&isAssignable(ast.body[0].expression))return{type:AST.AssignmentExpression,left:ast.body[0].expression,right:{type:AST.NGValueParameter},operator:"="}}function isLiteral(ast){return 0===ast.body.length||1===ast.body.length&&(ast.body[0].expression.type===AST.Literal||ast.body[0].expression.type===AST.ArrayExpression||ast.body[0].expression.type===AST.ObjectExpression)}function isConstant(ast){return ast.constant}function ASTCompiler(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function ASTInterpreter(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function isPossiblyDangerousMemberName(name){return"constructor"==name}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var identStart,identContinue,cacheDefault=createMap(),cacheExpensive=createMap(),literals={true:!0,false:!1,null:null,undefined:void 0};this.addLiteral=function(literalName,literalValue){literals[literalName]=literalValue},this.setIdentifierFns=function(identifierStart,identifierContinue){return identStart=identifierStart,identContinue=identifierContinue,this},this.$get=["$filter",function($filter){function $parse(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(expensiveChecks=expensiveChecks||runningChecksEnabled,typeof exp){case"string":exp=exp.trim(),cacheKey=exp;var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate:parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),expensiveChecks&&(parsedExpression=expensiveChecksInterceptor(parsedExpression)),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}function expensiveChecksInterceptor(fn){function expensiveCheckFn(scope,locals,assign,inputs){var expensiveCheckOldValue=runningChecksEnabled;runningChecksEnabled=!0;try{return fn(scope,locals,assign,inputs)}finally{runningChecksEnabled=expensiveCheckOldValue}}if(!fn)return fn;expensiveCheckFn.$$watchDelegate=fn.$$watchDelegate,expensiveCheckFn.assign=expensiveChecksInterceptor(fn.assign),expensiveCheckFn.constant=fn.constant,
expensiveCheckFn.literal=fn.literal;for(var i=0;fn.inputs&&i<fn.inputs.length;++i)fn.inputs[i]=expensiveChecksInterceptor(fn.inputs[i]);return expensiveCheckFn.inputs=fn.inputs,expensiveCheckFn}function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:("object"!=typeof newValue||(newValue=getValueOf(newValue),"object"!=typeof newValue))&&(newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue)}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var lastResult,inputExpressions=parsedExpression.inputs;if(1===inputExpressions.length){var oldInputValueOf=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValueOf)||(lastResult=parsedExpression(scope,void 0,void 0,[newInputValue]),oldInputValueOf=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality,prettyPrintExpression)}for(var oldInputValueOfValues=[],oldInputValues=[],i=0,ii=inputExpressions.length;i<ii;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck,oldInputValues[i]=null;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;i<ii;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValues[i]=newInputValue,oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope,void 0,void 0,oldInputValues)),lastResult},listener,objectEquality,prettyPrintExpression)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch;return unwatch=scope.$watch(function(scope){return unwatch(),parsedExpression(scope)},listener,objectEquality)}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,useInputs=!1,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals,assign,inputs){var value=useInputs&&inputs?inputs[0]:parsedExpression(scope,locals,assign,inputs);return interceptorFn(value,scope,locals)}:function(scope,locals,assign,inputs){var value=parsedExpression(scope,locals,assign,inputs),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,useInputs=!parsedExpression.inputs,fn.inputs=parsedExpression.inputs?parsedExpression.inputs:[parsedExpression]),fn}var noUnsafeEval=csp().noUnsafeEval,$parseOptions={csp:noUnsafeEval,expensiveChecks:!1,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},$parseOptionsExpensive={csp:noUnsafeEval,expensiveChecks:!0,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},runningChecksEnabled=!1;return $parse.$$runningExpensiveChecks=function(){return runningChecksEnabled},$parse}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,deferred,pending;pending=state.pending,state.processScheduled=!1,state.pending=void 0;for(var i=0,ii=pending.length;i<ii;++i){deferred=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?deferred.resolve(fn(state.value)):1===state.status?deferred.resolve(state.value):deferred.reject(state.value)}catch(e){deferred.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}function race(promises){var deferred=defer();return forEach(promises,function(promise){when(promise).then(deferred.resolve,deferred.reject)}),deferred.promise}var $qMinErr=minErr("$q",TypeError),defer=function(){var d=new Deferred;return d.resolve=simpleBind(d,d.resolve),d.reject=simpleBind(d,d.reject),d.notify=simpleBind(d,d.notify),d};extend(Promise.prototype,{then:function(onFulfilled,onRejected,progressBack){if(isUndefined(onFulfilled)&&isUndefined(onRejected)&&isUndefined(progressBack))return this;var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},catch:function(callback){return this.then(null,callback)},finally:function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}}),extend(Deferred.prototype,{resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){function resolvePromise(val){done||(done=!0,that.$$resolve(val))}function rejectPromise(val){done||(done=!0,that.$$reject(val))}var then,that=this,done=!1;try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,resolvePromise,rejectPromise,simpleBind(this,this.notify))):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){rejectPromise(e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;i<ii;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}});var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},resolve=when,$Q=function(resolver){function resolveFn(value){deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.prototype=Promise.prototype,$Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.resolve=resolve,$Q.all=all,$Q.race=race,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){function createChildScopeClass(parent){function ChildScope(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=nextUid(),this.$$ChildScope=null}return ChildScope.prototype=parent,ChildScope}var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$exceptionHandler","$parse","$browser",function($exceptionHandler,$parse,$browser){function destroyChildScope($event){$event.currentScope.$$destroyed=!0}function cleanUpScope($scope){9===msie&&($scope.$$childHead&&cleanUpScope($scope.$$childHead),$scope.$$nextSibling&&cleanUpScope($scope.$$nextSibling)),$scope.$parent=$scope.$$nextSibling=$scope.$$prevSibling=$scope.$$childHead=$scope.$$childTail=$scope.$root=$scope.$$watchers=null}function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function incrementWatchersCount(current,count){do current.$$watchersCount+=count;while(current=current.$parent)}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=createChildScopeClass(this)),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!=this)&&child.$on("$destroy",destroyChildScope),child},$watch:function(watchExp,listener,objectEquality,prettyPrintExpression){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get,watchExp);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:prettyPrintExpression||watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),incrementWatchersCount(this,1),function(){arrayRemove(array,watcher)>=0&&incrementWatchersCount(scope,-1),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;i<newLength;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)hasOwnProperty.call(newValue,key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)hasOwnProperty.call(newValue,key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,fn,get,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{dirty=!1,current=target;for(var asyncQueuePosition=0;asyncQueuePosition<asyncQueue.length;asyncQueuePosition++){try{asyncTask=asyncQueue[asyncQueuePosition],asyncTask.scope.$eval(asyncTask.expression,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}asyncQueue.length=0;traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if(get=watch.get,(value=get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,fn=watch.fn,fn(value,last===initWatchVal?value:last,current),ttl<5&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$watchersCount&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueuePosition<postDigestQueue.length;)try{postDigestQueue[postDigestQueuePosition++]()}catch(e){$exceptionHandler(e)}postDigestQueue.length=postDigestQueuePosition=0},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===$rootScope&&$browser.$$applicationDestroyed(),incrementWatchersCount(this,-this.$$watchersCount);for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent&&parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent&&parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$$nextSibling=null,cleanUpScope(this)}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:$parse(expr),locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{beginPhase("$apply");try{return this.$eval(expr)}finally{clearPhase()}}catch(e){$exceptionHandler(e)}finally{try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),expr=$parse(expr),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);indexOfListener!==-1&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name,args){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;i<length;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name,args){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;i<length;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[],postDigestQueuePosition=0;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;i<n;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;i<n;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||isUndefined(trustedValue)||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||isUndefined(maybeTrusted)||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&msie<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},isChromePackagedApp=$window.chrome&&$window.chrome.app&&$window.chrome.app.runtime,hasHistoryPushState=!isChromePackagedApp&&$window.history&&$window.history.pushState,android=toInt((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix[0].toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(bodyStyle.webkitTransition),animations=isString(bodyStyle.webkitAnimation))}return{history:!(!hasHistoryPushState||android<4||boxee),hasEvent:function(event){if("input"===event&&msie<=11)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){var httpOptions;this.httpOptions=function(val){return val?(httpOptions=val,this):httpOptions},this.$get=["$templateCache","$http","$q","$sce",function($templateCache,$http,$q,$sce){function handleRequestFn(tpl,ignoreRequestError){function handleError(resp){if(!ignoreRequestError)throw $templateRequestMinErr("tpload","Failed to load template: {0} (HTTP status: {1} {2})",tpl,resp.status,resp.statusText);return $q.reject(resp)}handleRequestFn.totalPendingRequests++,isString(tpl)&&!isUndefined($templateCache.get(tpl))||(tpl=$sce.getTrustedResourceUrl(tpl));var transformResponse=$http.defaults&&$http.defaults.transformResponse;return isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null),$http.get(tpl,extend({cache:$templateCache,transformResponse:transformResponse},httpOptions)).finally(function(){handleRequestFn.totalPendingRequests--}).then(function(response){return $templateCache.put(tpl,response.data),response.data},handleError)}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else bindingName.indexOf(expression)!=-1&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop);var timeoutId,args=sliceArgs(arguments,3),skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn.apply(null,args))}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId];
}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return!!(promise&&promise.$$timeoutId in deferreds)&&(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId))},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $$CookieReader($document){function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var rawDocument=$document[0]||{},lastCookies={},lastCookieString="";return function(){var cookieArray,cookie,i,index,name,currentCookieString=rawDocument.cookie||"";if(currentCookieString!==lastCookieString)for(lastCookieString=currentCookieString,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),isUndefined(lastCookies[name])&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}}function $$CookieReaderProvider(){this.$get=$$CookieReader}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator,anyPropertyKey){if(!isArrayLike(array)){if(null==array)return array;throw minErr("filter")("notarray","Expected array but received: {0}",array)}anyPropertyKey=anyPropertyKey||"$";var predicateFn,matchAgainstAnyProp,expressionType=getTypeForFilter(expression);switch(expressionType){case"function":predicateFn=expression;break;case"boolean":case"null":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp);break;default:return array}return Array.prototype.filter.call(array,predicateFn)}}function createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp){var predicateFn,shouldMatchPrimitives=isObject(expression)&&anyPropertyKey in expression;return comparator===!0?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return!isUndefined(actual)&&(null===actual||null===expected?actual===expected:!(isObject(expected)||isObject(actual)&&!hasCustomToString(actual))&&(actual=lowercase(""+actual),expected=lowercase(""+expected),actual.indexOf(expected)!==-1))}),predicateFn=function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression[anyPropertyKey],comparator,anyPropertyKey,!1):deepCompare(item,expression,comparator,anyPropertyKey,matchAgainstAnyProp)}}function deepCompare(actual,expected,comparator,anyPropertyKey,matchAgainstAnyProp,dontMatchWholeObject){var actualType=getTypeForFilter(actual),expectedType=getTypeForFilter(expected);if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,anyPropertyKey,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,anyPropertyKey,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if("$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,anyPropertyKey,!0))return!0;return!dontMatchWholeObject&&deepCompare(actual,expected,comparator,anyPropertyKey,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)&&!isUndefined(expectedVal)){var matchAnyProperty=key===anyPropertyKey,actualVal=matchAnyProperty?actual:actual[key];if(!deepCompare(actualVal,expectedVal,comparator,anyPropertyKey,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function getTypeForFilter(val){return null===val?"null":typeof val}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function parse(numStr){var digits,numberOfIntegerDigits,i,j,zeros,exponent=0;for((numberOfIntegerDigits=numStr.indexOf(DECIMAL_SEP))>-1&&(numStr=numStr.replace(DECIMAL_SEP,"")),(i=numStr.search(/e/i))>0?(numberOfIntegerDigits<0&&(numberOfIntegerDigits=i),numberOfIntegerDigits+=+numStr.slice(i+1),numStr=numStr.substring(0,i)):numberOfIntegerDigits<0&&(numberOfIntegerDigits=numStr.length),i=0;numStr.charAt(i)==ZERO_CHAR;i++);if(i==(zeros=numStr.length))digits=[0],numberOfIntegerDigits=1;else{for(zeros--;numStr.charAt(zeros)==ZERO_CHAR;)zeros--;for(numberOfIntegerDigits-=i,digits=[],j=0;i<=zeros;i++,j++)digits[j]=+numStr.charAt(i)}return numberOfIntegerDigits>MAX_DIGITS&&(digits=digits.splice(0,MAX_DIGITS-1),exponent=numberOfIntegerDigits-1,numberOfIntegerDigits=1),{d:digits,e:exponent,i:numberOfIntegerDigits}}function roundNumber(parsedNumber,fractionSize,minFrac,maxFrac){var digits=parsedNumber.d,fractionLen=digits.length-parsedNumber.i;fractionSize=isUndefined(fractionSize)?Math.min(Math.max(minFrac,fractionLen),maxFrac):+fractionSize;var roundAt=fractionSize+parsedNumber.i,digit=digits[roundAt];if(roundAt>0){digits.splice(Math.max(parsedNumber.i,roundAt));for(var j=roundAt;j<digits.length;j++)digits[j]=0}else{fractionLen=Math.max(0,fractionLen),parsedNumber.i=1,digits.length=Math.max(1,roundAt=fractionSize+1),digits[0]=0;for(var i=1;i<roundAt;i++)digits[i]=0}if(digit>=5)if(roundAt-1<0){for(var k=0;k>roundAt;k--)digits.unshift(0),parsedNumber.i++;digits.unshift(1),parsedNumber.i++}else digits[roundAt-1]++;for(;fractionLen<Math.max(0,fractionSize);fractionLen++)digits.push(0);var carry=digits.reduceRight(function(carry,d,i,digits){return d+=carry,digits[i]=d%10,Math.floor(d/10)},0);carry&&(digits.unshift(carry),parsedNumber.i++)}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isString(number)&&!isNumber(number)||isNaN(number))return"";var parsedNumber,isInfinity=!isFinite(number),isZero=!1,numStr=Math.abs(number)+"",formattedText="";if(isInfinity)formattedText="∞";else{parsedNumber=parse(numStr),roundNumber(parsedNumber,fractionSize,pattern.minFrac,pattern.maxFrac);var digits=parsedNumber.d,integerLen=parsedNumber.i,exponent=parsedNumber.e,decimals=[];for(isZero=digits.reduce(function(isZero,d){return isZero&&!d},!0);integerLen<0;)digits.unshift(0),integerLen++;integerLen>0?decimals=digits.splice(integerLen,digits.length):(decimals=digits,digits=[0]);var groups=[];for(digits.length>=pattern.lgSize&&groups.unshift(digits.splice(-pattern.lgSize,digits.length).join(""));digits.length>pattern.gSize;)groups.unshift(digits.splice(-pattern.gSize,digits.length).join(""));digits.length&&groups.unshift(digits.join("")),formattedText=groups.join(groupSep),decimals.length&&(formattedText+=decimalSep+decimals.join("")),exponent&&(formattedText+="e+"+exponent)}return number<0&&!isZero?pattern.negPre+formattedText+pattern.negSuf:pattern.posPre+formattedText+pattern.posSuf}function padNumber(num,digits,trim,negWrap){var neg="";for((num<0||negWrap&&num<=0)&&(negWrap?num=-num+1:(num=-num,neg="-")),num=""+num;num.length<digits;)num=ZERO_CHAR+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim,negWrap){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&offset==-12&&(value=12),padNumber(value,size,trim,negWrap)}}function dateStrGetter(name,shortForm,standAlone){return function(date,formats){var value=date["get"+name](),propPrefix=(standAlone?"STANDALONE":"")+(shortForm?"SHORT":""),get=uppercase(propPrefix+name);return formats[get][value]}}function timeZoneGetter(date,formats,offset){var zone=-1*offset,paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(dayOfWeekOnFirst<=4?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()))}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1]}function longEraGetter(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?toInt(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date)||!isFinite(date.getTime()))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);var dateTimezoneOffset=date.getTimezoneOffset();return timezone&&(dateTimezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset),date=convertTimezoneToLocal(date,timezone,!0)),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS,dateTimezoneOffset):"''"===value?"'":value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}function limitToFilter(){return function(input,limit,begin){return limit=Math.abs(Number(limit))===1/0?Number(limit):toInt(limit),isNaN(limit)?input:(isNumber(input)&&(input=input.toString()),isArrayLike(input)?(begin=!begin||isNaN(begin)?0:toInt(begin),begin=begin<0?Math.max(0,input.length+begin):begin,limit>=0?sliceFn(input,begin,begin+limit):0===begin?sliceFn(input,limit,input.length):sliceFn(input,Math.max(0,begin+limit),begin)):input)}}function sliceFn(input,begin,end){return isString(input)?input.slice(begin,end):slice.call(input,begin,end)}function orderByFilter($parse){function processPredicates(sortPredicates){return sortPredicates.map(function(predicate){var descending=1,get=identity;if(isFunction(predicate))get=predicate;else if(isString(predicate)&&("+"!=predicate.charAt(0)&&"-"!=predicate.charAt(0)||(descending="-"==predicate.charAt(0)?-1:1,predicate=predicate.substring(1)),""!==predicate&&(get=$parse(predicate),get.constant))){var key=get();get=function(value){return value[key]}}return{get:get,descending:descending}})}function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function objectValue(value){return isFunction(value.valueOf)&&(value=value.valueOf(),isPrimitive(value))?value:hasCustomToString(value)&&(value=value.toString(),isPrimitive(value))?value:value}function getPredicateValue(value,index){var type=typeof value;return null===value?(type="string",value="null"):"object"===type&&(value=objectValue(value)),{value:value,type:type,index:index}}function defaultCompare(v1,v2){var result=0,type1=v1.type,type2=v2.type;if(type1===type2){var value1=v1.value,value2=v2.value;"string"===type1?(value1=value1.toLowerCase(),value2=value2.toLowerCase()):"object"===type1&&(isObject(value1)&&(value1=v1.index),isObject(value2)&&(value2=v2.index)),value1!==value2&&(result=value1<value2?-1:1)}else result=type1<type2?-1:1;return result}return function(array,sortPredicate,reverseOrder,compareFn){function getComparisonObject(value,index){return{value:value,tieBreaker:{value:index,type:"number",index:index},predicateValues:predicates.map(function(predicate){return getPredicateValue(predicate.get(value),index)})}}function doComparison(v1,v2){for(var i=0,ii=predicates.length;i<ii;i++){var result=compare(v1.predicateValues[i],v2.predicateValues[i]);if(result)return result*predicates[i].descending*descending}return compare(v1.tieBreaker,v2.tieBreaker)*descending}if(null==array)return array;if(!isArrayLike(array))throw minErr("orderBy")("notarray","Expected array but received: {0}",array);isArray(sortPredicate)||(sortPredicate=[sortPredicate]),0===sortPredicate.length&&(sortPredicate=["+"]);var predicates=processPredicates(sortPredicate),descending=reverseOrder?-1:1,compare=isFunction(compareFn)?compareFn:defaultCompare,compareValues=Array.prototype.map.call(array,getComparisonObject);return compareValues.sort(doComparison),array=compareValues.map(function(item){return item.value})}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[];form.$error={},form.$$success={},form.$pending=void 0,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,form.$$parentForm=nullFormCtrl,form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control),control.$$parentForm=form},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$$success,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control),control.$$parentForm=nullFormCtrl},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,controller){var list=object[property];if(list){var index=list.indexOf(controller);index===-1&&list.push(controller)}else object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])},$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,form.$$parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,form.$$parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var timeout,listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||15<key&&key<19||37<=key&&key<=40||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),PARTIAL_VALIDATION_TYPES[type]&&ctrl.$$hasNativeValidators&&type===attr.type&&element.on(PARTIAL_VALIDATION_EVENTS,function(ev){if(!timeout){var validity=this[VALIDITY_STATE_PROPERTY],origBadInput=validity.badInput,origTypeMismatch=validity.typeMismatch;timeout=$browser.defer(function(){timeout=null,validity.badInput===origBadInput&&validity.typeMismatch===origTypeMismatch||listener(ev)})}}),ctrl.$render=function(){var value=ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue;element.val()!==value&&element.val(value)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return NaN}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'==iso.charAt(0)&&'"'==iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return NaN}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)&&!isDate(val)?parseDate(val)||void 0:val}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return timezone&&(parsedDate=convertTimezoneToLocal(parsedDate,timezone)),parsedDate}}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw ngModelMinErr("datefmt","Expected `{0}` to be a date",value);return isValidDate(value)?(previousDate=value,previousDate&&timezone&&(previousDate=convertTimezoneToLocal(previousDate,timezone,!0)),$filter("date")(value,format,timezone)):(previousDate=null,"")}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput||validity.typeMismatch?void 0:value})}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):void 0}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),minVal=isNumber(val)&&!isNaN(val)?val:void 0,ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||value<=maxVal},attr.$observe("max",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),maxVal=isNumber(val)&&!isNaN(val)?val:void 0,ctrl.$validate()})}}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw ngModelMinErr("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){var classes=[];return isArray(classVal)?(forEach(classVal,function(v){classes=classes.concat(arrayClasses(v))}),classes):isString(classVal)?classVal.split(" "):isObject(classVal)?(forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes):classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||createMap(),classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),toRemove&&toRemove.length&&$animate.removeClass(element,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||(1&scope.$index)===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=isArray(newVal)?newVal.map(function(v){return shallowCopy(v)}):shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(value){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,controller){isUndefined(state)?createAndSet("$pending",validationErrorKey,controller):unsetAndCleanup("$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,controller),set(ctrl.$$success,validationErrorKey,controller)):(set(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)):(unset(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=void 0,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?void 0:!ctrl.$error[validationErrorKey]&&(!!ctrl.$$success[validationErrorKey]||null),toggleValidationCss(validationErrorKey,combinedState),ctrl.$$parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,controller){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,controller)}function unsetAndCleanup(name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller),isObjectEmpty(ctrl[name])&&(ctrl[name]=void 0)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}function chromeHack(optionElement){optionElement[0].hasAttribute("selected")&&(optionElement[0].selected=!0)}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",hasOwnProperty=Object.prototype.hasOwnProperty,lowercase=function(string){return isString(string)?string.toLowerCase():string},uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(ch.charCodeAt(0)&-33)}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,getPrototypeOf=Object.getPrototypeOf,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=window.document.documentMode,noop.$inject=[],identity.$inject=[];var isArray=Array.isArray,TYPED_ARRAY_REGEXP=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){function noUnsafeEval(){try{return new Function(""),!1}catch(e){return!0}}if(!isDefined(csp.rules)){var ngCspElement=window.document.querySelector("[ng-csp]")||window.document.querySelector("[data-ng-csp]");if(ngCspElement){var ngCspAttribute=ngCspElement.getAttribute("ng-csp")||ngCspElement.getAttribute("data-ng-csp");csp.rules={noUnsafeEval:!ngCspAttribute||ngCspAttribute.indexOf("no-unsafe-eval")!==-1,noInlineStyle:!ngCspAttribute||ngCspAttribute.indexOf("no-inline-style")!==-1
}}else csp.rules={noUnsafeEval:noUnsafeEval(),noInlineStyle:!1}}return csp.rules},jq=function(){if(isDefined(jq.name_))return jq.name_;var el,i,prefix,name,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(prefix=ngAttrPrefixes[i],el=window.document.querySelector("["+prefix.replace(":","\\:")+"jq]")){name=el.getAttribute(prefix+"jq");break}return jq.name_=name},ALL_COLONS=/:/g,ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_ATTRIBUTE=2,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.5.8",major:1,minor:5,dot:8,codeName:"arbitrary-fallbacks"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:-]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var jqLiteContains=window.Node.prototype.contains||function(arg){return!!(16&this.compareDocumentPosition(arg))},JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===window.document.readyState?window.setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData,hasData:jqLiteHasData,cleanData:jqLiteCleanData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?void(element.style[name]=value):element.style[name]},attr:function(element,name,value){var nodeType=element.nodeType;if(nodeType!==NODE_TYPE_TEXT&&nodeType!==NODE_TYPE_ATTRIBUTE&&nodeType!==NODE_TYPE_COMMENT){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:void 0;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?void 0:ret}}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),void(element.innerHTML=value))},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&isUndefined(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)){if(isObject(arg1)){for(i=0;i<nodeCount;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=isUndefined(value)?Math.min(nodeCount,1):nodeCount,j=0;j<jj;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;i<nodeCount;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length,addHandler=function(type,specialHandlerWrapper,noEventListener){var eventFns=events[type];eventFns||(eventFns=events[type]=[],eventFns.specialHandlerWrapper=specialHandlerWrapper,"$destroy"===type||noEventListener||addEventListenerFn(element,type,handle)),eventFns.push(fn)};i--;)type=types[i],MOUSE_EVENT_MAP[type]?(addHandler(MOUSE_EVENT_MAP[type],specialMouseHandlerWrapper),addHandler(type,void 0,!0)):addHandler(type)}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;i<ii;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){jqLiteWrapNode(element,jqLite(wrapNode).eq(0).clone()[0])},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;i<ii;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;i<ii;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var $$HashMapProvider=[function(){this.$get=[function(){return HashMap}]}],ARROW_ARG=/^([^\(]+?)=>/,FN_ARGS=/^[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),ELEMENT_NODE=1,NG_ANIMATE_CLASSNAME="ng-animate",$$CoreAnimateJsProvider=function(){this.$get=noop},$$CoreAnimateQueueProvider=function(){var postDigestQueue=new HashMap,postDigestElements=[];this.$get=["$$AnimateRunner","$rootScope",function($$AnimateRunner,$rootScope){function updateData(data,classes,value){var changed=!1;return classes&&(classes=isString(classes)?classes.split(" "):isArray(classes)?classes:[],forEach(classes,function(className){className&&(changed=!0,data[className]=value)})),changed}function handleCSSClassChanges(){forEach(postDigestElements,function(element){var data=postDigestQueue.get(element);if(data){var existing=splitClasses(element.attr("class")),toAdd="",toRemove="";forEach(data,function(status,className){var hasClass=!!existing[className];status!==hasClass&&(status?toAdd+=(toAdd.length?" ":"")+className:toRemove+=(toRemove.length?" ":"")+className)}),forEach(element,function(elm){toAdd&&jqLiteAddClass(elm,toAdd),toRemove&&jqLiteRemoveClass(elm,toRemove)}),postDigestQueue.remove(element)}}),postDigestElements.length=0}function addRemoveClassesPostDigest(element,add,remove){var data=postDigestQueue.get(element)||{},classesAdded=updateData(data,add,!0),classesRemoved=updateData(data,remove,!1);(classesAdded||classesRemoved)&&(postDigestQueue.put(element,data),postDigestElements.push(element),1===postDigestElements.length&&$rootScope.$$postDigest(handleCSSClassChanges))}return{enabled:noop,on:noop,off:noop,pin:noop,push:function(element,event,options,domOperation){domOperation&&domOperation(),options=options||{},options.from&&element.css(options.from),options.to&&element.css(options.to),(options.addClass||options.removeClass)&&addRemoveClassesPostDigest(element,options.addClass,options.removeClass);var runner=new $$AnimateRunner;return runner.complete(),runner}}}]},$AnimateProvider=["$provide",function($provide){var provider=this;this.$$registeredAnimations=Object.create(null),this.register=function(name,factory){if(name&&"."!==name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);var key=name+"-animation";provider.$$registeredAnimations[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){if(1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null,this.$$classNameFilter)){var reservedRegex=new RegExp("(\\s+|\\/)"+NG_ANIMATE_CLASSNAME+"(\\s+|\\/)");if(reservedRegex.test(this.$$classNameFilter.toString()))throw $animateMinErr("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',NG_ANIMATE_CLASSNAME)}return this.$$classNameFilter},this.$get=["$$animateQueue",function($$animateQueue){function domInsert(element,parentElement,afterElement){if(afterElement){var afterNode=extractElementNode(afterElement);!afterNode||afterNode.parentNode||afterNode.previousElementSibling||(afterElement=null)}afterElement?afterElement.after(element):parentElement.prepend(element)}return{on:$$animateQueue.on,off:$$animateQueue.off,pin:$$animateQueue.pin,enabled:$$animateQueue.enabled,cancel:function(runner){runner.end&&runner.end()},enter:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"enter",prepareAnimateOptions(options))},move:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"move",prepareAnimateOptions(options))},leave:function(element,options){return $$animateQueue.push(element,"leave",prepareAnimateOptions(options),function(){element.remove()})},addClass:function(element,className,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addclass,className),$$animateQueue.push(element,"addClass",options)},removeClass:function(element,className,options){return options=prepareAnimateOptions(options),options.removeClass=mergeClasses(options.removeClass,className),$$animateQueue.push(element,"removeClass",options)},setClass:function(element,add,remove,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addClass,add),options.removeClass=mergeClasses(options.removeClass,remove),$$animateQueue.push(element,"setClass",options)},animate:function(element,from,to,className,options){return options=prepareAnimateOptions(options),options.from=options.from?extend(options.from,from):from,options.to=options.to?extend(options.to,to):to,className=className||"ng-inline-animate",options.tempClasses=mergeClasses(options.tempClasses,className),$$animateQueue.push(element,"animate",options)}}}]}],$$AnimateAsyncRunFactoryProvider=function(){this.$get=["$$rAF",function($$rAF){function waitForTick(fn){waitQueue.push(fn),waitQueue.length>1||$$rAF(function(){for(var i=0;i<waitQueue.length;i++)waitQueue[i]();waitQueue=[]})}var waitQueue=[];return function(){var passed=!1;return waitForTick(function(){passed=!0}),function(callback){passed?callback():waitForTick(callback)}}}]},$$AnimateRunnerFactoryProvider=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function($q,$sniffer,$$animateAsyncRun,$document,$timeout){function AnimateRunner(host){this.setHost(host);var rafTick=$$animateAsyncRun(),timeoutTick=function(fn){$timeout(fn,0,!1)};this._doneCallbacks=[],this._tick=function(fn){var doc=$document[0];doc&&doc.hidden?timeoutTick(fn):rafTick(fn)},this._state=0}var INITIAL_STATE=0,DONE_PENDING_STATE=1,DONE_COMPLETE_STATE=2;return AnimateRunner.chain=function(chain,callback){function next(){return index===chain.length?void callback(!0):void chain[index](function(response){return response===!1?void callback(!1):(index++,void next())})}var index=0;next()},AnimateRunner.all=function(runners,callback){function onProgress(response){status=status&&response,++count===runners.length&&callback(status)}var count=0,status=!0;forEach(runners,function(runner){runner.done(onProgress)})},AnimateRunner.prototype={setHost:function(host){this.host=host||{}},done:function(fn){this._state===DONE_COMPLETE_STATE?fn():this._doneCallbacks.push(fn)},progress:noop,getPromise:function(){if(!this.promise){var self=this;this.promise=$q(function(resolve,reject){self.done(function(status){status===!1?reject():resolve()})})}return this.promise},then:function(resolveHandler,rejectHandler){return this.getPromise().then(resolveHandler,rejectHandler)},catch:function(handler){return this.getPromise().catch(handler)},finally:function(handler){return this.getPromise().finally(handler)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(response){var self=this;self._state===INITIAL_STATE&&(self._state=DONE_PENDING_STATE,self._tick(function(){self._resolve(response)}))},_resolve:function(response){this._state!==DONE_COMPLETE_STATE&&(forEach(this._doneCallbacks,function(fn){fn(response)}),this._doneCallbacks.length=0,this._state=DONE_COMPLETE_STATE)}},AnimateRunner}]},$CoreAnimateCssProvider=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function($$rAF,$q,$$AnimateRunner){return function(element,initialOptions){function run(){return $$rAF(function(){applyAnimationContents(),closed||runner.complete(),closed=!0}),runner}function applyAnimationContents(){options.addClass&&(element.addClass(options.addClass),options.addClass=null),options.removeClass&&(element.removeClass(options.removeClass),options.removeClass=null),options.to&&(element.css(options.to),options.to=null)}var options=initialOptions||{};options.$$prepared||(options=copy(options)),options.cleanupStyles&&(options.from=options.to=null),options.from&&(element.css(options.from),options.from=null);var closed,runner=new $$AnimateRunner;return{start:run,end:run}}}]},$compileMinErr=minErr("$compile"),_UNINITIALIZED_VALUE=new UNINITIALIZED_VALUE;$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"],SimpleChange.prototype.isFirstChange=function(){return this.previousValue===_UNINITIALIZED_VALUE};var PREFIX_REGEXP=/^((?:x|data)[\:\-_])/i,$controllerMinErr=minErr("$controller"),CNTRL_REG=/^(\S+)(\s+as\s+([\w$]+))?$/,$$ForceReflowProvider=function(){this.$get=["$document",function($document){return function(domNode){return domNode?!domNode.nodeType&&domNode instanceof jqLite&&(domNode=domNode[0]):domNode=$document[0].body,domNode.offsetWidth+1}}]},APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$httpMinErr=minErr("$http"),$httpMinErrLegacyFn=function(method){return function(){throw $httpMinErr("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",method)}},$interpolateMinErr=angular.$interpolateMinErr=minErr("$interpolate");$interpolateMinErr.throwNoconcat=function(text){throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text)},$interpolateMinErr.interr=function(text,err){return $interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString())};var $jsonpCallbacksProvider=function(){this.$get=["$window",function($window){function createCallback(callbackId){var callback=function(data){callback.data=data,callback.called=!0};return callback.id=callbackId,callback}var callbacks=$window.angular.callbacks,callbackMap={};return{createCallback:function(url){var callbackId="_"+(callbacks.$$counter++).toString(36),callbackPath="angular.callbacks."+callbackId,callback=createCallback(callbackId);return callbackMap[callbackPath]=callbacks[callbackId]=callback,callbackPath},wasCalled:function(callbackPath){return callbackMap[callbackPath].called},getResponse:function(callbackPath){return callbackMap[callbackPath].data},removeCallback:function(callbackPath){var callback=callbackMap[callbackPath];delete callbacks[callback.id],delete callbackMap[callbackPath]}}}]},PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS=createMap();forEach("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(operator){OPERATORS[operator]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return chars.indexOf(ch)!==-1},peek:function(i){var num=i||1;return this.index+num<this.text.length&&this.text.charAt(this.index+num)},isNumber:function(ch){return"0"<=ch&&ch<="9"&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"\t"===ch||"\n"===ch||"\v"===ch||" "===ch},isIdentifierStart:function(ch){return this.options.isIdentifierStart?this.options.isIdentifierStart(ch,this.codePointAt(ch)):this.isValidIdentifierStart(ch)},isValidIdentifierStart:function(ch){return"a"<=ch&&ch<="z"||"A"<=ch&&ch<="Z"||"_"===ch||"$"===ch},isIdentifierContinue:function(ch){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(ch,this.codePointAt(ch)):this.isValidIdentifierContinue(ch)},isValidIdentifierContinue:function(ch,cp){return this.isValidIdentifierStart(ch,cp)||this.isNumber(ch)},codePointAt:function(ch){return 1===ch.length?ch.charCodeAt(0):(ch.charCodeAt(0)<<10)+ch.charCodeAt(1)-56613888},peekMultichar:function(){var ch=this.text.charAt(this.index),peek=this.peek();if(!peek)return ch;var cp1=ch.charCodeAt(0),cp2=peek.charCodeAt(0);return cp1>=55296&&cp1<=56319&&cp2>=56320&&cp2<=57343?ch+peek:ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){var start=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var ch=this.peekMultichar();if(!this.isIdentifierContinue(ch))break;this.index+=ch.length}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var AST=function(lexer,options){this.lexer=lexer,this.options=options};AST.Program="Program",AST.ExpressionStatement="ExpressionStatement",AST.AssignmentExpression="AssignmentExpression",AST.ConditionalExpression="ConditionalExpression",AST.LogicalExpression="LogicalExpression",AST.BinaryExpression="BinaryExpression",AST.UnaryExpression="UnaryExpression",AST.CallExpression="CallExpression",AST.MemberExpression="MemberExpression",AST.Identifier="Identifier",AST.Literal="Literal",AST.ArrayExpression="ArrayExpression",AST.Property="Property",AST.ObjectExpression="ObjectExpression",AST.ThisExpression="ThisExpression",AST.LocalsExpression="LocalsExpression",AST.NGValueParameter="NGValueParameter",AST.prototype={ast:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value},program:function(){for(var body=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&body.push(this.expressionStatement()),!this.expect(";"))return{type:AST.Program,body:body}},expressionStatement:function(){return{type:AST.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},expression:function(){return this.assignment()},assignment:function(){var result=this.ternary();return this.expect("=")&&(result={type:AST.AssignmentExpression,left:result,right:this.assignment(),operator:"="}),result},ternary:function(){var alternate,consequent,test=this.logicalOR();return this.expect("?")&&(alternate=this.expression(),this.consume(":"))?(consequent=this.expression(),{type:AST.ConditionalExpression,test:test,alternate:alternate,consequent:consequent}):test},logicalOR:function(){for(var left=this.logicalAND();this.expect("||");)left={type:AST.LogicalExpression,operator:"||",left:left,right:this.logicalAND()};return left},logicalAND:function(){for(var left=this.equality();this.expect("&&");)left={type:AST.LogicalExpression,operator:"&&",left:left,right:this.equality()};return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.relational()};return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.additive()};return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.multiplicative()};return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.unary()};return left},unary:function(){var token;return(token=this.expect("+","-","!"))?{type:AST.UnaryExpression,operator:token.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?primary=copy(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?primary={type:AST.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next;next=this.expect("(","[",".");)"("===next.text?(primary={type:AST.CallExpression,callee:primary,arguments:this.parseArguments()},this.consume(")")):"["===next.text?(primary={type:AST.MemberExpression,object:primary,property:this.expression(),computed:!0},this.consume("]")):"."===next.text?primary={type:AST.MemberExpression,object:primary,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return primary},filter:function(baseExpression){for(var args=[baseExpression],result={type:AST.CallExpression,callee:this.identifier(),arguments:args,filter:!0};this.expect(":");)args.push(this.expression());return result},parseArguments:function(){var args=[];if(")"!==this.peekToken().text)do args.push(this.filterChain());while(this.expect(","));return args},identifier:function(){var token=this.consume();return token.identifier||this.throwError("is not a valid identifier",token),{type:AST.Identifier,name:token.text}},constant:function(){return{type:AST.Literal,value:this.consume().value}},arrayDeclaration:function(){var elements=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elements.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:AST.ArrayExpression,elements:elements}},object:function(){var property,properties=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;property={type:AST.Property,kind:"init"},this.peek().constant?(property.key=this.constant(),
property.computed=!1,this.consume(":"),property.value=this.expression()):this.peek().identifier?(property.key=this.identifier(),property.computed=!1,this.peek(":")?(this.consume(":"),property.value=this.expression()):property.value=property.key):this.peek("[")?(this.consume("["),property.key=this.expression(),this.consume("]"),property.computed=!0,this.consume(":"),property.value=this.expression()):this.throwError("invalid key",this.peek()),properties.push(property)}while(this.expect(","));return this.consume("}"),{type:AST.ObjectExpression,properties:properties}},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return!!token&&(this.tokens.shift(),token)},selfReferential:{this:{type:AST.ThisExpression},$locals:{type:AST.LocalsExpression}}},ASTCompiler.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.state={nextId:0,filters:{},expensiveChecks:expensiveChecks,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},findConstantAndWatchExpressions(ast,self.$filter);var assignable,extra="";if(this.stage="assign",assignable=assignableAST(ast)){this.state.computing="assign";var result=this.nextId();this.recurse(assignable,result),this.return_(result),extra="fn.assign="+this.generateFunction("assign","s,v,l")}var toWatch=getInputs(ast.body);self.stage="inputs",forEach(toWatch,function(watch,key){var fnKey="fn"+key;self.state[fnKey]={vars:[],body:[],own:{}},self.state.computing=fnKey;var intoId=self.nextId();self.recurse(watch,intoId),self.return_(intoId),self.state.inputs.push(fnKey),watch.watchId=key}),this.state.computing="fn",this.stage="main",this.recurse(ast);var fnString='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+extra+this.watchFns()+"return fn;",fn=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",fnString)(this.$filter,ensureSafeMemberName,ensureSafeObject,ensureSafeFunction,getStringValue,ensureSafeAssignContext,ifDefined,plusFn,expression);return this.state=this.stage=void 0,fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},USE:"use",STRICT:"strict",watchFns:function(){var result=[],fns=this.state.inputs,self=this;return forEach(fns,function(name){result.push("var "+name+"="+self.generateFunction(name,"s"))}),fns.length&&result.push("fn.inputs=["+fns.join(",")+"];"),result.join("")},generateFunction:function(name,params){return"function("+params+"){"+this.varsPrefix(name)+this.body(name)+"};"},filterPrefix:function(){var parts=[],self=this;return forEach(this.state.filters,function(id,filter){parts.push(id+"=$filter("+self.escape(filter)+")")}),parts.length?"var "+parts.join(",")+";":""},varsPrefix:function(section){return this.state[section].vars.length?"var "+this.state[section].vars.join(",")+";":""},body:function(section){return this.state[section].body.join("")},recurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var left,right,args,expression,computed,self=this;if(recursionFn=recursionFn||noop,!skipWatchIdCheck&&isDefined(ast.watchId))return intoId=intoId||this.nextId(),void this.if_("i",this.lazyAssign(intoId,this.computedMember("i",ast.watchId)),this.lazyRecurse(ast,intoId,nameId,recursionFn,create,!0));switch(ast.type){case AST.Program:forEach(ast.body,function(expression,pos){self.recurse(expression.expression,void 0,void 0,function(expr){right=expr}),pos!==ast.body.length-1?self.current().body.push(right,";"):self.return_(right)});break;case AST.Literal:expression=this.escape(ast.value),this.assign(intoId,expression),recursionFn(expression);break;case AST.UnaryExpression:this.recurse(ast.argument,void 0,void 0,function(expr){right=expr}),expression=ast.operator+"("+this.ifDefined(right,0)+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.BinaryExpression:this.recurse(ast.left,void 0,void 0,function(expr){left=expr}),this.recurse(ast.right,void 0,void 0,function(expr){right=expr}),expression="+"===ast.operator?this.plus(left,right):"-"===ast.operator?this.ifDefined(left,0)+ast.operator+this.ifDefined(right,0):"("+left+")"+ast.operator+"("+right+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.LogicalExpression:intoId=intoId||this.nextId(),self.recurse(ast.left,intoId),self.if_("&&"===ast.operator?intoId:self.not(intoId),self.lazyRecurse(ast.right,intoId)),recursionFn(intoId);break;case AST.ConditionalExpression:intoId=intoId||this.nextId(),self.recurse(ast.test,intoId),self.if_(intoId,self.lazyRecurse(ast.alternate,intoId),self.lazyRecurse(ast.consequent,intoId)),recursionFn(intoId);break;case AST.Identifier:intoId=intoId||this.nextId(),nameId&&(nameId.context="inputs"===self.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",ast.name)+"?l:s"),nameId.computed=!1,nameId.name=ast.name),ensureSafeMemberName(ast.name),self.if_("inputs"===self.stage||self.not(self.getHasOwnProperty("l",ast.name)),function(){self.if_("inputs"===self.stage||"s",function(){create&&1!==create&&self.if_(self.not(self.nonComputedMember("s",ast.name)),self.lazyAssign(self.nonComputedMember("s",ast.name),"{}")),self.assign(intoId,self.nonComputedMember("s",ast.name))})},intoId&&self.lazyAssign(intoId,self.nonComputedMember("l",ast.name))),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.name))&&self.addEnsureSafeObject(intoId),recursionFn(intoId);break;case AST.MemberExpression:left=nameId&&(nameId.context=this.nextId())||this.nextId(),intoId=intoId||this.nextId(),self.recurse(ast.object,left,void 0,function(){self.if_(self.notNull(left),function(){create&&1!==create&&self.addEnsureSafeAssignContext(left),ast.computed?(right=self.nextId(),self.recurse(ast.property,right),self.getStringValue(right),self.addEnsureSafeMemberName(right),create&&1!==create&&self.if_(self.not(self.computedMember(left,right)),self.lazyAssign(self.computedMember(left,right),"{}")),expression=self.ensureSafeObject(self.computedMember(left,right)),self.assign(intoId,expression),nameId&&(nameId.computed=!0,nameId.name=right)):(ensureSafeMemberName(ast.property.name),create&&1!==create&&self.if_(self.not(self.nonComputedMember(left,ast.property.name)),self.lazyAssign(self.nonComputedMember(left,ast.property.name),"{}")),expression=self.nonComputedMember(left,ast.property.name),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.property.name))&&(expression=self.ensureSafeObject(expression)),self.assign(intoId,expression),nameId&&(nameId.computed=!1,nameId.name=ast.property.name))},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)},!!create);break;case AST.CallExpression:intoId=intoId||this.nextId(),ast.filter?(right=self.filter(ast.callee.name),args=[],forEach(ast.arguments,function(expr){var argument=self.nextId();self.recurse(expr,argument),args.push(argument)}),expression=right+"("+args.join(",")+")",self.assign(intoId,expression),recursionFn(intoId)):(right=self.nextId(),left={},args=[],self.recurse(ast.callee,right,left,function(){self.if_(self.notNull(right),function(){self.addEnsureSafeFunction(right),forEach(ast.arguments,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(self.ensureSafeObject(argument))})}),left.name?(self.state.expensiveChecks||self.addEnsureSafeObject(left.context),expression=self.member(left.context,left.name,left.computed)+"("+args.join(",")+")"):expression=right+"("+args.join(",")+")",expression=self.ensureSafeObject(expression),self.assign(intoId,expression)},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)}));break;case AST.AssignmentExpression:if(right=this.nextId(),left={},!isAssignable(ast.left))throw $parseMinErr("lval","Trying to assign a value to a non l-value");this.recurse(ast.left,void 0,left,function(){self.if_(self.notNull(left.context),function(){self.recurse(ast.right,right),self.addEnsureSafeObject(self.member(left.context,left.name,left.computed)),self.addEnsureSafeAssignContext(left.context),expression=self.member(left.context,left.name,left.computed)+ast.operator+right,self.assign(intoId,expression),recursionFn(intoId||expression)})},1);break;case AST.ArrayExpression:args=[],forEach(ast.elements,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(argument)})}),expression="["+args.join(",")+"]",this.assign(intoId,expression),recursionFn(expression);break;case AST.ObjectExpression:args=[],computed=!1,forEach(ast.properties,function(property){property.computed&&(computed=!0)}),computed?(intoId=intoId||this.nextId(),this.assign(intoId,"{}"),forEach(ast.properties,function(property){property.computed?(left=self.nextId(),self.recurse(property.key,left)):left=property.key.type===AST.Identifier?property.key.name:""+property.key.value,right=self.nextId(),self.recurse(property.value,right),self.assign(self.member(intoId,left,property.computed),right)})):(forEach(ast.properties,function(property){self.recurse(property.value,ast.constant?void 0:self.nextId(),void 0,function(expr){args.push(self.escape(property.key.type===AST.Identifier?property.key.name:""+property.key.value)+":"+expr)})}),expression="{"+args.join(",")+"}",this.assign(intoId,expression)),recursionFn(intoId||expression);break;case AST.ThisExpression:this.assign(intoId,"s"),recursionFn("s");break;case AST.LocalsExpression:this.assign(intoId,"l"),recursionFn("l");break;case AST.NGValueParameter:this.assign(intoId,"v"),recursionFn("v")}},getHasOwnProperty:function(element,property){var key=element+"."+property,own=this.current().own;return own.hasOwnProperty(key)||(own[key]=this.nextId(!1,element+"&&("+this.escape(property)+" in "+element+")")),own[key]},assign:function(id,value){if(id)return this.current().body.push(id,"=",value,";"),id},filter:function(filterName){return this.state.filters.hasOwnProperty(filterName)||(this.state.filters[filterName]=this.nextId(!0)),this.state.filters[filterName]},ifDefined:function(id,defaultValue){return"ifDefined("+id+","+this.escape(defaultValue)+")"},plus:function(left,right){return"plus("+left+","+right+")"},return_:function(id){this.current().body.push("return ",id,";")},if_:function(test,alternate,consequent){if(test===!0)alternate();else{var body=this.current().body;body.push("if(",test,"){"),alternate(),body.push("}"),consequent&&(body.push("else{"),consequent(),body.push("}"))}},not:function(expression){return"!("+expression+")"},notNull:function(expression){return expression+"!=null"},nonComputedMember:function(left,right){var SAFE_IDENTIFIER=/[$_a-zA-Z][$_a-zA-Z0-9]*/,UNSAFE_CHARACTERS=/[^$_a-zA-Z0-9]/g;return SAFE_IDENTIFIER.test(right)?left+"."+right:left+'["'+right.replace(UNSAFE_CHARACTERS,this.stringEscapeFn)+'"]'},computedMember:function(left,right){return left+"["+right+"]"},member:function(left,right,computed){return computed?this.computedMember(left,right):this.nonComputedMember(left,right)},addEnsureSafeObject:function(item){this.current().body.push(this.ensureSafeObject(item),";")},addEnsureSafeMemberName:function(item){this.current().body.push(this.ensureSafeMemberName(item),";")},addEnsureSafeFunction:function(item){this.current().body.push(this.ensureSafeFunction(item),";")},addEnsureSafeAssignContext:function(item){this.current().body.push(this.ensureSafeAssignContext(item),";")},ensureSafeObject:function(item){return"ensureSafeObject("+item+",text)"},ensureSafeMemberName:function(item){return"ensureSafeMemberName("+item+",text)"},ensureSafeFunction:function(item){return"ensureSafeFunction("+item+",text)"},getStringValue:function(item){this.assign(item,"getStringValue("+item+")")},ensureSafeAssignContext:function(item){return"ensureSafeAssignContext("+item+",text)"},lazyRecurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var self=this;return function(){self.recurse(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck)}},lazyAssign:function(id,value){var self=this;return function(){self.assign(id,value)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)},escape:function(value){if(isString(value))return"'"+value.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(isNumber(value))return value.toString();if(value===!0)return"true";if(value===!1)return"false";if(null===value)return"null";if("undefined"==typeof value)return"undefined";throw $parseMinErr("esc","IMPOSSIBLE")},nextId:function(skip,init){var id="v"+this.state.nextId++;return skip||this.current().vars.push(id+(init?"="+init:"")),id},current:function(){return this.state[this.state.computing]}},ASTInterpreter.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.expression=expression,this.expensiveChecks=expensiveChecks,findConstantAndWatchExpressions(ast,self.$filter);var assignable,assign;(assignable=assignableAST(ast))&&(assign=this.recurse(assignable));var inputs,toWatch=getInputs(ast.body);toWatch&&(inputs=[],forEach(toWatch,function(watch,key){var input=self.recurse(watch);watch.input=input,inputs.push(input),watch.watchId=key}));var expressions=[];forEach(ast.body,function(expression){expressions.push(self.recurse(expression.expression))});var fn=0===ast.body.length?noop:1===ast.body.length?expressions[0]:function(scope,locals){var lastValue;return forEach(expressions,function(exp){lastValue=exp(scope,locals)}),lastValue};return assign&&(fn.assign=function(scope,value,locals){return assign(scope,locals,value)}),inputs&&(fn.inputs=inputs),fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},recurse:function(ast,context,create){var left,right,args,self=this;if(ast.input)return this.inputs(ast.input,ast.watchId);switch(ast.type){case AST.Literal:return this.value(ast.value,context);case AST.UnaryExpression:return right=this.recurse(ast.argument),this["unary"+ast.operator](right,context);case AST.BinaryExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.LogicalExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.ConditionalExpression:return this["ternary?:"](this.recurse(ast.test),this.recurse(ast.alternate),this.recurse(ast.consequent),context);case AST.Identifier:return ensureSafeMemberName(ast.name,self.expression),self.identifier(ast.name,self.expensiveChecks||isPossiblyDangerousMemberName(ast.name),context,create,self.expression);case AST.MemberExpression:return left=this.recurse(ast.object,!1,!!create),ast.computed||(ensureSafeMemberName(ast.property.name,self.expression),right=ast.property.name),ast.computed&&(right=this.recurse(ast.property)),ast.computed?this.computedMember(left,right,context,create,self.expression):this.nonComputedMember(left,right,self.expensiveChecks,context,create,self.expression);case AST.CallExpression:return args=[],forEach(ast.arguments,function(expr){args.push(self.recurse(expr))}),ast.filter&&(right=this.$filter(ast.callee.name)),ast.filter||(right=this.recurse(ast.callee,!0)),ast.filter?function(scope,locals,assign,inputs){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));var value=right.apply(void 0,values,inputs);return context?{context:void 0,name:void 0,value:value}:value}:function(scope,locals,assign,inputs){var value,rhs=right(scope,locals,assign,inputs);if(null!=rhs.value){ensureSafeObject(rhs.context,self.expression),ensureSafeFunction(rhs.value,self.expression);for(var values=[],i=0;i<args.length;++i)values.push(ensureSafeObject(args[i](scope,locals,assign,inputs),self.expression));value=ensureSafeObject(rhs.value.apply(rhs.context,values),self.expression)}return context?{value:value}:value};case AST.AssignmentExpression:return left=this.recurse(ast.left,!0,1),right=this.recurse(ast.right),function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs);return ensureSafeObject(lhs.value,self.expression),ensureSafeAssignContext(lhs.context),lhs.context[lhs.name]=rhs,context?{value:rhs}:rhs};case AST.ArrayExpression:return args=[],forEach(ast.elements,function(expr){args.push(self.recurse(expr))}),function(scope,locals,assign,inputs){for(var value=[],i=0;i<args.length;++i)value.push(args[i](scope,locals,assign,inputs));return context?{value:value}:value};case AST.ObjectExpression:return args=[],forEach(ast.properties,function(property){property.computed?args.push({key:self.recurse(property.key),computed:!0,value:self.recurse(property.value)}):args.push({key:property.key.type===AST.Identifier?property.key.name:""+property.key.value,computed:!1,value:self.recurse(property.value)})}),function(scope,locals,assign,inputs){for(var value={},i=0;i<args.length;++i)args[i].computed?value[args[i].key(scope,locals,assign,inputs)]=args[i].value(scope,locals,assign,inputs):value[args[i].key]=args[i].value(scope,locals,assign,inputs);return context?{value:value}:value};case AST.ThisExpression:return function(scope){return context?{value:scope}:scope};case AST.LocalsExpression:return function(scope,locals){return context?{value:locals}:locals};case AST.NGValueParameter:return function(scope,locals,assign){return context?{value:assign}:assign}}},"unary+":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?+arg:0,context?{value:arg}:arg}},"unary-":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?-arg:0,context?{value:arg}:arg}},"unary!":function(argument,context){return function(scope,locals,assign,inputs){var arg=!argument(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary+":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=plusFn(lhs,rhs);return context?{value:arg}:arg}},"binary-":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=(isDefined(lhs)?lhs:0)-(isDefined(rhs)?rhs:0);return context?{value:arg}:arg}},"binary*":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)*right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary/":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)/right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary%":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)%right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary===":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)===right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary&&":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)&&right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary||":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)||right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"ternary?:":function(test,alternate,consequent,context){return function(scope,locals,assign,inputs){var arg=test(scope,locals,assign,inputs)?alternate(scope,locals,assign,inputs):consequent(scope,locals,assign,inputs);return context?{value:arg}:arg}},value:function(value,context){return function(){return context?{context:void 0,name:void 0,value:value}:value}},identifier:function(name,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var base=locals&&name in locals?locals:scope;create&&1!==create&&base&&!base[name]&&(base[name]={});var value=base?base[name]:void 0;return expensiveChecks&&ensureSafeObject(value,expression),context?{context:base,name:name,value:value}:value}},computedMember:function(left,right,context,create,expression){return function(scope,locals,assign,inputs){var rhs,value,lhs=left(scope,locals,assign,inputs);return null!=lhs&&(rhs=right(scope,locals,assign,inputs),rhs=getStringValue(rhs),ensureSafeMemberName(rhs,expression),create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[rhs]&&(lhs[rhs]={})),value=lhs[rhs],ensureSafeObject(value,expression)),context?{context:lhs,name:rhs,value:value}:value}},nonComputedMember:function(left,right,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs);create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[right]&&(lhs[right]={}));var value=null!=lhs?lhs[right]:void 0;return(expensiveChecks||isPossiblyDangerousMemberName(right))&&ensureSafeObject(value,expression),context?{context:lhs,name:right,value:value}:value}},inputs:function(input,watchId){return function(scope,value,locals,inputs){return inputs?inputs[watchId]:input(scope,value,locals)}}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options,this.ast=new AST(lexer,options),this.astCompiler=options.csp?new ASTInterpreter(this.ast,$filter):new ASTCompiler(this.ast,$filter)};Parser.prototype={constructor:Parser,parse:function(text){return this.astCompiler.compile(text,this.options.expensiveChecks)}};var objectValueOf=Object.prototype.valueOf,$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$templateRequestMinErr=minErr("$compile"),urlParsingNode=window.document.createElement("a"),originUrl=urlResolve(window.location.href);$$CookieReader.$inject=["$document"],$FilterProvider.$inject=["$provide"];var MAX_DIGITS=22,DECIMAL_SEP=".",ZERO_CHAR="0";currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DATE_FORMATS={yyyy:dateGetter("FullYear",4,0,!1,!0),yy:dateGetter("FullYear",2,0,!0,!0),y:dateGetter("FullYear",1,0,!1,!0),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),LLLL:dateStrGetter("Month",!1,!0),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:longEraGetter},DATE_FORMATS_SPLIT=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){if(!attr.href&&!attr.xlinkHref)return function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){function defaultLinkFn(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName),linkFn=defaultLinkFn;"checked"===propName&&(linkFn=function(scope,element,attr){attr.ngModel!==attr[normalized]&&defaultLinkFn(scope,element,attr)}),ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:linkFn}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"==attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout","$parse",function($timeout,$parse){function getSetter(expression){return""===expression?$parse('this[""]').assign:$parse(expression).assign||noop}var formDirective={name:"form",restrict:isNgForm?"EAC":"E",require:["form","^^?form"],controller:FormController,compile:function(formElement,attr){formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS);var nameAttr=attr.name?"name":!(!isNgForm||!attr.ngForm)&&"ngForm";return{pre:function(scope,formElement,attr,ctrls){var controller=ctrls[0];if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=ctrls[1]||controller.$$parentForm;parentFormCtrl.$addControl(controller);var setter=nameAttr?getSetter(controller.$name):noop;nameAttr&&(setter(scope,controller),attr.$observe(nameAttr,function(newValue){controller.$name!==newValue&&(setter(scope,void 0),controller.$$parentForm.$$renameControl(controller,newValue),(setter=getSetter(controller.$name))(scope,controller))})),formElement.on("$destroy",function(){controller.$$parentForm.$removeControl(controller),setter(scope,void 0),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,URL_REGEXP=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:\/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,DATE_REGEXP=/^(\d{4,})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4,})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4,})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,PARTIAL_VALIDATION_EVENTS="keydown wheel mousedown",PARTIAL_VALIDATION_TYPES=createMap();forEach("date,datetime-local,month,time,week".split(","),function(type){PARTIAL_VALIDATION_TYPES[type]=!0});var inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),
element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(val){return $sce.valueOf(val)});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){var value=ngBindHtmlGetter(scope);element.html($sce.getTrustedHtml(value)||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",void 0),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate","$compile",function($animate,$compile){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=$compile.$$createComment("end ngIf",$attr.ngIf),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate",function($templateRequest,$anchorScroll,$animate){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch(srcExp,function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(!scope.$$destroyed&&thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){scope.$$destroyed||thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return toString.call($element[0]).match(/SVG/)?($element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,window.document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element})):($element.html(ctrl.template),void $compile($element.contents())(scope))}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){if(isArray(value))return value.join(ngList)}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",EMPTY_CLASS="ng-empty",NOT_EMPTY_CLASS="ng-not-empty",ngModelMinErr=minErr("ngModel"),NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=$interpolate($attr.name||"",!1)($scope),this.$$parentForm=nullFormCtrl;var parserValid,parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope,newValue){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:newValue}):parsedNgModelAssign($scope,newValue)}}else if(!parsedNgModel.assign)throw ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value},this.$$updateEmptyClasses=function(value){ctrl.$isEmpty(value)?($animate.removeClass($element,NOT_EMPTY_CLASS),$animate.addClass($element,EMPTY_CLASS)):($animate.removeClass($element,EMPTY_CLASS),$animate.addClass($element,NOT_EMPTY_CLASS))};var currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),ctrl.$$parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumber(ctrl.$modelValue)||!isNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:void 0,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(modelValue,viewValue,doneCallback){function processParseErrors(){var errorKey=ctrl.$$parserName||"parse";return isUndefined(parserValid)?(setValidity(errorKey,null),!0):(parserValid||(forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)})),setValidity(errorKey,parserValid),parserValid)}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),!!syncValidatorsValid||(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw ngModelMinErr("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,void 0),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors()&&processSyncValidators()?void processAsyncValidators():void validationDone(!1)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue;if(parserValid=!isUndefined(modelValue)||void 0)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumber(ctrl.$modelValue)&&isNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(modelValue,ctrl.$$lastCommittedViewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:void 0,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,ctrl.$options&&!ctrl.$options.updateOnDefault||ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce.default)&&(debounceDelay=debounce.default)),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue&&(ctrl.$modelValue===ctrl.$modelValue||modelValue===modelValue)){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue,parserValid=void 0;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(modelValue,viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||modelCtrl.$$parentForm;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&modelCtrl.$$parentForm.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){modelCtrl.$$parentForm.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;this.$options=copy($scope.$eval($attrs.ngModelOptions)),isDefined(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngOptionsMinErr=minErr("ngOptions"),NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ngOptionsDirective=["$compile","$document","$parse",function($compile,$document,$parse){function parseOptionsExpression(optionsExp,selectElement,scope){function Option(selectValue,viewValue,label,group,disabled){this.selectValue=selectValue,this.viewValue=viewValue,this.label=label,this.group=group,this.disabled=disabled}function getOptionValuesKeys(optionValues){var optionValuesKeys;if(!keyName&&isArrayLike(optionValues))optionValuesKeys=optionValues;else{optionValuesKeys=[];for(var itemKey in optionValues)optionValues.hasOwnProperty(itemKey)&&"$"!==itemKey.charAt(0)&&optionValuesKeys.push(itemKey)}return optionValuesKeys}var match=optionsExp.match(NG_OPTIONS_REGEXP);if(!match)throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var valueName=match[5]||match[7],keyName=match[6],selectAs=/ as /.test(match[0])&&match[1],trackBy=match[9],valueFn=$parse(match[2]?match[1]:valueName),selectAsFn=selectAs&&$parse(selectAs),viewValueFn=selectAsFn||valueFn,trackByFn=trackBy&&$parse(trackBy),getTrackByValueFn=trackBy?function(value,locals){return trackByFn(scope,locals)}:function(value){return hashKey(value)},getTrackByValue=function(value,key){return getTrackByValueFn(value,getLocals(value,key))},displayFn=$parse(match[2]||match[1]),groupByFn=$parse(match[3]||""),disableWhenFn=$parse(match[4]||""),valuesFn=$parse(match[8]),locals={},getLocals=keyName?function(value,key){return locals[keyName]=key,locals[valueName]=value,locals}:function(value){return locals[valueName]=value,locals};return{trackBy:trackBy,getTrackByValue:getTrackByValue,getWatchables:$parse(valuesFn,function(optionValues){var watchedArray=[];optionValues=optionValues||[];for(var optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),selectValue=getTrackByValueFn(value,locals);if(watchedArray.push(selectValue),match[2]||match[1]){var label=displayFn(scope,locals);watchedArray.push(label)}if(match[4]){var disableWhen=disableWhenFn(scope,locals);watchedArray.push(disableWhen)}}return watchedArray}),getOptions:function(){for(var optionItems=[],selectValueMap={},optionValues=valuesFn(scope)||[],optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),viewValue=viewValueFn(scope,locals),selectValue=getTrackByValueFn(viewValue,locals),label=displayFn(scope,locals),group=groupByFn(scope,locals),disabled=disableWhenFn(scope,locals),optionItem=new Option(selectValue,viewValue,label,group,disabled);optionItems.push(optionItem),selectValueMap[selectValue]=optionItem}return{items:optionItems,selectValueMap:selectValueMap,getOptionFromViewValue:function(value){return selectValueMap[getTrackByValue(value)]},getViewValueFromOption:function(option){return trackBy?angular.copy(option.viewValue):option.viewValue}}}}}function ngOptionsPostLink(scope,selectElement,attr,ctrls){function addOptionElement(option,parent){var optionElement=optionTemplate.cloneNode(!1);parent.appendChild(optionElement),updateOptionElement(option,optionElement)}function updateOptionElement(option,element){option.element=element,element.disabled=option.disabled,option.label!==element.label&&(element.label=option.label,element.textContent=option.label),option.value!==element.value&&(element.value=option.selectValue)}function updateOptions(){var previousValue=options&&selectCtrl.readValue();if(options)for(var i=options.items.length-1;i>=0;i--){var option=options.items[i];jqLiteRemove(isDefined(option.group)?option.element.parentNode:option.element)}options=ngOptions.getOptions();var groupElementMap={};if(providedEmptyOption&&selectElement.prepend(emptyOption),options.items.forEach(function(option){var groupElement;isDefined(option.group)?(groupElement=groupElementMap[option.group],groupElement||(groupElement=optGroupTemplate.cloneNode(!1),listFragment.appendChild(groupElement),groupElement.label=null===option.group?"null":option.group,groupElementMap[option.group]=groupElement),addOptionElement(option,groupElement)):addOptionElement(option,listFragment)}),selectElement[0].appendChild(listFragment),ngModelCtrl.$render(),!ngModelCtrl.$isEmpty(previousValue)){var nextValue=selectCtrl.readValue(),isNotPrimitive=ngOptions.trackBy||multiple;(isNotPrimitive?equals(previousValue,nextValue):previousValue===nextValue)||(ngModelCtrl.$setViewValue(nextValue),ngModelCtrl.$render())}}for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,i=0,children=selectElement.children(),ii=children.length;i<ii;i++)if(""===children[i].value){emptyOption=children.eq(i);break}var providedEmptyOption=!!emptyOption,unknownOption=jqLite(optionTemplate.cloneNode(!1));unknownOption.val("?");var options,ngOptions=parseOptionsExpression(attr.ngOptions,selectElement,scope),listFragment=$document[0].createDocumentFragment(),renderEmptyOption=function(){providedEmptyOption||selectElement.prepend(emptyOption),selectElement.val(""),emptyOption.prop("selected",!0),emptyOption.attr("selected",!0)},removeEmptyOption=function(){providedEmptyOption||emptyOption.remove()},renderUnknownOption=function(){selectElement.prepend(unknownOption),selectElement.val("?"),unknownOption.prop("selected",!0),unknownOption.attr("selected",!0)},removeUnknownOption=function(){unknownOption.remove()};multiple?(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length},selectCtrl.writeValue=function(value){options.items.forEach(function(option){option.element.selected=!1}),value&&value.forEach(function(item){var option=options.getOptionFromViewValue(item);option&&(option.element.selected=!0)})},selectCtrl.readValue=function(){var selectedValues=selectElement.val()||[],selections=[];return forEach(selectedValues,function(value){var option=options.selectValueMap[value];option&&!option.disabled&&selections.push(options.getViewValueFromOption(option))}),selections},ngOptions.trackBy&&scope.$watchCollection(function(){if(isArray(ngModelCtrl.$viewValue))return ngModelCtrl.$viewValue.map(function(value){return ngOptions.getTrackByValue(value)})},function(){ngModelCtrl.$render()})):(selectCtrl.writeValue=function(value){var option=options.getOptionFromViewValue(value);option?(selectElement[0].value!==option.selectValue&&(removeUnknownOption(),removeEmptyOption(),selectElement[0].value=option.selectValue,option.element.selected=!0),option.element.setAttribute("selected","selected")):null===value||providedEmptyOption?(removeUnknownOption(),renderEmptyOption()):(removeEmptyOption(),renderUnknownOption())},selectCtrl.readValue=function(){var selectedOption=options.selectValueMap[selectElement.val()];return selectedOption&&!selectedOption.disabled?(removeEmptyOption(),removeUnknownOption(),options.getViewValueFromOption(selectedOption)):null},ngOptions.trackBy&&scope.$watch(function(){return ngOptions.getTrackByValue(ngModelCtrl.$viewValue)},function(){ngModelCtrl.$render()})),providedEmptyOption?(emptyOption.remove(),$compile(emptyOption)(scope),emptyOption.removeClass("ng-scope")):emptyOption=jqLite(optionTemplate.cloneNode(!1)),selectElement.empty(),updateOptions(),scope.$watchCollection(ngOptions.getWatchables,updateOptions)}var optionTemplate=window.document.createElement("option"),optGroupTemplate=window.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(scope,selectElement,attr,ctrls){ctrls[0].registerOption=noop},post:ngOptionsPostLink}}}],ngPluralizeDirective=["$locale","$interpolate","$log",function($locale,$interpolate,$log){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNaN(count);if(countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),count!==lastCount&&!(countIsNaN&&isNumber(lastCount)&&isNaN(lastCount))){watchRemover();var whenExpFn=whensExpFns[count];isUndefined(whenExpFn)?(null!=newVal&&$log.debug("ngPluralize: no rule defined for '"+count+"' in "+whenExp),watchRemover=noop,updateElementText()):watchRemover=scope.$watch(whenExpFn,updateElementText),lastCount=count}})}}}],ngRepeatDirective=["$parse","$animate","$compile",function($parse,$animate,$compile){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=$compile.$$createComment("end ngRepeat",expression),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)hasOwnProperty.call(collection,itemKey)&&"$"!==itemKey.charAt(0)&&collectionKeys.push(itemKey)}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:void 0,clone:void 0},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;index<length;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockNodes(block.clone),null,previousNode),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,previousNode),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate","$compile",function($animate,$compile){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;i<ii;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;i<ii;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=$compile.$$createComment("end ngSwitchWhen");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeMinErr=minErr("ngTransclude"),ngTranscludeDirective=["$compile",function($compile){return{restrict:"EAC",terminal:!0,compile:function(tElement){
var fallbackLinkFn=$compile(tElement.contents());return tElement.empty(),function($scope,$element,$attrs,controller,$transclude){function ngTranscludeCloneAttachFn(clone,transcludedScope){clone.length?$element.append(clone):(useFallbackContent(),transcludedScope.$destroy())}function useFallbackContent(){fallbackLinkFn($scope,function(clone){$element.append(clone)})}if(!$transclude)throw ngTranscludeMinErr("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$attrs.ngTransclude===$attrs.$attr.ngTransclude&&($attrs.ngTransclude="");var slotName=$attrs.ngTransclude||$attrs.ngTranscludeSlot;$transclude(ngTranscludeCloneAttachFn,null,slotName),slotName&&!$transclude.isSlotFilled(slotName)&&useFallbackContent()}}}}],scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],noopNgModelController={$setViewValue:noop,$render:noop},SelectController=["$element","$scope",function($element,$scope){var self=this,optionsMap=new HashMap;self.ngModelCtrl=noopNgModelController,self.unknownOption=jqLite(window.document.createElement("option")),self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";self.unknownOption.val(unknownVal),$element.prepend(self.unknownOption),$element.val(unknownVal)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop}),self.removeUnknownOption=function(){self.unknownOption.parent()&&self.unknownOption.remove()},self.readValue=function(){return self.removeUnknownOption(),$element.val()},self.writeValue=function(value){self.hasOption(value)?(self.removeUnknownOption(),$element.val(value),""===value&&self.emptyOption.prop("selected",!0)):null==value&&self.emptyOption?(self.removeUnknownOption(),$element.val("")):self.renderUnknownOption(value)},self.addOption=function(value,element){if(element[0].nodeType!==NODE_TYPE_COMMENT){assertNotHasOwnProperty(value,'"option value"'),""===value&&(self.emptyOption=element);var count=optionsMap.get(value)||0;optionsMap.put(value,count+1),self.ngModelCtrl.$render(),chromeHack(element)}},self.removeOption=function(value){var count=optionsMap.get(value);count&&(1===count?(optionsMap.remove(value),""===value&&(self.emptyOption=void 0)):optionsMap.put(value,count-1))},self.hasOption=function(value){return!!optionsMap.get(value)},self.registerOption=function(optionScope,optionElement,optionAttrs,interpolateValueFn,interpolateTextFn){if(interpolateValueFn){var oldVal;optionAttrs.$observe("value",function(newVal){isDefined(oldVal)&&self.removeOption(oldVal),oldVal=newVal,self.addOption(newVal,optionElement)})}else interpolateTextFn?optionScope.$watch(interpolateTextFn,function(newVal,oldVal){optionAttrs.$set("value",newVal),oldVal!==newVal&&self.removeOption(oldVal),self.addOption(newVal,optionElement)}):self.addOption(optionAttrs.value,optionElement);optionElement.on("$destroy",function(){self.removeOption(optionAttrs.value),self.ngModelCtrl.$render()})}}],selectDirective=function(){function selectPreLink(scope,element,attr,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];if(selectCtrl.ngModelCtrl=ngModelCtrl,element.on("change",function(){scope.$apply(function(){ngModelCtrl.$setViewValue(selectCtrl.readValue())})}),attr.multiple){selectCtrl.readValue=function(){var array=[];return forEach(element.find("option"),function(option){option.selected&&array.push(option.value)}),array},selectCtrl.writeValue=function(value){var items=new HashMap(value);forEach(element.find("option"),function(option){option.selected=isDefined(items.get(option.value))})};var lastView,lastViewRef=NaN;scope.$watch(function(){lastViewRef!==ngModelCtrl.$viewValue||equals(lastView,ngModelCtrl.$viewValue)||(lastView=shallowCopy(ngModelCtrl.$viewValue),ngModelCtrl.$render()),lastViewRef=ngModelCtrl.$viewValue}),ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}}}}function selectPostLink(scope,element,attrs,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];ngModelCtrl.$render=function(){selectCtrl.writeValue(ngModelCtrl.$viewValue)}}}return{restrict:"E",require:["select","?ngModel"],controller:SelectController,priority:1,link:{pre:selectPreLink,post:selectPostLink}}},optionDirective=["$interpolate",function($interpolate){return{restrict:"E",priority:100,compile:function(element,attr){if(isDefined(attr.value))var interpolateValueFn=$interpolate(attr.value,!0);else{var interpolateTextFn=$interpolate(element.text(),!0);interpolateTextFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.registerOption(scope,element,attr,interpolateValueFn,interpolateTextFn)}}}}],styleDirective=valueFn({restrict:"E",terminal:!1}),requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||void 0,ctrl.$validate()}),ctrl.$validators.pattern=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(regexp)||regexp.test(viewValue)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=toInt(value);maxlength=isNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return maxlength<0||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=toInt(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}};return window.angular.bootstrap?void(window.console&&console.log("WARNING: Tried to load angular more than once.")):(bindJQuery(),publishExternalAPI(angular),angular.module("ngLocale",[],["$provide",function($provide){function getDecimals(n){n+="";var i=n.indexOf(".");return i==-1?0:n.length-i-1}function getVF(n,opt_precision){var v=opt_precision;void 0===v&&(v=Math.min(getDecimals(n),3));var base=Math.pow(10,v),f=(n*base|0)%base;return{v:v,f:f}}var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(n,opt_precision){var i=0|n,vf=getVF(n,opt_precision);return 1==i&&0==vf.v?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),void jqLite(window.document).ready(function(){angularInit(window.document,bootstrap)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),function(window,angular){"use strict";function nodeName_(element){return angular.lowercase(element.nodeName||element[0]&&element[0].nodeName)}function $TouchProvider($provide,$compileProvider){var ngClickOverrideEnabled=!1,ngClickDirectiveAdded=!1;this.ngClickOverrideEnabled=function(enabled){return angular.isDefined(enabled)?(enabled&&!ngClickDirectiveAdded&&(ngClickDirectiveAdded=!0,ngTouchClickDirectiveFactory.$$moduleName="ngTouch",$compileProvider.directive("ngClick",ngTouchClickDirectiveFactory),$provide.decorator("ngClickDirective",["$delegate",function($delegate){if(ngClickOverrideEnabled)$delegate.shift();else for(var i=$delegate.length-1;i>=0;){if("ngTouch"===$delegate[i].$$moduleName){$delegate.splice(i,1);break}i--}return $delegate}])),ngClickOverrideEnabled=enabled,this):ngClickOverrideEnabled},this.$get=function(){return{ngClickOverrideEnabled:function(){return ngClickOverrideEnabled}}}}function makeSwipeDirective(directiveName,direction,eventName){ngTouch.directive(directiveName,["$parse","$swipe",function($parse,$swipe){var MAX_VERTICAL_DISTANCE=75,MAX_VERTICAL_RATIO=.3,MIN_HORIZONTAL_DISTANCE=30;return function(scope,element,attr){function validSwipe(coords){if(!startCoords)return!1;var deltaY=Math.abs(coords.y-startCoords.y),deltaX=(coords.x-startCoords.x)*direction;return valid&&deltaY<MAX_VERTICAL_DISTANCE&&deltaX>0&&deltaX>MIN_HORIZONTAL_DISTANCE&&deltaY/deltaX<MAX_VERTICAL_RATIO}var startCoords,valid,swipeHandler=$parse(attr[directiveName]),pointerTypes=["touch"];angular.isDefined(attr.ngSwipeDisableMouse)||pointerTypes.push("mouse"),$swipe.bind(element,{start:function(coords,event){startCoords=coords,valid=!0},cancel:function(event){valid=!1},end:function(coords,event){validSwipe(coords)&&scope.$apply(function(){element.triggerHandler(eventName),swipeHandler(scope,{$event:event})})}},pointerTypes)}}])}var ngTouch=angular.module("ngTouch",[]);ngTouch.provider("$touch",$TouchProvider),$TouchProvider.$inject=["$provide","$compileProvider"],ngTouch.factory("$swipe",[function(){function getCoordinates(event){var originalEvent=event.originalEvent||event,touches=originalEvent.touches&&originalEvent.touches.length?originalEvent.touches:[originalEvent],e=originalEvent.changedTouches&&originalEvent.changedTouches[0]||touches[0];return{x:e.clientX,y:e.clientY}}function getEvents(pointerTypes,eventType){var res=[];return angular.forEach(pointerTypes,function(pointerType){var eventName=POINTER_EVENTS[pointerType][eventType];eventName&&res.push(eventName)}),res.join(" ")}var MOVE_BUFFER_RADIUS=10,POINTER_EVENTS={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup",cancel:"pointercancel"}};return{bind:function(element,eventHandlers,pointerTypes){var totalX,totalY,startCoords,lastPos,active=!1;pointerTypes=pointerTypes||["mouse","touch","pointer"],element.on(getEvents(pointerTypes,"start"),function(event){startCoords=getCoordinates(event),active=!0,totalX=0,totalY=0,lastPos=startCoords,eventHandlers.start&&eventHandlers.start(startCoords,event)});var events=getEvents(pointerTypes,"cancel");events&&element.on(events,function(event){active=!1,eventHandlers.cancel&&eventHandlers.cancel(event)}),element.on(getEvents(pointerTypes,"move"),function(event){if(active&&startCoords){var coords=getCoordinates(event);if(totalX+=Math.abs(coords.x-lastPos.x),totalY+=Math.abs(coords.y-lastPos.y),lastPos=coords,!(totalX<MOVE_BUFFER_RADIUS&&totalY<MOVE_BUFFER_RADIUS))return totalY>totalX?(active=!1,void(eventHandlers.cancel&&eventHandlers.cancel(event))):(event.preventDefault(),void(eventHandlers.move&&eventHandlers.move(coords,event)))}}),element.on(getEvents(pointerTypes,"end"),function(event){active&&(active=!1,eventHandlers.end&&eventHandlers.end(getCoordinates(event),event))})}}}]);var ngTouchClickDirectiveFactory=["$parse","$timeout","$rootElement",function($parse,$timeout,$rootElement){function hit(x1,y1,x2,y2){return Math.abs(x1-x2)<CLICKBUSTER_THRESHOLD&&Math.abs(y1-y2)<CLICKBUSTER_THRESHOLD}function checkAllowableRegions(touchCoordinates,x,y){for(var i=0;i<touchCoordinates.length;i+=2)if(hit(touchCoordinates[i],touchCoordinates[i+1],x,y))return touchCoordinates.splice(i,i+2),!0;return!1}function onClick(event){if(!(Date.now()-lastPreventedTime>PREVENT_DURATION)){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;x<1&&y<1||lastLabelClickCoordinates&&lastLabelClickCoordinates[0]===x&&lastLabelClickCoordinates[1]===y||(lastLabelClickCoordinates&&(lastLabelClickCoordinates=null),"label"===nodeName_(event.target)&&(lastLabelClickCoordinates=[x,y]),checkAllowableRegions(touchCoordinates,x,y)||(event.stopPropagation(),event.preventDefault(),event.target&&event.target.blur&&event.target.blur()))}}function onTouchStart(event){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;touchCoordinates.push(x,y),$timeout(function(){for(var i=0;i<touchCoordinates.length;i+=2)if(touchCoordinates[i]===x&&touchCoordinates[i+1]===y)return void touchCoordinates.splice(i,i+2)},PREVENT_DURATION,!1)}function preventGhostClick(x,y){touchCoordinates||($rootElement[0].addEventListener("click",onClick,!0),$rootElement[0].addEventListener("touchstart",onTouchStart,!0),touchCoordinates=[]),lastPreventedTime=Date.now(),checkAllowableRegions(touchCoordinates,x,y)}var lastPreventedTime,touchCoordinates,lastLabelClickCoordinates,TAP_DURATION=750,MOVE_TOLERANCE=12,PREVENT_DURATION=2500,CLICKBUSTER_THRESHOLD=25,ACTIVE_CLASS_NAME="ng-click-active";return function(scope,element,attr){function resetState(){tapping=!1,element.removeClass(ACTIVE_CLASS_NAME)}var tapElement,startTime,touchStartX,touchStartY,clickHandler=$parse(attr.ngClick),tapping=!1;element.on("touchstart",function(event){tapping=!0,tapElement=event.target?event.target:event.srcElement,3===tapElement.nodeType&&(tapElement=tapElement.parentNode),element.addClass(ACTIVE_CLASS_NAME),startTime=Date.now();var originalEvent=event.originalEvent||event,touches=originalEvent.touches&&originalEvent.touches.length?originalEvent.touches:[originalEvent],e=touches[0];touchStartX=e.clientX,touchStartY=e.clientY}),element.on("touchcancel",function(event){resetState()}),element.on("touchend",function(event){var diff=Date.now()-startTime,originalEvent=event.originalEvent||event,touches=originalEvent.changedTouches&&originalEvent.changedTouches.length?originalEvent.changedTouches:originalEvent.touches&&originalEvent.touches.length?originalEvent.touches:[originalEvent],e=touches[0],x=e.clientX,y=e.clientY,dist=Math.sqrt(Math.pow(x-touchStartX,2)+Math.pow(y-touchStartY,2));tapping&&diff<TAP_DURATION&&dist<MOVE_TOLERANCE&&(preventGhostClick(x,y),tapElement&&tapElement.blur(),angular.isDefined(attr.disabled)&&attr.disabled!==!1||element.triggerHandler("click",[event])),resetState()}),element.onclick=function(event){},element.on("click",function(event,touchend){scope.$apply(function(){clickHandler(scope,{$event:touchend||event})})}),element.on("mousedown",function(event){element.addClass(ACTIVE_CLASS_NAME)}),element.on("mousemove mouseup",function(event){element.removeClass(ACTIVE_CLASS_NAME)})}}];makeSwipeDirective("ngSwipeLeft",-1,"swipeleft"),makeSwipeDirective("ngSwipeRight",1,"swiperight")}(window,window.angular),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function objectKeys(object){if(Object.keys)return Object.keys(object);var result=[];return forEach(object,function(val,key){result.push(key)}),result}function indexOf(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=from<0?Math.ceil(from):Math.floor(from),from<0&&(from+=len);from<len;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i]&&parents[i].params&&(parentParams=objectKeys(parents[i].params),parentParams.length))for(var j in parentParams)indexOf(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]]);return extend({},inherited,newParams)}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function pick(obj){var copy={},keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));return forEach(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy}function omit(obj){var copy={},keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var key in obj)indexOf(keys,key)==-1&&(copy[key]=obj[key]);return copy}function filter(collection,callback){var array=isArray(collection),result=array?[]:{};return forEach(collection,function(val,i){callback(val,i)&&(result[array?result.length:i]=val)}),result}function map(collection,callback){var result=isArray(collection)?[]:{};return forEach(collection,function(val,i){result[i]=callback(val,i)}),result}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,indexOf(cycle,key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var invocableKeys=objectKeys(invocables||{}),plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=result.$$promises||!0,delete result.$$inheritedValues,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$inheritedValues&&merge(values,omit(parent.$$inheritedValues,invocableKeys)),extend(promises,parent.$$promises),parent.$$values?(merged=merge(values,omit(parent.$$values,invocableKeys)),result.$$inheritedValues=omit(parent.$$values,invocableKeys),done()):(parent.$$inheritedValues&&(result.$$inheritedValues=omit(parent.$$inheritedValues,invocableKeys)),parent.then(done,fail));for(var i=0,ii=plan.length;i<ii;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache,headers:{Accept:"text/html"}}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern,config,parentMatcher){function addParameter(id,type,config,location){if(paramNames.push(id),parentParams[id])return parentParams[id];if(!/^\w+([-.]+\w+)*(?:\[\])?$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(params[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");return params[id]=new $$UMFP.Param(id,type,config,location),params[id]}function quoteRegExp(string,pattern,squash,optional){var surroundPattern=["",""],result=string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!pattern)return result;switch(squash){case!1:surroundPattern=["(",")"+(optional?"?":"")];break;case!0:result=result.replace(/\/$/,""),surroundPattern=["(?:/(",")|/)?"];break;default:surroundPattern=["("+squash+"|",")?"]}return result+surroundPattern[0]+pattern+surroundPattern[1]}function matchDetails(m,isSearch){var id,regexp,segment,type,cfg;return id=m[2]||m[3],cfg=config.params[id],segment=pattern.substring(last,m.index),regexp=isSearch?m[4]:m[4]||("*"==m[1]?".*":null),regexp&&(type=$$UMFP.type(regexp)||inherit($$UMFP.type("string"),{pattern:new RegExp(regexp,config.caseInsensitive?"i":undefined)})),{id:id,regexp:regexp,segment:segment,type:type,cfg:cfg}}config=extend({params:{}},isObject(config)?config:{});var m,placeholder=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,searchPlaceholder=/([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,compiled="^",last=0,segments=this.segments=[],parentParams=parentMatcher?parentMatcher.params:{},params=this.params=parentMatcher?parentMatcher.params.$$new():new $$UMFP.ParamSet,paramNames=[];this.source=pattern;for(var p,param,segment;(m=placeholder.exec(pattern))&&(p=matchDetails(m,!1),!(p.segment.indexOf("?")>=0));)param=addParameter(p.id,p.type,p.cfg,"path"),compiled+=quoteRegExp(p.segment,param.type.pattern.source,param.squash,param.isOptional),segments.push(p.segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);if(segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),search.length>0)for(last=0;m=searchPlaceholder.exec(search);)p=matchDetails(m,!0),param=addParameter(p.id,p.type,p.cfg,"search"),last=placeholder.lastIndex}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+(config.strict===!1?"/?":"")+"$",segments.push(segment),this.regexp=new RegExp(compiled,config.caseInsensitive?"i":undefined),this.prefix=segments[0],this.$$paramNames=paramNames}function Type(config){extend(this,config)}function $UrlMatcherFactory(){function valToString(val){return null!=val?val.toString().replace(/~/g,"~~").replace(/\//g,"~2F"):val}function valFromString(val){return null!=val?val.toString().replace(/~2F/g,"/").replace(/~~/g,"~"):val}function getDefaultConfig(){return{strict:isStrictMode,caseInsensitive:isCaseInsensitive}}function isInjectable(value){return isFunction(value)||isArray(value)&&isFunction(value[value.length-1])}function flushTypeQueue(){for(;typeQueue.length;){var type=typeQueue.shift();if(type.pattern)throw new Error("You cannot override a type's .pattern at runtime.");angular.extend($types[type.name],injector.invoke(type.def))}}function ParamSet(params){extend(this,params||{})}$$UMFP=this;var injector,isCaseInsensitive=!1,isStrictMode=!0,defaultSquashPolicy=!1,$types={},enqueue=!0,typeQueue=[],defaultTypes={string:{encode:valToString,decode:valFromString,is:function(val){return null==val||!isDefined(val)||"string"==typeof val},pattern:/[^\/]*/},int:{encode:valToString,decode:function(val){return parseInt(val,10)},is:function(val){return isDefined(val)&&this.decode(val.toString())===val},pattern:/\d+/},bool:{encode:function(val){return val?1:0},decode:function(val){return 0!==parseInt(val,10)},is:function(val){return val===!0||val===!1},pattern:/0|1/},date:{encode:function(val){return this.is(val)?[val.getFullYear(),("0"+(val.getMonth()+1)).slice(-2),("0"+val.getDate()).slice(-2)].join("-"):undefined},decode:function(val){if(this.is(val))return val;var match=this.capture.exec(val);return match?new Date(match[1],match[2]-1,match[3]):undefined},is:function(val){return val instanceof Date&&!isNaN(val.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^\/]*/},any:{encode:angular.identity,decode:angular.identity,equals:angular.equals,pattern:/.*/}};$UrlMatcherFactory.$$getDefaultValue=function(config){if(!isInjectable(config.value))return config.value;if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.value)},this.caseInsensitive=function(value){return isDefined(value)&&(isCaseInsensitive=value),isCaseInsensitive},this.strictMode=function(value){return isDefined(value)&&(isStrictMode=value),isStrictMode},this.defaultSquashPolicy=function(value){if(!isDefined(value))return defaultSquashPolicy;if(value!==!0&&value!==!1&&!isString(value))throw new Error("Invalid squash policy: "+value+". Valid policies: false, true, arbitrary-string");return defaultSquashPolicy=value,value},this.compile=function(pattern,config){return new UrlMatcher(pattern,extend(getDefaultConfig(),config))},this.isMatcher=function(o){if(!isObject(o))return!1;var result=!0;return forEach(UrlMatcher.prototype,function(val,name){isFunction(val)&&(result=result&&isDefined(o[name])&&isFunction(o[name]))}),result},this.type=function(name,definition,definitionFn){if(!isDefined(definition))return $types[name];if($types.hasOwnProperty(name))throw new Error("A type named '"+name+"' has already been defined.");return $types[name]=new Type(extend({name:name},definition)),definitionFn&&(typeQueue.push({name:name,def:definitionFn}),enqueue||flushTypeQueue()),this},forEach(defaultTypes,function(type,name){$types[name]=new Type(extend({name:name},type))}),$types=inherit($types,{}),this.$get=["$injector",function($injector){return injector=$injector,enqueue=!1,flushTypeQueue(),forEach(defaultTypes,function(type,name){$types[name]||($types[name]=new Type(type))}),this}],this.Param=function(id,type,config,location){function unwrapShorthand(config){var keys=isObject(config)?objectKeys(config):[],isShorthand=indexOf(keys,"value")===-1&&indexOf(keys,"type")===-1&&indexOf(keys,"squash")===-1&&indexOf(keys,"array")===-1;return isShorthand&&(config={value:config}),config.$$fn=isInjectable(config.value)?config.value:function(){return config.value},config}function getType(config,urlType,location){if(config.type&&urlType)throw new Error("Param '"+id+"' has two type configurations.");return urlType?urlType:config.type?angular.isString(config.type)?$types[config.type]:config.type instanceof Type?config.type:new Type(config.type):"config"===location?$types.any:$types.string}function getArrayMode(){var arrayDefaults={array:"search"===location&&"auto"},arrayParamNomenclature=id.match(/\[\]$/)?{array:!0}:{};return extend(arrayDefaults,arrayParamNomenclature,config).array}function getSquashPolicy(config,isOptional){var squash=config.squash;if(!isOptional||squash===!1)return!1;if(!isDefined(squash)||null==squash)return defaultSquashPolicy;if(squash===!0||isString(squash))return squash;throw new Error("Invalid squash policy: '"+squash+"'. Valid policies: false, true, or arbitrary string")}function getReplace(config,arrayMode,isOptional,squash){var replace,configuredKeys,defaultPolicy=[{from:"",to:isOptional||arrayMode?undefined:""},{from:null,to:isOptional||arrayMode?undefined:""}];return replace=isArray(config.replace)?config.replace:[],isString(squash)&&replace.push({from:squash,to:undefined}),configuredKeys=map(replace,function(item){return item.from}),filter(defaultPolicy,function(item){return indexOf(configuredKeys,item.from)===-1}).concat(replace)}function $$getDefaultValue(){if(!injector)throw new Error("Injectable functions cannot be called at configuration time");var defaultValue=injector.invoke(config.$$fn);if(null!==defaultValue&&defaultValue!==undefined&&!self.type.is(defaultValue))throw new Error("Default value ("+defaultValue+") for parameter '"+self.id+"' is not an instance of Type ("+self.type.name+")");return defaultValue}function $value(value){function hasReplaceVal(val){return function(obj){return obj.from===val}}function $replace(value){var replacement=map(filter(self.replace,hasReplaceVal(value)),function(obj){return obj.to});return replacement.length?replacement[0]:value}return value=$replace(value),isDefined(value)?self.type.$normalize(value):$$getDefaultValue()}function toString(){return"{Param:"+id+" "+type+" squash: '"+squash+"' optional: "+isOptional+"}"}var self=this;config=unwrapShorthand(config),type=getType(config,type,location);var arrayMode=getArrayMode();type=arrayMode?type.$asArray(arrayMode,"search"===location):type,"string"!==type.name||arrayMode||"path"!==location||config.value!==undefined||(config.value="");var isOptional=config.value!==undefined,squash=getSquashPolicy(config,isOptional),replace=getReplace(config,arrayMode,isOptional,squash);
extend(this,{id:id,type:type,location:location,array:arrayMode,squash:squash,replace:replace,isOptional:isOptional,value:$value,dynamic:undefined,config:config,toString:toString})},ParamSet.prototype={$$new:function(){return inherit(this,extend(new ParamSet,{$$parent:this}))},$$keys:function(){for(var keys=[],chain=[],parent=this,ignore=objectKeys(ParamSet.prototype);parent;)chain.push(parent),parent=parent.$$parent;return chain.reverse(),forEach(chain,function(paramset){forEach(objectKeys(paramset),function(key){indexOf(keys,key)===-1&&indexOf(ignore,key)===-1&&keys.push(key)})}),keys},$$values:function(paramValues){var values={},self=this;return forEach(self.$$keys(),function(key){values[key]=self[key].value(paramValues&&paramValues[key])}),values},$$equals:function(paramValues1,paramValues2){var equal=!0,self=this;return forEach(self.$$keys(),function(key){var left=paramValues1&&paramValues1[key],right=paramValues2&&paramValues2[key];self[key].type.equals(left,right)||(equal=!1)}),equal},$$validates:function(paramValues){var i,param,rawVal,normalized,encoded,keys=this.$$keys();for(i=0;i<keys.length&&(param=this[keys[i]],rawVal=paramValues[keys[i]],rawVal!==undefined&&null!==rawVal||!param.isOptional);i++){if(normalized=param.type.$normalize(rawVal),!param.type.is(normalized))return!1;if(encoded=param.type.encode(normalized),angular.isString(encoded)&&!param.type.pattern.exec(encoded))return!1}return!0},$$parent:undefined},this.ParamSet=ParamSet}function $UrlRouterProvider($locationProvider,$urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return!isDefined(result)||result}function $get($location,$rootScope,$injector,$browser,$sniffer){function appendBasePath(url,isHtml5,absolute){return"/"===baseHref?url:isHtml5?baseHref.slice(0,-1)+url:absolute?baseHref.slice(1)+url:url}function update(evt){function check(rule){var handled=rule($injector,$location);return!!handled&&(isString(handled)&&$location.replace().url(handled),!0)}if(!evt||!evt.defaultPrevented){lastPushedUrl&&$location.url()===lastPushedUrl;lastPushedUrl=undefined;var i,n=rules.length;for(i=0;i<n;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}function listen(){return listener=listener||$rootScope.$on("$locationChangeSuccess",update)}var lastPushedUrl,baseHref=$browser.baseHref(),location=$location.url();return interceptDeferred||listen(),{sync:function(){update()},listen:function(){return listen()},update:function(read){return read?void(location=$location.url()):void($location.url()!==location&&($location.url(location),$location.replace()))},push:function(urlMatcher,params,options){var url=urlMatcher.format(params||{});null!==url&&params&&params["#"]&&(url+="#"+params["#"]),$location.url(url),lastPushedUrl=options&&options.$$avoidResync?$location.url():undefined,options&&options.replace&&$location.replace()},href:function(urlMatcher,params,options){if(!urlMatcher.validates(params))return null;var isHtml5=$locationProvider.html5Mode();angular.isObject(isHtml5)&&(isHtml5=isHtml5.enabled),isHtml5=isHtml5&&$sniffer.history;var url=urlMatcher.format(params);if(options=options||{},isHtml5||null===url||(url="#"+$locationProvider.hashPrefix()+url),null!==url&&params&&params["#"]&&(url+="#"+params["#"]),url=appendBasePath(url,isHtml5,options.absolute),!options.absolute||!url)return url;var slash=!isHtml5&&url?"/":"",port=$location.port();return port=80===port||443===port?"":":"+port,[$location.protocol(),"://",$location.host(),port,slash,url].join("")}}}var listener,rules=[],otherwise=null,interceptDeferred=!1;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(defer){defer===undefined&&(defer=!0),interceptDeferred=defer},this.$get=$get,$get.$inject=["$location","$rootScope","$injector","$browser","$sniffer"]}function $StateProvider($urlRouterProvider,$urlMatcherFactory){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){if(!stateOrName)return undefined;var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");base=findState(base);for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;i<pathLength;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function flushQueuedChildren(parentName){for(var queued=queue[parentName]||[];queued.length;)registerState(queued.shift())}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"' is already defined");var parentName=name.indexOf(".")!==-1?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:isObject(state.parent)&&isString(state.parent.name)?state.parent.name:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));return states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{inherit:!0,location:!1})}]),flushQueuedChildren(name),state}function isGlob(text){return text.indexOf("*")>-1}function doesStateMatchGlob(glob){for(var globSegments=glob.split("."),segments=$state.$current.name.split("."),i=0,l=globSegments.length;i<l;i++)"*"===globSegments[i]&&(segments[i]="*");return"**"===globSegments[0]&&(segments=segments.slice(indexOf(segments,globSegments[1])),segments.unshift("**")),"**"===globSegments[globSegments.length-1]&&(segments.splice(indexOf(segments,globSegments[globSegments.length-2])+1,Number.MAX_VALUE),segments.push("**")),globSegments.length==segments.length&&segments.join("")===globSegments.join("")}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$urlRouter,$location,$urlMatcherFactory){function handleRedirect(redirect,state,params,options){var evt=$rootScope.$broadcast("$stateNotFound",redirect,state,params);if(evt.defaultPrevented)return $urlRouter.update(),TransitionAborted;if(!evt.retry)return null;if(options.$retry)return $urlRouter.update(),TransitionFailed;var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),$urlRouter.update(),retryTransition}function resolveState(state,params,paramsAreFiltered,inherited,dst,options){function resolveViews(){var viewsPromises=[];return forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:dst.globals,params:$stateParams,notify:options.notify})||""}],viewsPromises.push($resolve.resolve(injectables,dst.globals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,dst.globals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,result.$$controllerAs=view.controllerAs,result.$$resolveAs=view.resolveAs,dst[name]=result}))}),$q.all(viewsPromises).then(function(){return dst.globals})}var $stateParams=paramsAreFiltered?params:filterByKeys(state.params.$$keys(),params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),$q.all(promises).then(resolveViews).then(function(values){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed"));return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(state){return $state.transitionTo($state.current,$stateParams,{reload:state||!0,inherit:!1,notify:!0})},$state.go=function(to,params,options){return $state.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative),hash=toParams["#"];if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options},redirectResult=handleRedirect(redirect,from.self,fromParams,options);if(redirectResult)return redirectResult;if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(!options.relative)throw new Error("No such state '"+to+"'");throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");if(options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),!toState.params.$$validates(toParams))return TransitionFailed;toParams=toState.params.$$values(toParams),to=toState;var toPath=to.path,keep=0,state=toPath[keep],locals=root.locals,toLocals=[];if(options.reload){if(isString(options.reload)||isObject(options.reload)){if(isObject(options.reload)&&!options.reload.name)throw new Error("Invalid reload state object");var reloadState=options.reload===!0?fromPath[0]:findState(options.reload);if(options.reload&&!reloadState)throw new Error("No such reload state '"+(isString(options.reload)?options.reload:options.reload.name)+"'");for(;state&&state===fromPath[keep]&&state!==reloadState;)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep]}}else for(;state&&state===fromPath[keep]&&state.ownParams.$$equals(toParams,fromParams);)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep];if(shouldSkipReload(to,toParams,from,fromParams,locals,options))return hash&&(toParams["#"]=hash),$state.params=toParams,copy($state.params,$stateParams),copy(filterByKeys(to.params.$$keys(),$stateParams),to.locals.globals.$stateParams),options.location&&to.navigable&&to.navigable.url&&($urlRouter.push(to.navigable.url,toParams,{$$avoidResync:!0,replace:"replace"===options.location}),$urlRouter.update(!0)),$state.transition=null,$q.when($state.current);if(toParams=filterByKeys(to.params.$$keys(),toParams||{}),hash&&(toParams["#"]=hash),options.notify&&$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams,options).defaultPrevented)return $rootScope.$broadcast("$stateChangeCancel",to.self,toParams,from.self,fromParams),null==$state.transition&&$urlRouter.update(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals,options);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);return $state.transition!==transition?TransitionSuperseded:($state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null,options.location&&to.navigable&&$urlRouter.push(to.navigable.url,to.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===options.location}),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),$urlRouter.update(!0),$state.current)}).then(null,function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,evt=$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),evt.defaultPrevented||$urlRouter.update(),$q.reject(error))});return transition},$state.is=function(stateOrName,params,options){options=extend({relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);return isDefined(state)?$state.$current===state&&(!params||equalForKeys(state.params.$$values(params),$stateParams)):undefined},$state.includes=function(stateOrName,params,options){if(options=extend({relative:$state.$current},options||{}),isString(stateOrName)&&isGlob(stateOrName)){if(!doesStateMatchGlob(stateOrName))return!1;stateOrName=$state.$current.name}var state=findState(stateOrName,options.relative);return isDefined(state)?!!isDefined($state.$current.includes[state.name])&&(!params||equalForKeys(state.params.$$values(params),$stateParams,objectKeys(params))):undefined},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!0,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;options.inherit&&(params=inheritParams($stateParams,params||{},$state.$current,state));var nav=state&&options.lossy?state.navigable:state;return nav&&nav.url!==undefined&&null!==nav.url?$urlRouter.href(nav.url,filterByKeys(state.params.$$keys().concat("#"),params||{}),{absolute:options.absolute}):null},$state.get=function(stateOrName,context){if(0===arguments.length)return map(objectKeys(states),function(name){return states[name].self});var state=findState(stateOrName,context||$state.$current);return state&&state.self?state.self:null},$state}function shouldSkipReload(to,toParams,from,fromParams,locals,options){function nonSearchParamsEqual(fromAndToState,fromParams,toParams){function notSearchParam(key){return"search"!=fromAndToState.params[key].location}var nonQueryParamKeys=fromAndToState.params.$$keys().filter(notSearchParam),nonQueryParams=pick.apply({},[fromAndToState.params].concat(nonQueryParamKeys)),nonQueryParamSet=new $$UMFP.ParamSet(nonQueryParams);return nonQueryParamSet.$$equals(fromParams,toParams)}if(!options.reload&&to===from&&(locals===from.locals||to.self.reloadOnSearch===!1&&nonSearchParamsEqual(from,fromParams,toParams)))return!0}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=inherit(state.parent.data,state.data)),state.data},url:function(state){var url=state.url,config={params:state.params||{}};if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1),config):(state.parent.navigable||root).url.concat(url,config);if(!url||$urlMatcherFactory.isMatcher(url))return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},ownParams:function(state){var params=state.url&&state.url.params||new $$UMFP.ParamSet;return forEach(state.params||{},function(config,id){params[id]||(params[id]=new $$UMFP.Param(id,null,config,"config"))}),params},params:function(state){var ownParams=pick(state.ownParams,state.ownParams.$$keys());return state.parent&&state.parent.params?extend(state.parent.params.$$new(),ownParams):new $$UMFP.ParamSet},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),view.resolveAs=view.resolveAs||state.resolveAs||"$resolve",views[name]=view}),views},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,abstract:!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewScrollProvider(){var useAnchorScroll=!1;this.useAnchorScroll=function(){useAnchorScroll=!0},this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){return useAnchorScroll?$anchorScroll:function($element){return $timeout(function(){$element[0].scrollIntoView()},0,!1)}}]}function $ViewDirective($state,$injector,$uiViewScroll,$interpolate,$q){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}function getRenderer(attrs,scope){var statics=function(){return{enter:function(element,target,cb){target.after(element),cb()},leave:function(element,cb){element.remove(),cb()}}};if($animate)return{enter:function(element,target,cb){angular.version.minor>2?$animate.enter(element,null,target).then(cb):$animate.enter(element,null,target,cb)},leave:function(element,cb){angular.version.minor>2?$animate.leave(element).then(cb):$animate.leave(element,cb)}};if($animator){var animate=$animator&&$animator(scope,attrs);return{enter:function(element,target,cb){animate.enter(element,null,target),cb()},leave:function(element,cb){animate.leave(element),cb()}}}return statics()}var service=getService(),$animator=service("$animator"),$animate=service("$animate"),directive={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(tElement,tAttrs,$transclude){return function(scope,$element,attrs){function cleanupLastView(){if(previousEl&&(previousEl.remove(),previousEl=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentEl){var $uiViewData=currentEl.data("$uiViewAnim");renderer.leave(currentEl,function(){$uiViewData.$$animLeave.resolve(),previousEl=null}),previousEl=currentEl,currentEl=null}}function updateView(firstTime){var newScope,name=getUiViewName(scope,attrs,$element,$interpolate),previousLocals=name&&$state.$current&&$state.$current.locals[name];if(firstTime||previousLocals!==latestLocals){newScope=scope.$new(),latestLocals=$state.$current.locals[name],newScope.$emit("$viewContentLoading",name);var clone=$transclude(newScope,function(clone){var animEnter=$q.defer(),animLeave=$q.defer(),viewAnimData={$animEnter:animEnter.promise,$animLeave:animLeave.promise,$$animLeave:animLeave};clone.data("$uiViewAnim",viewAnimData),renderer.enter(clone,$element,function(){animEnter.resolve(),currentScope&&currentScope.$emit("$viewContentAnimationEnded"),(angular.isDefined(autoScrollExp)&&!autoScrollExp||scope.$eval(autoScrollExp))&&$uiViewScroll(clone)}),cleanupLastView()});currentEl=clone,currentScope=newScope,currentScope.$emit("$viewContentLoaded",name),currentScope.$eval(onloadExp)}}var previousEl,currentEl,currentScope,latestLocals,onloadExp=attrs.onload||"",autoScrollExp=attrs.autoscroll,renderer=getRenderer(attrs,scope);$element.inheritedData("$uiView");scope.$on("$stateChangeSuccess",function(){updateView(!1)}),updateView(!0)}}};return directive}function $ViewDirectiveFill($compile,$controller,$state,$interpolate){return{restrict:"ECA",priority:-400,compile:function(tElement){var initial=tElement.html();return function(scope,$element,attrs){var current=$state.$current,name=getUiViewName(scope,attrs,$element,$interpolate),locals=current&&current.locals[name];if(locals){$element.data("$uiView",{name:name,state:locals.$$state}),$element.html(locals.$template?locals.$template:initial);var resolveData=angular.extend({},locals);scope[locals.$$resolveAs]=resolveData;var link=$compile($element.contents());if(locals.$$controller){locals.$scope=scope,locals.$element=$element;var controller=$controller(locals.$$controller,locals);locals.$$controllerAs&&(scope[locals.$$controllerAs]=controller,scope[locals.$$controllerAs][locals.$$resolveAs]=resolveData),isFunction(controller.$onInit)&&controller.$onInit(),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}link(scope)}}}}}function getUiViewName(scope,attrs,element,$interpolate){var name=$interpolate(attrs.uiView||attrs.name||"")(scope),uiViewCreatedBy=element.inheritedData("$uiView");return name.indexOf("@")>=0?name:name+"@"+(uiViewCreatedBy?uiViewCreatedBy.state.name:"")}function parseStateRef(ref,current){var parsed,preparsed=ref.match(/^\s*({[^}]*})\s*$/);if(preparsed&&(ref=current+"("+preparsed[1]+")"),parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");if(stateData&&stateData.state&&stateData.state.name)return stateData.state}function getTypeInfo(el){var isSvg="[object SVGAnimatedString]"===Object.prototype.toString.call(el.prop("href")),isForm="FORM"===el[0].nodeName;return{attr:isForm?"action":isSvg?"xlink:href":"href",isAnchor:"A"===el.prop("tagName").toUpperCase(),clickable:!isForm}}function clickHook(el,$state,$timeout,type,current){return function(e){var button=e.which||e.button,target=current();if(!(button>1||e.ctrlKey||e.metaKey||e.shiftKey||el.attr("target"))){var transition=$timeout(function(){$state.go(target.state,target.params,target.options)});e.preventDefault();var ignorePreventDefaultCount=type.isAnchor&&!target.href?1:0;e.preventDefault=function(){ignorePreventDefaultCount--<=0&&$timeout.cancel(transition)}}}}function defaultOpts(el,$state){return{relative:stateContext(el)||$state.$current,inherit:!0}}function $StateRefDirective($state,$timeout){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){var hookFn,ref=parseStateRef(attrs.uiSref,$state.current.name),def={state:ref.state,href:null,params:null},type=getTypeInfo(element),active=uiSrefActive[1]||uiSrefActive[0],unlinkInfoFn=null;def.options=extend(defaultOpts(element,$state),attrs.uiSrefOpts?scope.$eval(attrs.uiSrefOpts):{});var update=function(val){val&&(def.params=angular.copy(val)),def.href=$state.href(ref.state,def.params,def.options),unlinkInfoFn&&unlinkInfoFn(),active&&(unlinkInfoFn=active.$$addStateInfo(ref.state,def.params)),null!==def.href&&attrs.$set(type.attr,def.href)};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(val){val!==def.params&&update(val)},!0),def.params=angular.copy(scope.$eval(ref.paramExpr))),update(),type.clickable&&(hookFn=clickHook(element,$state,$timeout,type,function(){return def}),element.bind("click",hookFn),scope.$on("$destroy",function(){element.unbind("click",hookFn)}))}}}function $StateRefDynamicDirective($state,$timeout){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){function runStateRefLink(group){def.state=group[0],def.params=group[1],def.options=group[2],def.href=$state.href(def.state,def.params,def.options),unlinkInfoFn&&unlinkInfoFn(),active&&(unlinkInfoFn=active.$$addStateInfo(def.state,def.params)),def.href&&attrs.$set(type.attr,def.href)}var hookFn,type=getTypeInfo(element),active=uiSrefActive[1]||uiSrefActive[0],group=[attrs.uiState,attrs.uiStateParams||null,attrs.uiStateOpts||null],watch="["+group.map(function(val){return val||"null"}).join(", ")+"]",def={state:null,params:null,options:null,href:null},unlinkInfoFn=null;scope.$watch(watch,runStateRefLink,!0),runStateRefLink(scope.$eval(watch)),type.clickable&&(hookFn=clickHook(element,$state,$timeout,type,function(){return def}),element.bind("click",hookFn),scope.$on("$destroy",function(){element.unbind("click",hookFn)}))}}}function $StateRefActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs","$timeout",function($scope,$element,$attrs,$timeout){function addState(stateName,stateParams,activeClass){var state=$state.get(stateName,stateContext($element)),stateHash=createStateHash(stateName,stateParams),stateInfo={state:state||{name:stateName},params:stateParams,hash:stateHash};return states.push(stateInfo),activeClasses[stateHash]=activeClass,function(){var idx=states.indexOf(stateInfo);idx!==-1&&states.splice(idx,1)}}function createStateHash(state,params){if(!isString(state))throw new Error("state should be a string");return isObject(params)?state+toJson(params):(params=$scope.$eval(params),isObject(params)?state+toJson(params):state)}function update(){for(var i=0;i<states.length;i++)anyMatch(states[i].state,states[i].params)?addClass($element,activeClasses[states[i].hash]):removeClass($element,activeClasses[states[i].hash]),exactMatch(states[i].state,states[i].params)?addClass($element,activeEqClass):removeClass($element,activeEqClass)}function addClass(el,className){$timeout(function(){el.addClass(className)})}function removeClass(el,className){el.removeClass(className)}function anyMatch(state,params){return $state.includes(state.name,params)}function exactMatch(state,params){return $state.is(state.name,params)}var activeEqClass,uiSrefActive,states=[],activeClasses={};activeEqClass=$interpolate($attrs.uiSrefActiveEq||"",!1)($scope);try{uiSrefActive=$scope.$eval($attrs.uiSrefActive)}catch(e){}uiSrefActive=uiSrefActive||$interpolate($attrs.uiSrefActive||"",!1)($scope),isObject(uiSrefActive)&&forEach(uiSrefActive,function(stateOrName,activeClass){if(isString(stateOrName)){var ref=parseStateRef(stateOrName,$state.current.name);addState(ref.state,$scope.$eval(ref.paramExpr),activeClass)}}),this.$$addStateInfo=function(newState,newParams){if(!(isObject(uiSrefActive)&&states.length>0)){var deregister=addState(newState,newParams,uiSrefActive);return update(),deregister}},$scope.$on("$stateChangeSuccess",update),update()}]}}function $IsStateFilter($state){var isFilter=function(state,params){return $state.is(state,params)};return isFilter.$stateful=!0,isFilter}function $IncludedByStateFilter($state){var includesFilter=function(state,params,options){return $state.includes(state,params,options)};return includesFilter.$stateful=!0,includesFilter}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,toJson=angular.toJson;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory);var $$UMFP;UrlMatcher.prototype.concat=function(pattern,config){var defaultConfig={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch,extend(defaultConfig,config),this)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){function decodePathArray(string){function reverseString(str){return str.split("").reverse().join("")}function unquoteDashes(str){return str.replace(/\\-/g,"-")}var split=reverseString(string).split(/-(?!\\)/),allReversed=map(split,reverseString);return map(allReversed,unquoteDashes).reverse()}var m=this.regexp.exec(path);if(!m)return null;searchParams=searchParams||{};var i,j,paramName,paramNames=this.parameters(),nTotal=paramNames.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");var param,paramVal;for(i=0;i<nPath;i++){for(paramName=paramNames[i],param=this.params[paramName],paramVal=m[i+1],j=0;j<param.replace.length;j++)param.replace[j].from===paramVal&&(paramVal=param.replace[j].to);paramVal&&param.array===!0&&(paramVal=decodePathArray(paramVal)),isDefined(paramVal)&&(paramVal=param.type.decode(paramVal)),values[paramName]=param.value(paramVal)}for(;i<nTotal;i++){for(paramName=paramNames[i],
values[paramName]=this.params[paramName].value(searchParams[paramName]),param=this.params[paramName],paramVal=searchParams[paramName],j=0;j<param.replace.length;j++)param.replace[j].from===paramVal&&(paramVal=param.replace[j].to);isDefined(paramVal)&&(paramVal=param.type.decode(paramVal)),values[paramName]=param.value(paramVal)}return values},UrlMatcher.prototype.parameters=function(param){return isDefined(param)?this.params[param]||null:this.$$paramNames},UrlMatcher.prototype.validates=function(params){return this.params.$$validates(params)},UrlMatcher.prototype.format=function(values){function encodeDashes(str){return encodeURIComponent(str).replace(/-/g,function(c){return"%5C%"+c.charCodeAt(0).toString(16).toUpperCase()})}values=values||{};var segments=this.segments,params=this.parameters(),paramset=this.params;if(!this.validates(values))return null;var i,search=!1,nPath=segments.length-1,nTotal=params.length,result=segments[0];for(i=0;i<nTotal;i++){var isPathParam=i<nPath,name=params[i],param=paramset[name],value=param.value(values[name]),isDefaultValue=param.isOptional&&param.type.equals(param.value(),value),squash=!!isDefaultValue&&param.squash,encoded=param.type.encode(value);if(isPathParam){var nextSegment=segments[i+1],isFinalPathParam=i+1===nPath;if(squash===!1)null!=encoded&&(result+=isArray(encoded)?map(encoded,encodeDashes).join("-"):encodeURIComponent(encoded)),result+=nextSegment;else if(squash===!0){var capture=result.match(/\/$/)?/\/?(.*)/:/(.*)/;result+=nextSegment.match(capture)[1]}else isString(squash)&&(result+=squash+nextSegment);isFinalPathParam&&param.squash===!0&&"/"===result.slice(-1)&&(result=result.slice(0,-1))}else{if(null==encoded||isDefaultValue&&squash!==!1)continue;if(isArray(encoded)||(encoded=[encoded]),0===encoded.length)continue;encoded=map(encoded,encodeURIComponent).join("&"+name+"="),result+=(search?"&":"?")+(name+"="+encoded),search=!0}}return result},Type.prototype.is=function(val,key){return!0},Type.prototype.encode=function(val,key){return val},Type.prototype.decode=function(val,key){return val},Type.prototype.equals=function(a,b){return a==b},Type.prototype.$subPattern=function(){var sub=this.pattern.toString();return sub.substr(1,sub.length-2)},Type.prototype.pattern=/.*/,Type.prototype.toString=function(){return"{Type:"+this.name+"}"},Type.prototype.$normalize=function(val){return this.is(val)?val:this.decode(val)},Type.prototype.$asArray=function(mode,isSearch){function ArrayType(type,mode){function bindTo(type,callbackName){return function(){return type[callbackName].apply(type,arguments)}}function arrayWrap(val){return isArray(val)?val:isDefined(val)?[val]:[]}function arrayUnwrap(val){switch(val.length){case 0:return undefined;case 1:return"auto"===mode?val[0]:val;default:return val}}function falsey(val){return!val}function arrayHandler(callback,allTruthyMode){return function(val){if(isArray(val)&&0===val.length)return val;val=arrayWrap(val);var result=map(val,callback);return allTruthyMode===!0?0===filter(result,falsey).length:arrayUnwrap(result)}}function arrayEqualsHandler(callback){return function(val1,val2){var left=arrayWrap(val1),right=arrayWrap(val2);if(left.length!==right.length)return!1;for(var i=0;i<left.length;i++)if(!callback(left[i],right[i]))return!1;return!0}}this.encode=arrayHandler(bindTo(type,"encode")),this.decode=arrayHandler(bindTo(type,"decode")),this.is=arrayHandler(bindTo(type,"is"),!0),this.equals=arrayEqualsHandler(bindTo(type,"equals")),this.pattern=type.pattern,this.$normalize=arrayHandler(bindTo(type,"$normalize")),this.name=type.name,this.$arrayMode=mode}if(!mode)return this;if("auto"===mode&&!isSearch)throw new Error("'auto' array mode is for query parameters only");return new ArrayType(this,mode)},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),angular.module("ui.router.util").run(["$urlMatcherFactory",function($urlMatcherFactory){}]),$UrlRouterProvider.$inject=["$locationProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.state").factory("$stateParams",function(){return{}}).constant("$state.runtime",{autoinject:!0}).provider("$state",$StateProvider).run(["$injector",function($injector){$injector.get("$state.runtime").autoinject&&$injector.get("$state")}]),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider),$ViewDirective.$inject=["$state","$injector","$uiViewScroll","$interpolate","$q"],$ViewDirectiveFill.$inject=["$compile","$controller","$state","$interpolate"],angular.module("ui.router.state").directive("uiView",$ViewDirective),angular.module("ui.router.state").directive("uiView",$ViewDirectiveFill),$StateRefDirective.$inject=["$state","$timeout"],$StateRefDynamicDirective.$inject=["$state","$timeout"],$StateRefActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateRefActiveDirective).directive("uiSrefActiveEq",$StateRefActiveDirective).directive("uiState",$StateRefDynamicDirective),$IsStateFilter.$inject=["$state"],$IncludedByStateFilter.$inject=["$state"],angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter)}(window,window.angular),function(){"use strict";angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/},clearOnBlur:!0,clearOnBlurPlaceholder:!1,escChar:"\\",eventsToHandle:["input","keyup","click","focus"],addDefaultPlaceholder:!0,allowInvalidValue:!1}).provider("uiMask.Config",function(){var options={};this.maskDefinitions=function(maskDefinitions){return options.maskDefinitions=maskDefinitions},this.clearOnBlur=function(clearOnBlur){return options.clearOnBlur=clearOnBlur},this.clearOnBlurPlaceholder=function(clearOnBlurPlaceholder){return options.clearOnBlurPlaceholder=clearOnBlurPlaceholder},this.eventsToHandle=function(eventsToHandle){return options.eventsToHandle=eventsToHandle},this.addDefaultPlaceholder=function(addDefaultPlaceholder){return options.addDefaultPlaceholder=addDefaultPlaceholder},this.allowInvalidValue=function(allowInvalidValue){return options.allowInvalidValue=allowInvalidValue},this.$get=["uiMaskConfig",function(uiMaskConfig){var tempOptions=uiMaskConfig;for(var prop in options)angular.isObject(options[prop])&&!angular.isArray(options[prop])?angular.extend(tempOptions[prop],options[prop]):tempOptions[prop]=options[prop];return tempOptions}]}).directive("uiMask",["uiMask.Config",function(maskConfig){function isFocused(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)}return{priority:100,require:"ngModel",restrict:"A",compile:function(){var options=angular.copy(maskConfig);return function(scope,iElement,iAttrs,controller){function initialize(maskAttr){return angular.isDefined(maskAttr)?(processRawMask(maskAttr),maskProcessed?(initializeElement(),bindEventListeners(),!0):uninitialize()):uninitialize()}function initPlaceholder(placeholderAttr){placeholderAttr&&(maskPlaceholder=placeholderAttr,!maskProcessed||0===iElement.val().length&&angular.isDefined(iAttrs.placeholder)||iElement.val(maskValue(unmaskValue(iElement.val()))))}function initPlaceholderChar(){return initialize(iAttrs.uiMask)}function formatter(fromModelValue){return maskProcessed?(value=unmaskValue(fromModelValue||""),isValid=validateValue(value),controller.$setValidity("mask",isValid),value.length&&(isValid||linkOptions.allowInvalidValue)?maskValue(value):void 0):fromModelValue}function parser(fromViewValue){return maskProcessed?(value=unmaskValue(fromViewValue||""),isValid=validateValue(value),controller.$viewValue=value.length?maskValue(value):"",controller.$setValidity("mask",isValid),isValid||linkOptions.allowInvalidValue?modelViewValue?controller.$viewValue:value:void 0):fromViewValue}function uninitialize(){return maskProcessed=!1,unbindEventListeners(),angular.isDefined(originalPlaceholder)?iElement.attr("placeholder",originalPlaceholder):iElement.removeAttr("placeholder"),angular.isDefined(originalMaxlength)?iElement.attr("maxlength",originalMaxlength):iElement.removeAttr("maxlength"),iElement.val(controller.$modelValue),controller.$viewValue=controller.$modelValue,!1}function initializeElement(){value=oldValueUnmasked=unmaskValue(controller.$modelValue||""),valueMasked=oldValue=maskValue(value),isValid=validateValue(value),iAttrs.maxlength&&iElement.attr("maxlength",2*maskCaretMap[maskCaretMap.length-1]),!originalPlaceholder&&linkOptions.addDefaultPlaceholder&&iElement.attr("placeholder",maskPlaceholder);for(var viewValue=controller.$modelValue,idx=controller.$formatters.length;idx--;)viewValue=controller.$formatters[idx](viewValue);controller.$viewValue=viewValue||"",controller.$render()}function bindEventListeners(){eventsBound||(iElement.bind("blur",blurHandler),iElement.bind("mousedown mouseup",mouseDownUpHandler),iElement.bind("keydown",keydownHandler),iElement.bind(linkOptions.eventsToHandle.join(" "),eventHandler),eventsBound=!0)}function unbindEventListeners(){eventsBound&&(iElement.unbind("blur",blurHandler),iElement.unbind("mousedown",mouseDownUpHandler),iElement.unbind("mouseup",mouseDownUpHandler),iElement.unbind("keydown",keydownHandler),iElement.unbind("input",eventHandler),iElement.unbind("keyup",eventHandler),iElement.unbind("click",eventHandler),iElement.unbind("focus",eventHandler),eventsBound=!1)}function validateValue(value){return!value.length||value.length>=minRequiredLength}function unmaskValue(value){var valueOffset,valueDelta,valueUnmasked="",input=iElement[0],maskPatternsCopy=maskPatterns.slice(),selectionStart=oldCaretPosition,selectionEnd=selectionStart+getSelectionLength(input),tempValue="";return value=value.toString(),valueOffset=0,valueDelta=value.length-maskPlaceholder.length,angular.forEach(maskComponents,function(component){var position=component.position;position>=selectionStart&&position<selectionEnd||(position>=selectionStart&&(position+=valueDelta),value.substring(position,position+component.value.length)===component.value&&(tempValue+=value.slice(valueOffset,position),valueOffset=position+component.value.length))}),value=tempValue+value.slice(valueOffset),angular.forEach(value.split(""),function(chr){maskPatternsCopy.length&&maskPatternsCopy[0].test(chr)&&(valueUnmasked+=chr,maskPatternsCopy.shift())}),valueUnmasked}function maskValue(unmaskedValue){var valueMasked="",maskCaretMapCopy=maskCaretMap.slice();return angular.forEach(maskPlaceholder.split(""),function(chr,i){unmaskedValue.length&&i===maskCaretMapCopy[0]?(valueMasked+=unmaskedValue.charAt(0)||"_",unmaskedValue=unmaskedValue.substr(1),maskCaretMapCopy.shift()):valueMasked+=chr}),valueMasked}function getPlaceholderChar(i){var defaultPlaceholderChar,placeholder=angular.isDefined(iAttrs.uiMaskPlaceholder)?iAttrs.uiMaskPlaceholder:iAttrs.placeholder;return angular.isDefined(placeholder)&&placeholder[i]?placeholder[i]:(defaultPlaceholderChar=angular.isDefined(iAttrs.uiMaskPlaceholderChar)&&iAttrs.uiMaskPlaceholderChar?iAttrs.uiMaskPlaceholderChar:"_","space"===defaultPlaceholderChar.toLowerCase()?" ":defaultPlaceholderChar[0])}function getMaskComponents(){var maskPlaceholderCopy,components,maskPlaceholderChars=maskPlaceholder.split("");maskCaretMap&&!isNaN(maskCaretMap[0])&&angular.forEach(maskCaretMap,function(value){maskPlaceholderChars[value]="_"}),maskPlaceholderCopy=maskPlaceholderChars.join(""),components=maskPlaceholderCopy.replace(/[_]+/g,"_").split("_"),components=components.filter(function(s){return""!==s});var offset=0;return components.map(function(c){var componentPosition=maskPlaceholderCopy.indexOf(c,offset);return offset=componentPosition+1,{value:c,position:componentPosition}})}function processRawMask(mask){var characterCount=0;if(maskCaretMap=[],maskPatterns=[],maskPlaceholder="",angular.isString(mask)){minRequiredLength=0;var isOptional=!1,numberOfOptionalCharacters=0,splitMask=mask.split(""),inEscape=!1;angular.forEach(splitMask,function(chr,i){inEscape?(inEscape=!1,maskPlaceholder+=chr,characterCount++):linkOptions.escChar===chr?inEscape=!0:linkOptions.maskDefinitions[chr]?(maskCaretMap.push(characterCount),maskPlaceholder+=getPlaceholderChar(i-numberOfOptionalCharacters),maskPatterns.push(linkOptions.maskDefinitions[chr]),characterCount++,isOptional||minRequiredLength++,isOptional=!1):"?"===chr?(isOptional=!0,numberOfOptionalCharacters++):(maskPlaceholder+=chr,characterCount++)})}maskCaretMap.push(maskCaretMap.slice().pop()+1),maskComponents=getMaskComponents(),maskProcessed=maskCaretMap.length>1}function blurHandler(){if((linkOptions.clearOnBlur||linkOptions.clearOnBlurPlaceholder&&0===value.length&&iAttrs.placeholder)&&(oldCaretPosition=0,oldSelectionLength=0,isValid&&0!==value.length||(valueMasked="",iElement.val(""),scope.$apply(function(){controller.$pristine||controller.$setViewValue("")}))),value!==prevValue){var currentVal=iElement.val(),isTemporarilyEmpty=""===value&&currentVal&&angular.isDefined(iAttrs.uiMaskPlaceholderChar)&&"space"===iAttrs.uiMaskPlaceholderChar;isTemporarilyEmpty&&iElement.val(""),triggerChangeEvent(iElement[0]),isTemporarilyEmpty&&iElement.val(currentVal)}prevValue=value}function triggerChangeEvent(element){var change;angular.isFunction(window.Event)&&!element.fireEvent?(change=new Event("change",{view:window,bubbles:!0,cancelable:!1}),element.dispatchEvent(change)):"createEvent"in document?(change=document.createEvent("HTMLEvents"),change.initEvent("change",!1,!0),element.dispatchEvent(change)):element.fireEvent&&element.fireEvent("onchange")}function mouseDownUpHandler(e){"mousedown"===e.type?iElement.bind("mouseout",mouseoutHandler):iElement.unbind("mouseout",mouseoutHandler)}function mouseoutHandler(){oldSelectionLength=getSelectionLength(this),iElement.unbind("mouseout",mouseoutHandler)}function keydownHandler(e){var isKeyBackspace=8===e.which,caretPos=getCaretPosition(this)-1||0,isCtrlZ=90===e.which&&e.ctrlKey;if(isKeyBackspace){for(;caretPos>=0;){if(isValidCaretPosition(caretPos)){setCaretPosition(this,caretPos+1);break}caretPos--}preventBackspace=caretPos===-1}isCtrlZ&&(iElement.val(""),e.preventDefault())}function eventHandler(e){e=e||{};var eventWhich=e.which,eventType=e.type;if(16!==eventWhich&&91!==eventWhich){var valMasked,val=iElement.val(),valOld=oldValue,valAltered=!1,valUnmasked=unmaskValue(val),valUnmaskedOld=oldValueUnmasked,caretPos=getCaretPosition(this)||0,caretPosOld=oldCaretPosition||0,caretPosDelta=caretPos-caretPosOld,caretPosMin=maskCaretMap[0],caretPosMax=maskCaretMap[valUnmasked.length]||maskCaretMap.slice().shift(),selectionLenOld=oldSelectionLength||0,isSelected=getSelectionLength(this)>0,wasSelected=selectionLenOld>0,isAddition=val.length>valOld.length||selectionLenOld&&val.length>valOld.length-selectionLenOld,isDeletion=val.length<valOld.length||selectionLenOld&&val.length===valOld.length-selectionLenOld,isSelection=eventWhich>=37&&eventWhich<=40&&e.shiftKey,isKeyLeftArrow=37===eventWhich,isKeyBackspace=8===eventWhich||"keyup"!==eventType&&isDeletion&&caretPosDelta===-1,isKeyDelete=46===eventWhich||"keyup"!==eventType&&isDeletion&&0===caretPosDelta&&!wasSelected,caretBumpBack=(isKeyLeftArrow||isKeyBackspace||"click"===eventType)&&caretPos>caretPosMin;if(oldSelectionLength=getSelectionLength(this),!isSelection&&(!isSelected||"click"!==eventType&&"keyup"!==eventType&&"focus"!==eventType)){if(isKeyBackspace&&preventBackspace)return iElement.val(maskPlaceholder),scope.$apply(function(){controller.$setViewValue("")}),void setCaretPosition(this,caretPosOld);if("input"===eventType&&isDeletion&&!wasSelected&&valUnmasked===valUnmaskedOld){for(;isKeyBackspace&&caretPos>caretPosMin&&!isValidCaretPosition(caretPos);)caretPos--;for(;isKeyDelete&&caretPos<caretPosMax&&maskCaretMap.indexOf(caretPos)===-1;)caretPos++;var charIndex=maskCaretMap.indexOf(caretPos);valUnmasked=valUnmasked.substring(0,charIndex)+valUnmasked.substring(charIndex+1),valUnmasked!==valUnmaskedOld&&(valAltered=!0)}for(valMasked=maskValue(valUnmasked),oldValue=valMasked,oldValueUnmasked=valUnmasked,!valAltered&&val.length>valMasked.length&&(valAltered=!0),iElement.val(valMasked),valAltered&&scope.$apply(function(){controller.$setViewValue(valMasked)}),isAddition&&caretPos<=caretPosMin&&(caretPos=caretPosMin+1),caretBumpBack&&caretPos--,caretPos=caretPos>caretPosMax?caretPosMax:caretPos<caretPosMin?caretPosMin:caretPos;!isValidCaretPosition(caretPos)&&caretPos>caretPosMin&&caretPos<caretPosMax;)caretPos+=caretBumpBack?-1:1;(caretBumpBack&&caretPos<caretPosMax||isAddition&&!isValidCaretPosition(caretPosOld))&&caretPos++,oldCaretPosition=caretPos,setCaretPosition(this,caretPos)}}}function isValidCaretPosition(pos){return maskCaretMap.indexOf(pos)>-1}function getCaretPosition(input){if(!input)return 0;if(void 0!==input.selectionStart)return input.selectionStart;if(document.selection&&isFocused(iElement[0])){input.focus();var selection=document.selection.createRange();return selection.moveStart("character",input.value?-input.value.length:0),selection.text.length}return 0}function setCaretPosition(input,pos){if(!input)return 0;if(0!==input.offsetWidth&&0!==input.offsetHeight)if(input.setSelectionRange)isFocused(iElement[0])&&(input.focus(),input.setSelectionRange(pos,pos));else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getSelectionLength(input){return input?void 0!==input.selectionStart?input.selectionEnd-input.selectionStart:window.getSelection?window.getSelection().toString().length:document.selection?document.selection.createRange().text.length:0:0}var maskCaretMap,maskPatterns,maskPlaceholder,maskComponents,minRequiredLength,value,valueMasked,isValid,oldValue,oldValueUnmasked,oldCaretPosition,oldSelectionLength,preventBackspace,maskProcessed=!1,eventsBound=!1,originalPlaceholder=iAttrs.placeholder,originalMaxlength=iAttrs.maxlength,originalIsEmpty=controller.$isEmpty;controller.$isEmpty=function(value){return originalIsEmpty(maskProcessed?unmaskValue(value||""):value)};var modelViewValue=!1;iAttrs.$observe("modelViewValue",function(val){"true"===val&&(modelViewValue=!0)}),iAttrs.$observe("allowInvalidValue",function(val){linkOptions.allowInvalidValue=""===val||!!val,formatter(controller.$modelValue)});var linkOptions={};iAttrs.uiOptions?(linkOptions=scope.$eval("["+iAttrs.uiOptions+"]"),linkOptions=angular.isObject(linkOptions[0])?function(original,current){for(var i in original)Object.prototype.hasOwnProperty.call(original,i)&&(void 0===current[i]?current[i]=angular.copy(original[i]):angular.isObject(current[i])&&!angular.isArray(current[i])&&(current[i]=angular.extend({},original[i],current[i])));return current}(options,linkOptions[0]):options):linkOptions=options,iAttrs.$observe("uiMask",initialize),angular.isDefined(iAttrs.uiMaskPlaceholder)?iAttrs.$observe("uiMaskPlaceholder",initPlaceholder):iAttrs.$observe("placeholder",initPlaceholder),angular.isDefined(iAttrs.uiMaskPlaceholderChar)&&iAttrs.$observe("uiMaskPlaceholderChar",initPlaceholderChar),controller.$formatters.unshift(formatter),controller.$parsers.unshift(parser);var prevValue=iElement.val();iElement.bind("mousedown mouseup",mouseDownUpHandler),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1})}}}}])}();var duScrollDefaultEasing=function(x){"use strict";return x<.5?Math.pow(2*x,2)/2:1-Math.pow(2*(1-x),2)/2},duScroll=angular.module("duScroll",["duScroll.scrollspy","duScroll.smoothScroll","duScroll.scrollContainer","duScroll.spyContext","duScroll.scrollHelpers"]).value("duScrollDuration",350).value("duScrollSpyWait",100).value("duScrollGreedy",!1).value("duScrollOffset",0).value("duScrollEasing",duScrollDefaultEasing).value("duScrollCancelOnEvents","scroll mousedown mousewheel touchmove keydown").value("duScrollBottomSpy",!1).value("duScrollActiveClass","active");"undefined"!=typeof module&&module&&module.exports&&(module.exports=duScroll),angular.module("duScroll.scrollHelpers",["duScroll.requestAnimation"]).run(["$window","$q","cancelAnimation","requestAnimation","duScrollEasing","duScrollDuration","duScrollOffset","duScrollCancelOnEvents",function($window,$q,cancelAnimation,requestAnimation,duScrollEasing,duScrollDuration,duScrollOffset,duScrollCancelOnEvents){"use strict";var proto={},isDocument=function(el){return"undefined"!=typeof HTMLDocument&&el instanceof HTMLDocument||el.nodeType&&el.nodeType===el.DOCUMENT_NODE},isElement=function(el){return"undefined"!=typeof HTMLElement&&el instanceof HTMLElement||el.nodeType&&el.nodeType===el.ELEMENT_NODE},unwrap=function(el){return isElement(el)||isDocument(el)?el:el[0]};proto.duScrollTo=function(left,top,duration,easing){var aliasFn;if(angular.isElement(left)?aliasFn=this.duScrollToElement:angular.isDefined(duration)&&(aliasFn=this.duScrollToAnimated),aliasFn)return aliasFn.apply(this,arguments);var el=unwrap(this);return isDocument(el)?$window.scrollTo(left,top):(el.scrollLeft=left,void(el.scrollTop=top))};var scrollAnimation,deferred;proto.duScrollToAnimated=function(left,top,duration,easing){duration&&!easing&&(easing=duScrollEasing);var startLeft=this.duScrollLeft(),startTop=this.duScrollTop(),deltaLeft=Math.round(left-startLeft),deltaTop=Math.round(top-startTop),startTime=null,progress=0,el=this,cancelScrollAnimation=function($event){(!$event||progress&&$event.which>0)&&(duScrollCancelOnEvents&&el.unbind(duScrollCancelOnEvents,cancelScrollAnimation),cancelAnimation(scrollAnimation),deferred.reject(),scrollAnimation=null)};if(scrollAnimation&&cancelScrollAnimation(),deferred=$q.defer(),0===duration||!deltaLeft&&!deltaTop)return 0===duration&&el.duScrollTo(left,top),deferred.resolve(),deferred.promise;var animationStep=function(timestamp){null===startTime&&(startTime=timestamp),progress=timestamp-startTime;var percent=progress>=duration?1:easing(progress/duration);el.scrollTo(startLeft+Math.ceil(deltaLeft*percent),startTop+Math.ceil(deltaTop*percent)),percent<1?scrollAnimation=requestAnimation(animationStep):(duScrollCancelOnEvents&&el.unbind(duScrollCancelOnEvents,cancelScrollAnimation),scrollAnimation=null,deferred.resolve())};return el.duScrollTo(startLeft,startTop),duScrollCancelOnEvents&&el.bind(duScrollCancelOnEvents,cancelScrollAnimation),scrollAnimation=requestAnimation(animationStep),deferred.promise},proto.duScrollToElement=function(target,offset,duration,easing){var el=unwrap(this);angular.isNumber(offset)&&!isNaN(offset)||(offset=duScrollOffset);var top=this.duScrollTop()+unwrap(target).getBoundingClientRect().top-offset;return isElement(el)&&(top-=el.getBoundingClientRect().top),this.duScrollTo(0,top,duration,easing)},proto.duScrollLeft=function(value,duration,easing){if(angular.isNumber(value))return this.duScrollTo(value,this.duScrollTop(),duration,easing);var el=unwrap(this);return isDocument(el)?$window.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft:el.scrollLeft},proto.duScrollTop=function(value,duration,easing){if(angular.isNumber(value))return this.duScrollTo(this.duScrollLeft(),value,duration,easing);var el=unwrap(this);return isDocument(el)?$window.scrollY||document.documentElement.scrollTop||document.body.scrollTop:el.scrollTop},proto.duScrollToElementAnimated=function(target,offset,duration,easing){return this.duScrollToElement(target,offset,duration||duScrollDuration,easing)},proto.duScrollTopAnimated=function(top,duration,easing){return this.duScrollTop(top,duration||duScrollDuration,easing)},proto.duScrollLeftAnimated=function(left,duration,easing){return this.duScrollLeft(left,duration||duScrollDuration,easing)},angular.forEach(proto,function(fn,key){angular.element.prototype[key]=fn;var unprefixed=key.replace(/^duScroll/,"scroll");angular.isUndefined(angular.element.prototype[unprefixed])&&(angular.element.prototype[unprefixed]=fn)})}]),angular.module("duScroll.polyfill",[]).factory("polyfill",["$window",function($window){"use strict";var vendors=["webkit","moz","o","ms"];return function(fnName,fallback){if($window[fnName])return $window[fnName];for(var key,suffix=fnName.substr(0,1).toUpperCase()+fnName.substr(1),i=0;i<vendors.length;i++)if(key=vendors[i]+suffix,$window[key])return $window[key];return fallback}}]),angular.module("duScroll.requestAnimation",["duScroll.polyfill"]).factory("requestAnimation",["polyfill","$timeout",function(polyfill,$timeout){"use strict";var lastTime=0,fallback=function(callback,element){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=$timeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id};return polyfill("requestAnimationFrame",fallback)}]).factory("cancelAnimation",["polyfill","$timeout",function(polyfill,$timeout){"use strict";var fallback=function(promise){$timeout.cancel(promise)};return polyfill("cancelAnimationFrame",fallback)}]),angular.module("duScroll.spyAPI",["duScroll.scrollContainerAPI"]).factory("spyAPI",["$rootScope","$timeout","$window","$document","scrollContainerAPI","duScrollGreedy","duScrollSpyWait","duScrollBottomSpy","duScrollActiveClass",function($rootScope,$timeout,$window,$document,scrollContainerAPI,duScrollGreedy,duScrollSpyWait,duScrollBottomSpy,duScrollActiveClass){"use strict";var createScrollHandler=function(context){var timer=!1,queued=!1,handler=function(){queued=!1;var bottomReached,container=context.container,containerEl=container[0],containerOffset=0;if("undefined"!=typeof HTMLElement&&containerEl instanceof HTMLElement||containerEl.nodeType&&containerEl.nodeType===containerEl.ELEMENT_NODE)containerOffset=containerEl.getBoundingClientRect().top,bottomReached=Math.round(containerEl.scrollTop+containerEl.clientHeight)>=containerEl.scrollHeight;else{var documentScrollHeight=$document[0].body.scrollHeight||$document[0].documentElement.scrollHeight;bottomReached=Math.round($window.pageYOffset+$window.innerHeight)>=documentScrollHeight}var i,currentlyActive,toBeActive,spies,spy,pos,compareProperty=duScrollBottomSpy&&bottomReached?"bottom":"top";for(spies=context.spies,currentlyActive=context.currentlyActive,toBeActive=void 0,i=0;i<spies.length;i++)spy=spies[i],pos=spy.getTargetPosition(),pos&&(duScrollBottomSpy&&bottomReached||pos.top+spy.offset-containerOffset<20&&(duScrollGreedy||pos.top*-1+containerOffset)<pos.height)&&(!toBeActive||toBeActive[compareProperty]<pos[compareProperty])&&(toBeActive={spy:spy},toBeActive[compareProperty]=pos[compareProperty]);toBeActive&&(toBeActive=toBeActive.spy),currentlyActive===toBeActive||duScrollGreedy&&!toBeActive||(currentlyActive&&(currentlyActive.$element.removeClass(duScrollActiveClass),$rootScope.$broadcast("duScrollspy:becameInactive",currentlyActive.$element,angular.element(currentlyActive.getTargetElement()))),toBeActive&&(toBeActive.$element.addClass(duScrollActiveClass),$rootScope.$broadcast("duScrollspy:becameActive",toBeActive.$element,angular.element(toBeActive.getTargetElement()))),context.currentlyActive=toBeActive)};return duScrollSpyWait?function(){timer?queued=!0:(handler(),timer=$timeout(function(){timer=!1,queued&&handler()},duScrollSpyWait,!1))}:handler},contexts={},createContext=function($scope){var id=$scope.$id,context={spies:[]};return context.handler=createScrollHandler(context),contexts[id]=context,$scope.$on("$destroy",function(){destroyContext($scope)}),id},destroyContext=function($scope){var id=$scope.$id,context=contexts[id],container=context.container;container&&container.off("scroll",context.handler),delete contexts[id]},defaultContextId=createContext($rootScope),getContextForScope=function(scope){return contexts[scope.$id]?contexts[scope.$id]:scope.$parent?getContextForScope(scope.$parent):contexts[defaultContextId]},getContextForSpy=function(spy){var context,contextId,scope=spy.$scope;if(scope)return getContextForScope(scope);for(contextId in contexts)if(context=contexts[contextId],context.spies.indexOf(spy)!==-1)return context},isElementInDocument=function(element){for(;element.parentNode;)if(element=element.parentNode,element===document)return!0;return!1},addSpy=function(spy){var context=getContextForSpy(spy);context&&(context.spies.push(spy),context.container&&isElementInDocument(context.container)||(context.container&&context.container.off("scroll",context.handler),context.container=scrollContainerAPI.getContainer(spy.$scope),context.container.on("scroll",context.handler).triggerHandler("scroll")))},removeSpy=function(spy){var context=getContextForSpy(spy);spy===context.currentlyActive&&($rootScope.$broadcast("duScrollspy:becameInactive",context.currentlyActive.$element),context.currentlyActive=null);var i=context.spies.indexOf(spy);i!==-1&&context.spies.splice(i,1),spy.$element=null};return{addSpy:addSpy,removeSpy:removeSpy,createContext:createContext,destroyContext:destroyContext,getContextForScope:getContextForScope}}]),angular.module("duScroll.scrollContainerAPI",[]).factory("scrollContainerAPI",["$document",function($document){"use strict";var containers={},setContainer=function(scope,element){var id=scope.$id;return containers[id]=element,id},getContainerId=function(scope){return containers[scope.$id]?scope.$id:scope.$parent?getContainerId(scope.$parent):void 0},getContainer=function(scope){var id=getContainerId(scope);return id?containers[id]:$document},removeContainer=function(scope){var id=getContainerId(scope);id&&delete containers[id]};return{getContainerId:getContainerId,getContainer:getContainer,setContainer:setContainer,removeContainer:removeContainer}}]),angular.module("duScroll.smoothScroll",["duScroll.scrollHelpers","duScroll.scrollContainerAPI"]).directive("duSmoothScroll",["duScrollDuration","duScrollOffset","scrollContainerAPI",function(duScrollDuration,duScrollOffset,scrollContainerAPI){"use strict";return{link:function($scope,$element,$attr){$element.on("click",function(e){if($attr.href&&$attr.href.indexOf("#")!==-1||""!==$attr.duSmoothScroll){var id=$attr.href?$attr.href.replace(/.*(?=#[^\s]+$)/,"").substring(1):$attr.duSmoothScroll,target=document.getElementById(id)||document.getElementsByName(id)[0];if(target&&target.getBoundingClientRect){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault();var offset=$attr.offset?parseInt($attr.offset,10):duScrollOffset,duration=$attr.duration?parseInt($attr.duration,10):duScrollDuration,container=scrollContainerAPI.getContainer($scope);container.duScrollToElement(angular.element(target),isNaN(offset)?0:offset,isNaN(duration)?0:duration)}}})}}}]),angular.module("duScroll.spyContext",["duScroll.spyAPI"]).directive("duSpyContext",["spyAPI",function(spyAPI){"use strict";return{restrict:"A",scope:!0,compile:function(tElement,tAttrs,transclude){return{pre:function($scope,iElement,iAttrs,controller){spyAPI.createContext($scope)}}}}}]),angular.module("duScroll.scrollContainer",["duScroll.scrollContainerAPI"]).directive("duScrollContainer",["scrollContainerAPI",function(scrollContainerAPI){"use strict";return{restrict:"A",scope:!0,compile:function(tElement,tAttrs,transclude){return{pre:function($scope,iElement,iAttrs,controller){iAttrs.$observe("duScrollContainer",function(element){angular.isString(element)&&(element=document.getElementById(element)),element=angular.isElement(element)?angular.element(element):iElement,scrollContainerAPI.setContainer($scope,element),$scope.$on("$destroy",function(){scrollContainerAPI.removeContainer($scope);
})})}}}}}]),angular.module("duScroll.scrollspy",["duScroll.spyAPI"]).directive("duScrollspy",["spyAPI","duScrollOffset","$timeout","$rootScope",function(spyAPI,duScrollOffset,$timeout,$rootScope){"use strict";var Spy=function(targetElementOrId,$scope,$element,offset){angular.isElement(targetElementOrId)?this.target=targetElementOrId:angular.isString(targetElementOrId)&&(this.targetId=targetElementOrId),this.$scope=$scope,this.$element=$element,this.offset=offset};return Spy.prototype.getTargetElement=function(){return!this.target&&this.targetId&&(this.target=document.getElementById(this.targetId)||document.getElementsByName(this.targetId)[0]),this.target},Spy.prototype.getTargetPosition=function(){var target=this.getTargetElement();if(target)return target.getBoundingClientRect()},Spy.prototype.flushTargetCache=function(){this.targetId&&(this.target=void 0)},{link:function($scope,$element,$attr){var targetId,href=$attr.ngHref||$attr.href;if(href&&href.indexOf("#")!==-1?targetId=href.replace(/.*(?=#[^\s]+$)/,"").substring(1):$attr.duScrollspy?targetId=$attr.duScrollspy:$attr.duSmoothScroll&&(targetId=$attr.duSmoothScroll),targetId){var timeoutPromise=$timeout(function(){var spy=new Spy(targetId,$scope,$element,(-($attr.offset?parseInt($attr.offset,10):duScrollOffset)));spyAPI.addSpy(spy),$scope.$on("$locationChangeSuccess",spy.flushTargetCache.bind(spy));var deregisterOnStateChange=$rootScope.$on("$stateChangeSuccess",spy.flushTargetCache.bind(spy));$scope.$on("$destroy",function(){spyAPI.removeSpy(spy),deregisterOnStateChange()})},0,!1);$scope.$on("$destroy",function(){$timeout.cancel(timeoutPromise)})}}}}]),function(){"use strict";function FastClick(layer,options){function bind(method,context){return function(){return method.apply(context,arguments)}}var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],context=this,i=0,l=methods.length;i<l;i++)context[methods[i]]=bind(context[methods[i]],context);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0,deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],clickEvent=document.createEvent("MouseEvents"),clickEvent.initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&0!==targetElement.type.indexOf("date")&&"time"!==targetElement.type&&"month"!==targetElement.type?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(scrollParent=targetElement.fastClickScrollParent,!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if(selection=window.getSelection(),selection.rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary},FastClick.prototype.onTouchMove=function(event){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0)},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement,targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent),targetTagName=targetElement.tagName.toLowerCase(),"label"===targetTagName){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&"input"===targetTagName?(this.targetElement=null,!1):(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault()),!1);return!(!deviceIsIOS||deviceIsIOS4||(scrollParent=targetElement.fastClickScrollParent,!scrollParent||scrollParent.fastClickLastScrollTop===scrollParent.scrollTop))||(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return!this.targetElement||(!!event.forwardedTouchEvent||(!event.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),event.preventDefault(),!1))))},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===event.target.type&&0===event.detail||(permitted=this.onMouse(event),permitted||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){var metaViewport,chromeVersion,blackberryVersion,firefoxVersion;if("undefined"==typeof window.ontouchstart)return!0;if(chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),blackberryVersion[1]>=10&&blackberryVersion[2]>=3&&(metaViewport=document.querySelector("meta[name=viewport]")))){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction||(firefoxVersion=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],!!(firefoxVersion>=27&&(metaViewport=document.querySelector("meta[name=viewport]"),metaViewport&&(metaViewport.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)))||("none"===layer.style.touchAction||"manipulation"===layer.style.touchAction))},FastClick.attach=function(layer,options){return new FastClick(layer,options)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick}(),function(window,angular){var isDefined=angular.isDefined,isUndefined=angular.isUndefined,isNumber=angular.isNumber,isObject=angular.isObject,isArray=angular.isArray,extend=angular.extend,toJson=angular.toJson;angular.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(prefix){return this.prefix=prefix,this},this.setStorageType=function(storageType){return this.storageType=storageType,this},this.setStorageCookie=function(exp,path){return this.cookie.expiry=exp,this.cookie.path=path,this},this.setStorageCookieDomain=function(domain){return this.cookie.domain=domain,this},this.setNotify=function(itemSet,itemRemove){return this.notify={setItem:itemSet,removeItem:itemRemove},this},this.$get=["$rootScope","$window","$document","$parse",function($rootScope,$window,$document,$parse){var webStorage,self=this,prefix=self.prefix,cookie=self.cookie,notify=self.notify,storageType=self.storageType;$document?$document[0]&&($document=$document[0]):$document=document,"."!==prefix.substr(-1)&&(prefix=prefix?prefix+".":"");var deriveQualifiedKey=function(key){return prefix+key},browserSupportsLocalStorage=function(){try{var supported=storageType in $window&&null!==$window[storageType],key=deriveQualifiedKey("__"+Math.round(1e7*Math.random()));return supported&&(webStorage=$window[storageType],webStorage.setItem(key,""),webStorage.removeItem(key)),supported}catch(e){return storageType="cookie",$rootScope.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),addToLocalStorage=function(key,value){if(value=isUndefined(value)?null:toJson(value),!browserSupportsLocalStorage||"cookie"===self.storageType)return browserSupportsLocalStorage||$rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),notify.setItem&&$rootScope.$broadcast("LocalStorageModule.notification.setitem",{key:key,newvalue:value,storageType:"cookie"}),addToCookies(key,value);try{webStorage&&webStorage.setItem(deriveQualifiedKey(key),value),notify.setItem&&$rootScope.$broadcast("LocalStorageModule.notification.setitem",{key:key,newvalue:value,storageType:self.storageType})}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),addToCookies(key,value)}return!0},getFromLocalStorage=function(key){if(!browserSupportsLocalStorage||"cookie"===self.storageType)return browserSupportsLocalStorage||$rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),getFromCookies(key);var item=webStorage?webStorage.getItem(deriveQualifiedKey(key)):null;if(!item||"null"===item)return null;try{return JSON.parse(item)}catch(e){return item}},removeFromLocalStorage=function(){var i,key;for(i=0;i<arguments.length;i++)if(key=arguments[i],browserSupportsLocalStorage&&"cookie"!==self.storageType)try{webStorage.removeItem(deriveQualifiedKey(key)),notify.removeItem&&$rootScope.$broadcast("LocalStorageModule.notification.removeitem",{key:key,storageType:self.storageType})}catch(e){$rootScope.$broadcast("LocalStorageModule.notification.error",e.message),removeFromCookies(key)}else browserSupportsLocalStorage||$rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),notify.removeItem&&$rootScope.$broadcast("LocalStorageModule.notification.removeitem",{key:key,storageType:"cookie"}),removeFromCookies(key)},getKeysForLocalStorage=function(){if(!browserSupportsLocalStorage)return $rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var prefixLength=prefix.length,keys=[];for(var key in webStorage)if(key.substr(0,prefixLength)===prefix)try{keys.push(key.substr(prefixLength))}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return keys},clearAllFromLocalStorage=function(regularExpression){var prefixRegex=prefix?new RegExp("^"+prefix):new RegExp,testRegex=regularExpression?new RegExp(regularExpression):new RegExp;if(!browserSupportsLocalStorage||"cookie"===self.storageType)return browserSupportsLocalStorage||$rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),clearAllFromCookies();var prefixLength=prefix.length;for(var key in webStorage)if(prefixRegex.test(key)&&testRegex.test(key.substr(prefixLength)))try{removeFromLocalStorage(key.substr(prefixLength))}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),clearAllFromCookies()}return!0},browserSupportsCookies=function(){try{return $window.navigator.cookieEnabled||"cookie"in $document&&($document.cookie.length>0||($document.cookie="test").indexOf.call($document.cookie,"test")>-1)}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),addToCookies=function(key,value,daysToExpiry){if(isUndefined(value))return!1;if((isArray(value)||isObject(value))&&(value=toJson(value)),!browserSupportsCookies)return $rootScope.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var expiry="",expiryDate=new Date,cookieDomain="";if(null===value?(expiryDate.setTime(expiryDate.getTime()+-864e5),expiry="; expires="+expiryDate.toGMTString(),value=""):isNumber(daysToExpiry)&&0!==daysToExpiry?(expiryDate.setTime(expiryDate.getTime()+24*daysToExpiry*60*60*1e3),expiry="; expires="+expiryDate.toGMTString()):0!==cookie.expiry&&(expiryDate.setTime(expiryDate.getTime()+24*cookie.expiry*60*60*1e3),expiry="; expires="+expiryDate.toGMTString()),key){var cookiePath="; path="+cookie.path;cookie.domain&&(cookieDomain="; domain="+cookie.domain),$document.cookie=deriveQualifiedKey(key)+"="+encodeURIComponent(value)+expiry+cookiePath+cookieDomain}}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),!1}return!0},getFromCookies=function(key){if(!browserSupportsCookies)return $rootScope.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var cookies=$document.cookie&&$document.cookie.split(";")||[],i=0;i<cookies.length;i++){for(var thisCookie=cookies[i];" "===thisCookie.charAt(0);)thisCookie=thisCookie.substring(1,thisCookie.length);if(0===thisCookie.indexOf(deriveQualifiedKey(key)+"=")){var storedValues=decodeURIComponent(thisCookie.substring(prefix.length+key.length+1,thisCookie.length));try{return JSON.parse(storedValues)}catch(e){return storedValues}}}return null},removeFromCookies=function(key){addToCookies(key,null)},clearAllFromCookies=function(){for(var thisCookie=null,prefixLength=prefix.length,cookies=$document.cookie.split(";"),i=0;i<cookies.length;i++){for(thisCookie=cookies[i];" "===thisCookie.charAt(0);)thisCookie=thisCookie.substring(1,thisCookie.length);var key=thisCookie.substring(prefixLength,thisCookie.indexOf("="));removeFromCookies(key)}},getStorageType=function(){return storageType},bindToScope=function(scope,key,def,lsKey){lsKey=lsKey||key;var value=getFromLocalStorage(lsKey);return null===value&&isDefined(def)?value=def:isObject(value)&&isObject(def)&&(value=extend(value,def)),$parse(key).assign(scope,value),scope.$watch(key,function(newVal){addToLocalStorage(lsKey,newVal)},isObject(scope[key]))},lengthOfLocalStorage=function(){for(var count=0,storage=$window[storageType],i=0;i<storage.length;i++)0===storage.key(i).indexOf(prefix)&&count++;return count};return{isSupported:browserSupportsLocalStorage,getStorageType:getStorageType,set:addToLocalStorage,add:addToLocalStorage,get:getFromLocalStorage,keys:getKeysForLocalStorage,remove:removeFromLocalStorage,clearAll:clearAllFromLocalStorage,bind:bindToScope,deriveKey:deriveQualifiedKey,length:lengthOfLocalStorage,cookie:{isSupported:browserSupportsCookies,set:addToCookies,add:addToCookies,get:getFromCookies,remove:removeFromCookies,clearAll:clearAllFromCookies}}}]})}(window,window.angular),function(window){function jqCheckAndTriggerAutoFillEvent(){var i,el;for(i=0;i<this.length;i++)el=this[i],valueMarked(el)||(markValue(el),triggerChangeEvent(el))}function valueMarked(el){"$$currentValue"in el||(el.$$currentValue=el.getAttribute("value"));var val=el.value,$$currentValue=el.$$currentValue;return!val&&!$$currentValue||val===$$currentValue}function markValue(el){el.$$currentValue=el.value}function addValueChangeByJsListener(listener){var jq=window.jQuery||window.angular.element,jqProto=jq.prototype,_val=jqProto.val;jqProto.val=function(newValue){var res=_val.apply(this,arguments);return arguments.length>0&&forEach(this,function(el){listener(el,newValue)}),res}}function addGlobalEventListener(eventName,listener){function onEvent(event){var target=event.target;listener(target)}rootElement.addEventListener(eventName,onEvent,!0)}function findParentForm(el){for(;el;){if("FORM"===el.nodeName)return $(el);el=el.parentNode}return $()}function forEach(arr,listener){if(arr.forEach)return arr.forEach(listener);var i;for(i=0;i<arr.length;i++)listener(arr[i])}function triggerChangeEvent(element){var doc=window.document,event=doc.createEvent("HTMLEvents");event.initEvent("change",!0,!0),element.dispatchEvent(event)}var $=window.jQuery||window.angular.element,rootElement=window.document.documentElement,$rootElement=$(rootElement);addGlobalEventListener("change",markValue),addValueChangeByJsListener(markValue),$.prototype.checkAndTriggerAutoFillEvent=jqCheckAndTriggerAutoFillEvent,addGlobalEventListener("blur",function(target){window.setTimeout(function(){findParentForm(target).find("input").checkAndTriggerAutoFillEvent()},20)}),window.document.addEventListener("DOMContentLoaded",function(){forEach(document.getElementsByTagName("input"),markValue),window.setTimeout(function(){$rootElement.find("input").checkAndTriggerAutoFillEvent()},200)},!1)}(window),function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){"use strict";return angular.module("tmh.dynamicLocale",[]).config(["$provide",function($provide){function makeStateful($delegate){return $delegate.$stateful=!0,$delegate}$provide.decorator("dateFilter",["$delegate",makeStateful]),$provide.decorator("numberFilter",["$delegate",makeStateful]),$provide.decorator("currencyFilter",["$delegate",makeStateful])}]).constant("tmhDynamicLocale.STORAGE_KEY","tmhDynamicLocale.locale").provider("tmhDynamicLocale",["tmhDynamicLocale.STORAGE_KEY",function(STORAGE_KEY){function loadScript(url,callback,errorCallback,$timeout){var script=document.createElement("script"),element=nodeToAppend?nodeToAppend:document.getElementsByTagName("body")[0],removed=!1;script.type="text/javascript",script.readyState?script.onreadystatechange=function(){"complete"!==script.readyState&&"loaded"!==script.readyState||(script.onreadystatechange=null,$timeout(function(){removed||(removed=!0,element.removeChild(script),callback())},30,!1))}:(script.onload=function(){removed||(removed=!0,element.removeChild(script),callback())},script.onerror=function(){removed||(removed=!0,element.removeChild(script),errorCallback())}),script.src=url,script.async=!0,element.appendChild(script)}function loadLocale(localeUrl,$locale,localeId,$rootScope,$q,localeCache,$timeout){function overrideValues(oldObject,newObject){activeLocale===localeId&&(angular.forEach(oldObject,function(value,key){newObject[key]?angular.isArray(newObject[key])&&(oldObject[key].length=newObject[key].length):delete oldObject[key]}),angular.forEach(newObject,function(value,key){angular.isArray(newObject[key])||angular.isObject(newObject[key])?(oldObject[key]||(oldObject[key]=angular.isArray(newObject[key])?[]:{}),overrideValues(oldObject[key],newObject[key])):oldObject[key]=newObject[key]}))}if(promiseCache[localeId])return activeLocale=localeId,promiseCache[localeId];var cachedLocale,deferred=$q.defer();return localeId===activeLocale?deferred.resolve($locale):(cachedLocale=localeCache.get(localeId))?(activeLocale=localeId,$rootScope.$evalAsync(function(){overrideValues($locale,cachedLocale),storage.put(storageKey,localeId),$rootScope.$broadcast("$localeChangeSuccess",localeId,$locale),deferred.resolve($locale)})):(activeLocale=localeId,promiseCache[localeId]=deferred.promise,loadScript(localeUrl,function(){var localInjector=angular.injector(["ngLocale"]),externalLocale=localInjector.get("$locale");overrideValues($locale,externalLocale),localeCache.put(localeId,externalLocale),delete promiseCache[localeId],$rootScope.$applyAsync(function(){storage.put(storageKey,localeId),$rootScope.$broadcast("$localeChangeSuccess",localeId,$locale),deferred.resolve($locale)})},function(){delete promiseCache[localeId],$rootScope.$applyAsync(function(){activeLocale===localeId&&(activeLocale=$locale.id),$rootScope.$broadcast("$localeChangeError",localeId),deferred.reject(localeId)})},$timeout)),deferred.promise}var defaultLocale,nodeToAppend,storage,activeLocale,localeLocationPattern="angular/i18n/angular-locale_{{locale}}.js",storageFactory="tmhDynamicLocaleStorageCache",storageKey=STORAGE_KEY,promiseCache={},extraProperties={};this.localeLocationPattern=function(value){return value?(localeLocationPattern=value,this):localeLocationPattern},this.appendScriptTo=function(nodeElement){nodeToAppend=nodeElement},this.useStorage=function(storageName){storageFactory=storageName},this.useCookieStorage=function(){this.useStorage("$cookieStore")},this.defaultLocale=function(value){defaultLocale=value},this.storageKey=function(value){return value?(storageKey=value,this):storageKey},this.addLocalePatternValue=function(key,value){extraProperties[key]=value},this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function($rootScope,$injector,interpolate,locale,$q,tmhDynamicLocaleCache,$timeout){function loadLocaleFn(localeId){var baseProperties={locale:localeId,angularVersion:angular.version.full};return loadLocale(localeLocation(angular.extend({},extraProperties,baseProperties)),locale,localeId,$rootScope,$q,tmhDynamicLocaleCache,$timeout)}var localeLocation=interpolate(localeLocationPattern);return storage=$injector.get(storageFactory),$rootScope.$evalAsync(function(){var initialLocale;(initialLocale=storage.get(storageKey)||defaultLocale)&&loadLocaleFn(initialLocale)}),{set:loadLocaleFn,get:function(){return activeLocale}}}]}]).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop]),"tmh.dynamicLocale"}),function(window,angular){"use strict";function $$CookieWriter($document,$log,$browser){function buildCookieString(name,value,options){var path,expires;options=options||{},expires=options.expires,path=angular.isDefined(options.path)?options.path:cookiePath,angular.isUndefined(value)&&(expires="Thu, 01 Jan 1970 00:00:00 GMT",value=""),angular.isString(expires)&&(expires=new Date(expires));var str=encodeURIComponent(name)+"="+encodeURIComponent(value);str+=path?";path="+path:"",str+=options.domain?";domain="+options.domain:"",str+=expires?";expires="+expires.toUTCString():"",str+=options.secure?";secure":"";var cookieLength=str.length+1;return cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"),str}var cookiePath=$browser.baseHref(),rawDocument=$document[0];return function(name,value,options){rawDocument.cookie=buildCookieString(name,value,options)}}angular.module("ngCookies",["ng"]).provider("$cookies",[function(){function calcOptions(options){return options?angular.extend({},defaults,options):defaults}var defaults=this.defaults={};this.$get=["$$cookieReader","$$cookieWriter",function($$cookieReader,$$cookieWriter){return{get:function(key){return $$cookieReader()[key]},getObject:function(key){var value=this.get(key);return value?angular.fromJson(value):value},getAll:function(){return $$cookieReader()},put:function(key,value,options){$$cookieWriter(key,value,calcOptions(options))},putObject:function(key,value,options){this.put(key,angular.toJson(value),options)},remove:function(key,options){$$cookieWriter(key,void 0,calcOptions(options))}}}]}]),angular.module("ngCookies").factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){return $cookies.getObject(key)},put:function(key,value){$cookies.putObject(key,value)},remove:function(key){$cookies.remove(key)}}}]),$$CookieWriter.$inject=["$document","$log","$browser"],angular.module("ngCookies").provider("$$cookieWriter",function(){this.$get=$$CookieWriter})}(window,window.angular),function(){function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;return arguments.length<3&&(memo=obj[keys?keys[index]:index],index+=dir),iterator(obj,iteratee,memo,keys,index,length)}}function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=getLength(array),index=dir>0?0:length-1;index>=0&&index<length;index+=dir)if(predicate(array[index],index,array))return index;return-1}}function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if("number"==typeof idx)dir>0?i=idx>=0?idx:Math.max(idx+length,i):length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length)return idx=sortedIndex(array,item),array[idx]===item?idx:-1;if(item!==item)return idx=predicateFind(slice.call(array,i,length),_.isNaN),idx>=0?idx+i:-1;for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir)if(array[idx]===item)return idx;return-1}}function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";for(_.has(obj,prop)&&!_.contains(keys,prop)&&keys.push(prop);nonEnumIdx--;)prop=nonEnumerableProps[nonEnumIdx],prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)&&keys.push(prop)}var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?optimizeCb(value,context,argCount):_.isObject(value)?_.matcher(value):_.property(value)};_.iteratee=function(value,context){return cb(value,context,1/0)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;
if(length<2||null==obj)return obj;for(var index=1;index<length;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;i<l;i++){var key=keys[i];undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key])}return obj}},baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;return Ctor.prototype=null,result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(collection){var length=getLength(collection);return"number"==typeof length&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results},_.reduce=_.foldl=_.inject=createReduce(1),_.reduceRight=_.foldr=createReduce(-1),_.find=_.detect=function(obj,predicate,context){var key;if(key=isArrayLike(obj)?_.findIndex(obj,predicate,context):_.findKey(obj,predicate,context),void 0!==key&&key!==-1)return obj[key]},_.filter=_.select=function(obj,predicate,context){var results=[];return predicate=cb(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)},_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0},_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1},_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){return isArrayLike(obj)||(obj=_.values(obj)),("number"!=typeof fromIndex||guard)&&(fromIndex=0),_.indexOf(obj,item,fromIndex)>=0},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-(1/0),lastComputed=-(1/0);if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)value=obj[i],value>result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-(1/0)&&result===-(1/0))&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)value=obj[i],value<result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed<lastComputed||computed===1/0&&result===1/0)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=isArrayLike(obj)?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;index<length;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(isArrayLike(obj)||(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=cb(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=cb(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):isArrayLike(obj)?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){if(null!=array)return null==n||guard?array[0]:_.initial(array,array.length-n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){if(null!=array)return null==n||guard?array[array.length-1]:_.rest(array,Math.max(0,array.length-n))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){for(var output=[],idx=0,i=startIndex||0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){shallow||(value=flatten(value,shallow,strict));var j=0,len=value.length;for(output.length+=len;j<len;)output[idx++]=value[j++]}else strict||(output[idx++]=value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1)},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;isSorted?(i&&seen===computed||result.push(value),seen=computed):iteratee?_.contains(seen,computed)||(seen.push(computed),result.push(value)):_.contains(result,value)||result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0))},_.intersection=function(array){for(var result=[],argsLength=arguments.length,i=0,length=getLength(array);i<length;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;j<argsLength&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(arguments,!0,!0,1);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(array){for(var length=array&&_.max(array,getLength).length||0,result=Array(length),index=0;index<length;index++)result[index]=_.pluck(array,index);return result},_.object=function(list,values){for(var result={},i=0,length=getLength(list);i<length;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.findIndex=createPredicateIndexFinder(1),_.findLastIndex=createPredicateIndexFinder(-1),_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);for(var value=iteratee(obj),low=0,high=getLength(array);low<high;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex),_.lastIndexOf=createIndexFinder(-1,_.findLastIndex),_.range=function(start,stop,step){null==stop&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;idx<length;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return _.isObject(result)?result:self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2),bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound},_.partial=function(func){var boundArgs=slice.call(arguments,1),bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;i<length;i++)args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound},_.bindAll=function(obj){var i,key,length=arguments.length;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=_.partial(_.delay,_,1),_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;last<wait&&last>=0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}},_.before=function(times,func){var memo;return function(){return--times>0&&(memo=func.apply(this,arguments)),times<=1&&(func=null),memo}},_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;i<length;i++)values[i]=obj[keys[i]];return values},_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=_.keys(obj),length=keys.length,results={},index=0;index<length;index++)currentKey=keys[index],results[currentKey]=iteratee(obj[currentKey],currentKey,obj);return results},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=createAssigner(_.allKeys),_.extendOwn=_.assign=createAssigner(_.keys),_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=_.keys(obj),i=0,length=keys.length;i<length;i++)if(key=keys[i],predicate(obj[key],key,obj))return key},_.pick=function(object,oiteratee,context){var iteratee,keys,result={},obj=object;if(null==obj)return result;_.isFunction(oiteratee)?(keys=_.allKeys(obj),iteratee=optimizeCb(oiteratee,context)):(keys=flatten(arguments,!1,!1,1),iteratee=function(value,key,obj){return key in obj},obj=Object(obj));for(var i=0,length=keys.length;i<length;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(flatten(arguments,!1,!1,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=createAssigner(_.allKeys,!0),_.create=function(prototype,props){var result=baseCreate(prototype);return props&&_.extendOwn(result,props),result},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[],bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;if(aStack.push(a),bStack.push(b),areArrays){if(length=a.length,length!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=_.keys(a);if(length=keys.length,_.keys(b).length!==length)return!1;for(;length--;)if(key=keys[length],!_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}return aStack.pop(),bStack.pop(),!0};_.isEqual=function(a,b){return eq(a,b)},_.isEmpty=function(obj){return null==obj||(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))?0===obj.length:0===_.keys(obj).length)},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=property,_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}},_.matcher=_.matches=function(attrs){return attrs=_.extendOwn({},attrs),function(obj){return _.isMatch(obj,attrs)}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property,fallback){var value=null==object?void 0:object[property];return void 0===value&&(value=fallback),_.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(){"use strict";function configureLocalStorageProvider(localStorageServiceProvider){localStorageServiceProvider.setPrefix("cmg").setStorageType("localStorage").setNotify(!1,!1)}function bootStrap(){FastClick.attach(document.body)}angular.module("app",["app.core","app.services","app.widgets","app.password-reset","app.order-flow","app.landing-messages","app.checkout-flow","app.account"]).config(configureLocalStorageProvider).constant("config",appConfig).run(bootStrap),configureLocalStorageProvider.$inject=["localStorageServiceProvider"]}(),function(){"use strict";angular.module("app.core",["ui.router","duScroll","ui.mask","LocalStorageModule","ngTouch","ngCookies","tmh.dynamicLocale"])}(),function(){"use strict";angular.module("app.services",["app.core"])}(),function(){angular.module("app.account",["app.core","app.widgets","app.services"])}(),function(){angular.module("app.checkout-flow",["app.core","app.widgets","app.services"])}(),function(){"use strict";angular.module("app.landing-messages",["app.core","app.widgets"])}(),function(){angular.module("app.order-flow",["app.core","app.widgets","app.services"])}(),function(){"use strict";angular.module("app.password-reset",["app.core","app.widgets","app.services"])}(),function(){"use strict";angular.module("app.widgets",["app.core","app.services"])}(),function(){"use strict";angular.module("app.group-order",["app.core","app.services"])}(),function(){"use strict";angular.module("app.core").constant("states",{ROOT:"root",HOME:"root.home",HOMESETSTORE:"root.homesetstore",ENTREE:"root.entree",CHECKOUT:"root.checkout",ORDER_CONFIRMATION:"root.order-confirmation",REGISTER_ACCOUNT:"root.account-register",ACCOUNT_PAYMENT:"root.account-payment",EDIT_ACCOUNT:"root.account-edit",FAVORITES_RECENTS:"root.favorites-recents",GROUP_INVITEE_HOME:"group-invitee-home",GROUP_INVITEE_ENTREE:"group-invitee-entree",GROUP_INVITEE_DECLINE:"group-invitee-decline",GROUP_INVITEE_DECLINED:"group-invitee-declined",GROUP_INVITEE_ORDER_INACTIVE:"group-invitee-order-inactive",GROUP_INVITEE_MEAL_SUBMITTED:"group-invitee-meal-submitted",GROUP_HOST_HOME:"group-host-home",PASSWORD_RESET:"password-reset",PASSWORD_RESET_ENTER_EMAIL:"password-reset.enter-email",PASSWORD_RESET_EMAIL_SENT:"password-reset.email-sent",PASSWORD_RESET_SUBMIT_PASSWORD:"password-reset.submit-password",PASSWORD_RESET_RESET_CONFIRMATION:"password-reset.confirmation"}).constant("paymentType",{CREDIT_CARD:"credit",SINGLE_USE_CREDIT_CARD:"singleusecredit",GIFT_CARD:"gift",IN_STORE:"instore"}).constant("errors",{INVALID_PASSWORD:"InvalidPassword",DUPLICATE_EMAIL:"DuplicateEmail"})}(),function(){function RouteTable($stateProvider,$urlRouterProvider,$locationProvider,states){$locationProvider.html5Mode(!0),$urlRouterProvider.otherwise("/"),$stateProvider.state(states.ROOT,{abstract:!0,template:"<div ui-view></div>",resolve:{autoLogin:["customer",function(customer){return customer.autoLogin()}]}}).state(states.HOME,{url:"/?storeid",template:"<cmg-order-entree/>",params:{anchor:null},data:{pageTitle:"Online Ordering"},resolve:{setStore:["$stateParams","$state","restaurant","navigate","$q",function($stateParams,$state,restaurant,navigate,$q){return $stateParams.storeid?restaurant.set($stateParams.storeid).then(function(){navigate.toHome()}):$q.when()}]}}).state(states.HOMESETSTORE,{url:"/Meal/Index/:storeid",data:{pageTitle:"Online Ordering"},resolve:{setStore:["$stateParams","$state","restaurant","navigate",function($stateParams,$state,restaurant,navigate){return restaurant.set($stateParams.storeid).then(function(){navigate.toHome()})}]}}).state(states.ENTREE,{url:"/entree/:type?step?mealId",template:"<cmg-order-flow/>",params:{scroll:!0},data:{pageTitle:"Create Your Meal"}}).state(states.CHECKOUT,{url:"/checkout",template:"<checkout-landing/>",data:{pageTitle:"Checkout"}}).state(states.ORDER_CONFIRMATION,{url:"/order-confirmation",template:"<cmg-order-confirmation/>",data:{pageTitle:"Order Confirmation"}}).state(states.REGISTER_ACCOUNT,{url:"/account/register?returnUrl",template:"<cmg-account-register/>",data:{pageTitle:"Register Account"}}).state(states.EDIT_ACCOUNT,{url:"/account/edit",template:"<cmg-account-edit/>",data:{pageTitle:"Account Info"}}).state(states.ACCOUNT_PAYMENT,{url:"/account/payment",template:"<cmg-account-payment/>",data:{pageTitle:"Payment Methods"}}).state(states.FAVORITES_RECENTS,{url:"/favorites-recents",template:"<cmg-favorites-recents/>",data:{pageTitle:"Your Orders"}}).state(states.GROUP_INVITEE_HOME,{url:"/group-order?storeid&orderid&inviteeid",template:"<cmg-group-order/>",data:{pageTitle:"Group Order"}}).state(states.GROUP_HOST_HOME,{url:"/group-order/create",template:"<cmg-group-order-create/>",data:{pageTitle:"Create Group Order"}}).state(states.GROUP_INVITEE_ENTREE,{url:"/group-order/entree/:type?step",template:"<cmg-group-order-flow/>",params:{scroll:!0},data:{pageTitle:"Create Your Group Order"}}).state(states.GROUP_INVITEE_DECLINE,{url:"/Invitational/DeclineGroupOrder?storeid&orderid&inviteeid",template:"<cmg-group-order/>",params:{decline:!0},data:{pageTitle:"Decline Group Order"}}).state(states.GROUP_INVITEE_DECLINED,{url:"/order-declined",params:{message:"ORDER_DECLINED"},template:"<landing-messages/>",data:{pageTitle:"Group Order Declined"}}).state(states.GROUP_INVITEE_ORDER_INACTIVE,{url:"/order-inactive",params:{message:"ORDER_INACTIVE"},template:"<landing-messages/>",data:{pageTitle:"Inactive Group Order"}}).state(states.GROUP_INVITEE_MEAL_SUBMITTED,{url:"/order-added",params:{message:"ORDER_ADDED"},template:"<landing-messages/>",data:{pageTitle:"Group Order Added"}}).state(states.PASSWORD_RESET,{url:"/password-reset",abstract:!0,template:"<password-reset/>"}).state(states.PASSWORD_RESET_ENTER_EMAIL,{url:"/enter-email?returnUrl",template:"<password-reset-enter-email/>",params:{tokenInvalid:!1},data:{pageTitle:"Password Reset Enter Email"}}).state(states.PASSWORD_RESET_EMAIL_SENT,{url:"/email-sent",template:"<password-reset-email-sent/>",params:{email:null},data:{pageTitle:"Password Reset Email Sent"}}).state(states.PASSWORD_RESET_SUBMIT_PASSWORD,{url:"/submit-password?returnUrl",template:"<password-reset-submit-password/>",data:{pageTitle:"Password Reset Submit Password"}}).state(states.PASSWORD_RESET_RESET_CONFIRMATION,{url:"/confirmation?returnUrl",template:"<password-reset-confirmation/>",data:{pageTitle:"Password Reset Confirmation"}})}function PageChange($rootScope,$window,$location,analyticsService,navigate){var stateChangeListener=$rootScope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){navigate.setPreviousState(fromState,fromParams),toParams.scroll!==!1&&(document.body.scrollTop=document.documentElement.scrollTop=0);var baseTitle="Chipotle";if($window.document.title=baseTitle,toState.data&&toState.data.pageTitle){var pageTitle=baseTitle+" - "+toState.data.pageTitle;$window.document.title=pageTitle;var pageUrl=$location.path();analyticsService.virtualPageView(pageTitle,pageUrl)}});$rootScope.$on("$destroy",function(){stateChangeListener()})}angular.module("app").config(RouteTable).run(PageChange),RouteTable.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","states"],PageChange.$inject=["$rootScope","$window","$location","analyticsService","navigate"]}(),function(){function HeadController(config,error,$window){var vm=this;vm.$onInit=function(){$window.dataLayer=$window.dataLayer||[];try{$window.dataLayer.push({language:"English",region:"US",GAProperty:config.googleAnalyticsKey})}catch(err){error.track(err)}}}angular.module("app.core").controller("HeadController",HeadController),HeadController.$inject=["config","error","$window"]}(),function(){"use strict";var supported=!0;window.addEventListener||(supported=!1);var oldIe=new RegExp("MSIE [1-8].","i");oldIe.test(window.navigator.userAgent)&&(supported=!1),Array.prototype||(supported=!1),document.location.href.indexOf("badbrowser")!==-1&&(supported=!1),supported||(document.location.href="Error.html")}(),function(){"use strict";if(Array.prototype&&(Array.prototype.findIndex||(Array.prototype.findIndex=function(predicate){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var value,list=Object(this),length=list.length>>>0,thisArg=arguments[1],i=0;i<length;i++)if(value=list[i],predicate.call(thisArg,value,i,list))return i;return-1},Array.prototype.find||(Array.prototype.find=function(predicate){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var value,list=Object(this),length=list.length>>>0,thisArg=arguments[1],i=0;i<length;i++)if(value=list[i],predicate.call(thisArg,value,i,list))return value}))),!window.requestAnimationFrame){var requestAnimationFramelastTime=0;window.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-requestAnimationFramelastTime)),id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return requestAnimationFramelastTime=currTime+timeToCall,id}}window.cancelAnimationFrame||(window.cancelAnimationFrame=function(id){clearTimeout(id)})}(),function(){"use strict";angular.module("app.landing-messages").component("landingMessages",{templateUrl:"templates/landing-messages/landing-messages.html",controller:"LandingMessagesController"})}(),function(){"use strict";function LandingMessagesController($stateParams,$window,navigate){function init(){angular.isDefined($stateParams.message)&&$stateParams.message in vm.t&&(messageType=vm.t[$stateParams.message])}function startOrder(){navigate.toHome()}function learn(){$window.location.href="http://www.chipotle.com/nutrition-calculator"}function showFor(arrayOfTypes){return arrayOfTypes.indexOf(messageType)!==-1}var vm=this;vm.startOrder=startOrder,vm.learn=learn,vm.showFor=showFor,vm.t={ERROR:0,ORDER_DECLINED:1,ORDER_INACTIVE:2,ORDER_ADDED:3};var messageType=vm.t.ERROR;init()}angular.module("app.landing-messages").controller("LandingMessagesController",LandingMessagesController),LandingMessagesController.$inject=["$stateParams","$window","navigate"]}(),function(){"use strict";angular.module("app.password-reset").component("passwordReset",{templateUrl:"templates/password-reset/password-reset.html"})}(),function(){"use strict";function Analytics(error,restaurant,$window){function fireEvent(name){$window.dataLayer.push({event:name})}function fireCustomEvent(category,action,label,value){try{$window.dataLayer.push({event:"customEvent",eventCategory:category,
eventAction:action,eventLabel:label,eventValue:value})}catch(e){error.track(e)}}function virtualPageView(pageTitle,pageUrl){safeExecute(function(){$window.dataLayer.push({event:"analyticsVPV",pageTitle:pageTitle,pageUrl:pageUrl})})}function productClick(name,category){safeExecute(function(){$window.dataLayer.push({event:"productClick",ecommerce:{click:{name:name,category:category}}})})}function productView(name,category){safeExecute(function(){$window.dataLayer.push({event:"productView",ecommerce:{detail:{name:name,category:category}}})})}function addToBag(meal){safeExecute(function(){$window.dataLayer.push({event:"addToBag",ecommerce:{add:{products:mapMealToProducts(meal)}}})})}function addMultipleMealsToBag(order){safeExecute(function(){$window.dataLayer.push({event:"addToBag",ecommerce:{add:{products:buildProducts(order)}}})})}function purchase(order,total,tax){safeExecute(function(){$window.dataLayer.push({event:"submitOrder",ecommerce:{purchase:{actionField:{id:order.orderId,affiliation:restaurant.getId(),revenue:total,tax:tax},products:buildProducts(order)}}})})}function checkout(order,step){safeExecute(function(){$window.dataLayer.push({event:"checkout",ecommerce:{checkout:{actionField:{id:order.orderId,step:step},products:buildProducts(order)}}})})}function checkoutOption(step,option){safeExecute(function(){$window.dataLayer.push({event:"checkoutOption",ecommerce:{checkout_option:{actionField:{step:step,option:option}}}})})}function buildProducts(order){var products=[];return angular.forEach(order.meals,function(meal){products=products.concat(mapMealToProducts(meal))}),products}function mapMealToProducts(meal){var products=[];if("SidesDrinks"!==meal.meal.Type){var entreeType="Tacos"!==meal.meal.Type?meal.mealSummary.entree.substring(meal.mealSummary.entree.indexOf(" ")+1):meal.mealSummary.entree;products.push({name:meal.meal.Name,id:meal.meal.mealId,category:"Entree",variant:entreeType,quantity:1,price:meal.mealSummary.price,brand:meal.meal.mealType})}var sidesDrinks=meal.mealSummary.sides.concat(meal.mealSummary.drinks);return sidesDrinks.length>0&&angular.forEach(sidesDrinks,function(sideDrink){products.push({id:meal.meal.mealId,name:sideDrink.Type,category:"Sides",quantity:sideDrink.quantity,price:sideDrink.Price,brand:meal.meal.mealType})}),products}function safeExecute(f){try{f()}catch(e){error.track(e)}}return{fireEvent:fireEvent,fireCustomEvent:fireCustomEvent,virtualPageView:virtualPageView,productClick:productClick,productView:productView,addToBag:addToBag,purchase:purchase,checkout:checkout,checkoutOption:checkoutOption,addMultipleMealsToBag:addMultipleMealsToBag}}angular.module("app.services").factory("analyticsService",Analytics),Analytics.$inject=["error","restaurant","$window"]}(),function(){"use strict";function Api($http,config){function resetPassword(token,password){var command={resetToken:token,password:password};return post("/customer/resetpassword",command)}function initiatePasswordReset(email,url){var command={email:email,returnUrl:url};return post("/customer/initiatepasswordreset",command)}function getPasswordCriteria(){return get("/customer/passwordcriteria",{cache:!0})}function getPasswordResetInfo(token){return get("/customer/passwordresetinfo/"+token)}function getInviteeInfo(inviteeid){return get("/grouporder/getinviteeinfo/"+inviteeid)}function declineGroupInvitation(inviteeId){return get("/grouporder/declinegroupinvitation/"+inviteeId)}function sendGroupOrderInvites(storeId,friends,orderId){var id=orderId||0,orderData={storeId:storeId,friends:friends};return post("/grouporder/"+id+"/sendinvites",orderData)}function getMenu(restaurantId){return get("/restaurant/"+restaurantId+"/menu")}function getRestaurant(restaurantId){return get("/restaurant/"+restaurantId)}function addInviteeMeal(inviteeId,meal){return post("/grouporder/invitee/"+inviteeId+"/meal/",meal)}function addMeal(orderId,meal,storeId){return post("/order/"+orderId+"/meal/"+storeId,meal)}function addMeals(orderId,meals,storeId){return post("/order/"+orderId+"/meals/"+storeId,meals)}function submitOrder(orderId,paymentInfo){return post("/order/"+orderId+"/submit",paymentInfo)}function getBag(orderId,storeId){return get("/order/"+orderId+"/bag/"+storeId)}function getGuestSession(){return post("/customer/guest")}function register(customer){return post("/customer/register",customer)}function getCustomer(){return get("/customer/get")}function updateCustomer(customer){return post("/customer",customer)}function login(command){return post("/customer/login",command)}function autoLogin(){return post("/customer/autologin")}function xsrf(){return get("/customer/xsrf")}function logout(customerId){var command={customerId:customerId};return post("/customer/logout",command)}function getPickupTimes(restaurantId,orderId){return get("/restaurant/"+restaurantId+"/pickuptimes/"+orderId)}function setPickupTime(orderId,timeslot){return post("/order/"+orderId+"/pickuptime",timeslot)}function getFavorites(storeId){return get("/order/favorites/"+storeId)}function getRecents(storeId){return get("/order/recents/"+storeId)}function tokenizeCreditCard(card){var url=config.payeezyJsHost+"/v1/securitytokens?apikey="+config.payeezyApiKey+"&js_security_key="+config.payeezyJsSecurityKey+"&ta_token="+config.payeezyTaToken+"&auth="+!0+"&currency=USD&type=FDToken&callback=JSON_CALLBACK&credit_card.type="+card.type+"&credit_card.cardholder_name="+card.name+"&credit_card.card_number="+card.number+"&credit_card.exp_date="+card.expiration+"&credit_card.cvv="+card.cvv+"&billing_address.email="+card.email+"&billing_address.phone.type="+card.phoneType+"&billing_address.phone.number="+card.phoneNumber+"&billing_address.city="+card.city+"&billing_address.country="+card.country+"&billing_address.street="+card.street+"&billing_address.zip_postal_code="+card.zipCode+"&billing_address.state_province="+card.state;return $http.jsonp(url)}function saveCreditCard(card){return post("/customer/creditcard",card)}function getCreditCards(){return get("/customer/creditcard")}function getCreditCard(id){return get("/customer/creditcard/"+id)}function deleteCreditCard(id){return del("/customer/creditcard/"+id)}function saveGiftCard(card){return post("/customer/giftcard",card)}function getGiftCards(){return get("/customer/giftcard")}function getGiftCard(id){return get("/customer/giftcard/"+id)}function deleteGiftCard(id){return del("/customer/giftcard/"+id)}function getTotals(orderId,restaurantId){return get("/order/"+orderId+"/totals/"+restaurantId)}function removeMeal(mealId){return del("/order/meal/"+mealId)}function restaurantsSearch(address,radius,startIndex,returnCount){return post("/restaurant/restaurantssearch",{Address:address,Radius:radius,StartIndex:startIndex,ReturnCount:returnCount})}function addfavoriteorder(orderId,orderName){return post("/customer/favorite/"+orderId,angular.toJson(orderName))}function removeFavoriteOrder(orderId){return del("/customer/favorite/"+orderId)}function addFriends(emails){return post("/customer/friends",emails)}function removeFriends(friendIds){return post("/customer/friends/remove",friendIds)}function getFriends(){return get("/customer/friends")}function cancelOrder(id){return del("/order/"+id)}function getEPops(restaurantId){return get("/restaurant/"+restaurantId+"/epops")}function changeLocation(orderId,restaurantId){return get("/order/"+orderId+"/restaurant/"+restaurantId)}function endpointUrl(path){return config.apiBaseUrl+path}function get(path){return $http.get(endpointUrl(path),{withCredentials:!0})}function post(path,data){return $http.post(endpointUrl(path),data,{withCredentials:!0})}function del(path){return $http.delete(endpointUrl(path),{withCredentials:!0})}return{resetPassword:resetPassword,initiatePasswordReset:initiatePasswordReset,getPasswordCriteria:getPasswordCriteria,getPasswordResetInfo:getPasswordResetInfo,getInviteeInfo:getInviteeInfo,getMenu:getMenu,getRestaurant:getRestaurant,addInviteeMeal:addInviteeMeal,declineGroupInvitation:declineGroupInvitation,sendGroupOrderInvites:sendGroupOrderInvites,getGuestSession:getGuestSession,register:register,login:login,autoLogin:autoLogin,logout:logout,xsrf:xsrf,getCustomer:getCustomer,updateCustomer:updateCustomer,addMeal:addMeal,addMeals:addMeals,submitOrder:submitOrder,getBag:getBag,tokenizeCreditCard:tokenizeCreditCard,saveCreditCard:saveCreditCard,getCreditCards:getCreditCards,getCreditCard:getCreditCard,deleteCreditCard:deleteCreditCard,saveGiftCard:saveGiftCard,getGiftCards:getGiftCards,getGiftCard:getGiftCard,deleteGiftCard:deleteGiftCard,getPickupTimes:getPickupTimes,removeMeal:removeMeal,setPickupTime:setPickupTime,getTotals:getTotals,restaurantsSearch:restaurantsSearch,getFavorites:getFavorites,getRecents:getRecents,addfavoriteorder:addfavoriteorder,removeFavoriteOrder:removeFavoriteOrder,addFriends:addFriends,removeFriends:removeFriends,getFriends:getFriends,cancelOrder:cancelOrder,getEPops:getEPops,changeLocation:changeLocation}}angular.module("app.services").factory("api",Api),Api.$inject=["$http","config"]}(),function(){"use strict";function Customer(api,$q,navigate,session,restaurant,event,$window,analyticsService){function isAuthenticated(){var authenticated=session.get("isAuthenticated");return authenticated||!1}function get(){return customer?$q.when(customer):api.getCustomer().then(getCustomerSuccess,getCustomerFailure)}function register(customer){return api.register(customer).then(function(response){loginSuccess(response)})}function login(command){return api.login(command).then(loginSuccess)}function autoLogin(){var loginPromise=null;try{return loginPromise=isAuthenticated()?api.getCustomer():api.autoLogin().then(function(response){response.data&&""!==response.data&&response.data.CustomerId&&analyticsService.fireCustomEvent("customer","autologin","success"),loginSuccess(response)}),loginPromise.then(function(){session.setReloadOnExpiration(!0)},function(){return session.setReloadOnExpiration(!0),$q.when()})}catch(e){return $q.when()}}function logout(){customer&&api.logout(customer.Id).then(function(){session.destroy(),$window.location.href="/"})}function update(updatedCustomer){return customer.FirstName=updatedCustomer.firstName,customer.LastName=updatedCustomer.lastName,customer.Email=updatedCustomer.email,customer.HomePhone=updatedCustomer.phone,api.updateCustomer(updatedCustomer).then(function(response){return response})}function onLoginSuccess(scope,callback){event.on(event.LOGIN_SUCCESS,callback,scope)}function addFriends(emails){return api.addFriends(emails)}function removeFriends(friendIds){return api.removeFriends(friendIds)}function getFriends(){return api.getFriends().then(function(response){return response.data})}function getCustomerSuccess(response){return response.data&&response.data.Customer&&(customer=customer||{},angular.copy(response.data.Customer,customer)),customer}function getCustomerFailure(){return customer=null,session.set("isAuthenticated",!1),$q.reject()}function loginSuccess(response){var login=response.data;login&&""!==login&&(!restaurant.getId()&&login.SelectedLocation&&restaurant.set(login.SelectedLocation),login.CustomerId>0&&(session.remove("ExpiredSession"),session.set("isAuthenticated",!0)),event.emit(event.LOGIN_SUCCESS,login))}var customer=null,emailregex=/[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)+/i;return{isAuthenticated:isAuthenticated,get:get,register:register,login:login,autoLogin:autoLogin,logout:logout,update:update,onLoginSuccess:onLoginSuccess,addFriends:addFriends,removeFriends:removeFriends,getFriends:getFriends,emailRegex:emailregex}}angular.module("app.services").factory("customer",Customer),Customer.$inject=["api","$q","navigate","session","restaurant","event","$window","analyticsService"]}(),function(){function configureExceptionHandler($provide){$provide.decorator("$exceptionHandler",exceptionHandlerDecorator)}function exceptionHandlerDecorator($delegate,$window){return function(exception,cause){$window.trackJs&&$window.trackJs.track(exception),$delegate(exception,cause)}}angular.module("app").config(configureExceptionHandler),configureExceptionHandler.$inject=["$provide"],exceptionHandlerDecorator.$inject=["$delegate","$window"]}(),function(){"use strict";function error(){function track(message){angular.isDefined(trackJs)&&trackJs.track(message)}function showUser(title,message){modalTitle=title,modalMessage=angular.isDefined(message.message)?message.message:message,track(message),modalShow=!0}function showErrorModal(){return modalShow}function hideErrorModal(){modalShow=!1}function getErrorTitle(){return modalTitle}function getErrorMessage(){return modalMessage}var modalShow=!1,modalTitle="",modalMessage="";return{track:track,showUser:showUser,showErrorModal:showErrorModal,hideErrorModal:hideErrorModal,getErrorTitle:getErrorTitle,getErrorMessage:getErrorMessage}}angular.module("app.services").factory("error",error),error.$inject=[]}(),function(){"use strict";function EventService($rootScope){function on(event,callback,scope){var listener=$rootScope.$on(event,callback);scope.$on("$destroy",listener)}function emit(event,data){$rootScope.$emit(event,data)}return{on:on,emit:emit,STORE_CHANGE:"store:change",LOGIN_SUCCESS:"login:success"}}angular.module("app.services").factory("event",EventService),EventService.$inject=["$rootScope"]}(),function(){"use strict";function existingOrder(session,orderService,bag,$state,states,navigate,confirmationModal){function cancelExistingOrder(){bag.cancelGroupOrder(onCancelComplete,showExistingOrderModal),session.set("orderId",openOrderId)}function goToExistingOrder(){session.set("orderId",openOrderId),orderService.getOrder().then(function(){bag.open(!1),navigate.toHome()})}function onCancelComplete(){openOrderId=0,orderService.cancelOrder()}function showExistingOrderModal(){var options={title:"ORDER IN PROGRESS",headingText:"YOU HAVE AN OPEN ORDER",bodyText:"You started an order but didn't check out. Want to pick up where you left off?",confirmButtonText:"VIEW ORDER",cancelButtonText:"CANCEL ORDER",preventClose:!0,onConfirm:goToExistingOrder,onCancel:cancelExistingOrder};confirmationModal.show(options)}function checkExistingOrder(event,data){data.OpenOrderId>0&&"Group"===data.OrderType&&(showExistingOrderModal(),openOrderId=data.OpenOrderId)}var service={cancelExistingOrder:cancelExistingOrder,goToExistingOrder:goToExistingOrder,onCancelComplete:onCancelComplete,showExistingOrderModal:showExistingOrderModal,checkExistingOrder:checkExistingOrder},openOrderId=0;return service}angular.module("app.widgets").factory("existingOrder",existingOrder),existingOrder.$inject=["session","orderService","bag","$state","states","navigate","confirmationModal"]}(),function(){"use strict";function configureRestInterceptor($httpProvider){$httpProvider.interceptors.push("restInterceptor")}function restInterceptor($cookies,$timeout){function request(config){if("GET"===config.method){if(angular.isDefined(promises[config.url]))return promises[config.url];promises[config.url]=config,$timeout(function(){delete promises[config.url]},1e3)}return"POST"!==config.method&&"DELETE"!==config.method||(config.headers["X-XSRF-TOKEN"]=$cookies.get("XSRF-TOKEN")),config}var promises={};return{request:request}}angular.module("app.services").factory("restInterceptor",restInterceptor).config(configureRestInterceptor),configureRestInterceptor.$inject=["$httpProvider"],restInterceptor.$inject=["$cookies","$timeout"]}(),function(){"use strict";function configureSessionInterceptor($httpProvider){$httpProvider.interceptors.push("sessionInterceptor")}function sessionInterceptor($injector,$q,$window){function responseError(response){var session=$injector.get("session"),navigate=$injector.get("navigate");if(response.data){if(response.config.url.toLowerCase().indexOf("getinviteeinfo")>-1)return $q.reject(response);"ExpiredSession"===response.data.Type&&(session.get("ExpiredSession")||(session.destroy(),$window.location.pathname.length>1&&session.set("ExpiredSession",!0),session.getReloadOnExpiration()?$window.location.href="/":navigate.toHome()))}return $q.reject(response)}return{responseError:responseError}}angular.module("app.services").factory("sessionInterceptor",sessionInterceptor).config(configureSessionInterceptor),configureSessionInterceptor.$inject=["$httpProvider"],sessionInterceptor.$inject=["$injector","$q","$window"]}(),function(){"use strict";function mealService($log,$filter,fillingsService,customizations){function filterSelected(meal){var _meal={};if(meal){if(angular.copy(meal,_meal),_meal.Fillings&&(_meal.Fillings=_meal.Fillings.filter(function(filling){return filling.selected===!0})),_meal.Rice&&(_meal.Rice=_meal.Rice.filter(function(rice){return rice.selected===!0})),_meal.Beans&&(_meal.Beans=_meal.Beans.filter(function(bean){return bean.selected===!0})),_meal.Toppings&&(_meal.Toppings=_meal.Toppings.filter(function(topping){return topping.selected===!0})),_meal.Drinks){var tempDrinks=angular.copy(_meal.Drinks);_meal.Drinks=[],angular.forEach(tempDrinks,function(value){_meal.Drinks=_meal.Drinks.concat(value.filter(function(drink){return drink.selected===!0}))})}if(_meal.Sides&&(_meal.Sides=_meal.Sides.filter(function(side){return side.selected===!0})),_meal.KidsSides&&(_meal.Sides=_meal.KidsSides.filter(function(side){return side.selected===!0})),_meal.KidsDrinks&&(_meal.Drinks=_meal.KidsDrinks.filter(function(drink){return drink.selected===!0})),_meal.Quantities){var qty=_meal.Quantities.filter(function(item){return item.selected===!0})[0];if(qty)switch(qty.Name){case"1 Taco":_meal.quantity=1;break;case"2 Tacos":_meal.quantity=2;break;case"3 Tacos":_meal.quantity=3;break;default:_meal.quantity=1}}return _meal&&(_meal.basePrice=getMainEntreePrice(_meal),_meal.Fillings&&_meal.Fillings.forEach(function(item){delete item.Price})),_meal}return null}function hasEntree(meal){return!!(meal&&meal.Fillings&&meal.Fillings.length>0)}function maxCustomizationsReached(){return customizations.maxCustomizationsReached()}function getMealSummary(meal){if("Tacos"===meal.Type){var item=getSelectedItems(meal.Quantities)[0];assignPrices(item.Prices,meal.Fillings),assignPrices(item.Prices,meal.Toppings)}var mealSummary={entree:getEntreeNameForSummary(meal),portion:"1",price:0,entreeContents:"",fillings:getSelectedItems(meal.Fillings),sides:getSelectedItems(meal.Type.indexOf("Kids")>-1?meal.KidsSides:meal.Sides),drinks:meal.Type.indexOf("Kids")>-1?getSelectedItems(meal.KidsDrinks):getSelectedDrinks(meal.Drinks),subtotal:0};if(mealSummary.fillings&&mealSummary.fillings.length>0){var extra=!1;extra=2===mealSummary.fillings.length?"single"===mealSummary.fillings[0].portion:"extra"===mealSummary.fillings[0].portion,mealSummary.price=fillingsService.totalPrice(mealSummary.fillings,extra),angular.forEach(mealSummary.fillings,function(filling){filling.portion=getPortionDisplayTitle(filling.portion)})}else if("KidsBuildYourOwn"===meal.Type){var prices=meal.Fillings.map(function(item){return item.Price});mealSummary.price=Math.min.apply(null,prices)}if(meal.Toppings){var selectedToppings=getSelectedItems(meal.Toppings);angular.forEach(selectedToppings,function(topping){topping.Price&&topping.Price>0&&!topping.free&&(mealSummary.price+=topping.Price)})}return mealSummary.entreeContents=buildEntreeContents(meal,mealSummary.fillings),mealSummary.subtotal=mealSummary.price+getItemsTotal(mealSummary),mealSummary}function buildEntreeContents(meal,fillings){function buildEntreeContentString(item,includePrice){var itemSummary=item.SummaryName;return item.customization&&(itemSummary+=" ("+item.customization+")"),includePrice?item.free?itemSummary+" ("+$filter("currency")(0)+")":item.Price>0?itemSummary+" ("+$filter("currency")(item.Price)+")":itemSummary:itemSummary}var selectedItems=[],contents=selectedItems.concat(getSelectedItems(meal.Tortillas),getSelectedItems(meal.Rice),getSelectedItems(meal.Beans)),nameList=[];angular.forEach(fillings,function(filling){nameList.push(filling.portion+" "+buildEntreeContentString(filling,!1))});for(var i=0;i<contents.length;i++)contents[i]&&nameList.push(buildEntreeContentString(contents[i],!1));return angular.forEach(getSelectedItems(meal.Toppings),function(item){nameList.push(buildEntreeContentString(item,!0))}),nameList.join(", ")}function getEntreeName(meal){if(!meal||!meal.Type)return null;switch(meal.Type){case"SidesDrinks":return"sides & drinks";case"KidsQuesadilla":return"Kid's "+getEntreeDisplayPrefix(meal)+" Quesadilla";case"KidsBuildYourOwn":return"Kid's Build Your Own";case"BurritoBowl":var prefix=getEntreeDisplayPrefix(meal);return""!==prefix?prefix+" bowl":"burrito bowl";case"Tacos":var quantity=getSelectedItems(meal.Quantities)[0];return quantity?quantity.Name.substr(0,2)+getEntreeDisplayPrefix(meal)+quantity.Name.substr(1):"tacos";default:return getEntreeDisplayPrefix(meal)+" "+meal.Name}}function getPortionDisplayTitle(portion){switch(portion){case"double":return"1x";case"half":return"½";case"single":return"";case"extra":return"2x"}}function hasCustomizations(meal){return!!(meal&&meal.MaxCustomizations&&meal.MaxCustomizations>0)}function getSelectedItems(items){return $filter("filter")(angular.copy(items),{selected:!0})}function getSelectedDrinks(mealDrinks){var drinks=[];return angular.forEach(mealDrinks,function(group){drinks=drinks.concat(getSelectedItems(group))}),drinks}function assignPrices(prices,items){angular.forEach(items,function(mealItem){var pricedItem=prices.find(function(item){return mealItem.Type===item.Type});pricedItem&&(mealItem.Price=pricedItem.Price,mealItem.ExtraPrice=pricedItem.ExtraPrice)})}function getItem(itemType,items){var item=items.find(function(item){return item.Type===itemType});return item}function getEntreeNameForSummary(meal){if(!meal||!meal.Type)return null;var name=getEntreeName(meal);switch(meal.Type){case"SidesDrinks":return null;case"Tacos":return name;default:return"1 "+name}}function getEntreeDisplayPrefix(meal){if(meal){var fillings=getSelectedItems(meal.Fillings);if(fillings){if(1===fillings.length)return fillings[0].SummaryName;if(2===fillings.length)return fillings[0].SummaryName+" & "+fillings[1].SummaryName}}return""}function getTotal(meal){var items=filterSelected(meal),total=0;return angular.forEach(items,function(item){total+=item.quantity&&item.quantity>1?item.Price*item.quantity:item.Price}),total}function getMainEntreePrice(meal){var extra=!1,price=0;return meal.Fillings?(2===meal.Fillings.length&&(extra="single"===meal.Fillings[0].portion),1===meal.Fillings.length&&(extra="extra"===meal.Fillings[0].portion),price=fillingsService.totalPrice(meal.Fillings,extra)):null}function getItemsTotal(mealSummary){var total=0,categories=["toppings","sides","drinks"];return angular.forEach(categories,function(category){var items=mealSummary[category];items&&angular.forEach(items,function(item){var quantity=angular.isUndefined(item.quantity)?1:item.quantity;item.free&&(item.Price=0),item.Price&&(total+=item.Price*quantity)})}),total}return{getMealSummary:getMealSummary,buildEntreeContents:buildEntreeContents,getEntreeName:getEntreeName,getPortionDisplayTitle:getPortionDisplayTitle,getSelectedItems:getSelectedItems,getSelectedDrinks:getSelectedDrinks,assignPrices:assignPrices,getItem:getItem,hasCustomizations:hasCustomizations,maxCustomizationsReached:maxCustomizationsReached,filterSelected:filterSelected,getTotal:getTotal,getMainEntreePrice:getMainEntreePrice,hasEntree:hasEntree}}angular.module("app.services").factory("mealService",mealService),mealService.$inject=["$log","$filter","fillingsService","customizations"]}(),function(){"use strict";function Menu(api,restaurant,error,$q,$rootScope){function get(){return menu?$q.when(menu):update()}function update(){var storeId=restaurant.getId();return storeId?api.getMenu(storeId).then(getMenuSuccess,getMenuFailure):$q.reject()}function getMenuSuccess(response){return menu=menu||{},angular.copy(response.data,menu),menu}function getMenuFailure(){return menu=null}var menu=null;return restaurant.onChange($rootScope,update),{get:get,update:update}}angular.module("app.services").factory("menu",Menu),Menu.$inject=["api","restaurant","error","$q","$rootScope"]}(),function(){"use strict";function navigate($state,states,session){function toPreviousState(){var previousState=session.get("previousState"),previousStateParams=session.get("previousStateParams");!previousState||previousState.abstract?toHome():$state.go(previousState.name,previousStateParams)}function setPreviousState(state,params){state.abstract||(session.set("previousState",state),session.set("previousStateParams",params))}function toHome(){$state.go(states.HOME)}function toHomePastHero(){$state.go(states.HOME,{anchor:"pastHero"})}function toEntree(entreeType,step,scroll){var stateParams={type:entreeType.toLowerCase(),step:step,scroll:scroll};$state.go(states.ENTREE,stateParams)}function toEntreeEdit(entreeType,mealId){"SidesDrinks"===entreeType?entreeType="sides-drinks":"BurritoBowl"===entreeType&&(entreeType="bowl");var stateParams={type:entreeType.toLowerCase(),mealId:mealId,step:null};$state.go(states.ENTREE,stateParams)}function toCheckout(){$state.go(states.CHECKOUT)}function toOrderConfirmation(){$state.go(states.ORDER_CONFIRMATION)}function toRegisterAccount(){$state.go(states.REGISTER_ACCOUNT)}function toEditAccount(){$state.go(states.EDIT_ACCOUNT)}function toFavoritesRecents(){$state.go(states.FAVORITES_RECENTS)}function toAccountPayment(){$state.go(states.ACCOUNT_PAYMENT)}function toGroupOrderInviteeHome(){$state.go(states.GROUP_INVITEE_HOME)}function toGroupOrderInviteeEntree(entreeType,step){"SidesDrinks"===entreeType?entreeType="sides-drinks":"BurritoBowl"===entreeType&&(entreeType="bowl");var stateParams={type:entreeType,step:step};$state.go(states.GROUP_INVITEE_ENTREE,stateParams)}function toDeclineGroupOrder(){$state.go(states.GROUP_INVITEE_DECLINE)}function toGroupOrderDeclined(){$state.go(states.GROUP_INVITEE_DECLINED)}function toGroupOrderInactive(){$state.go(states.GROUP_INVITEE_ORDER_INACTIVE)}function toInviteeMealSubmitted(){$state.go(states.GROUP_INVITEE_MEAL_SUBMITTED)}function toGroupOrderHostHome(){$state.go(states.GROUP_HOST_HOME)}function toPasswordResetEnterEmail(tokenInvalid){var stateParams={tokenInvalid:tokenInvalid};$state.go(states.PASSWORD_RESET_ENTER_EMAIL,stateParams)}function toPasswordResetEmailSent(email){var stateParams={email:email};$state.go(states.PASSWORD_RESET_EMAIL_SENT,stateParams)}function toPasswordResetSubmitPassword(){$state.go(states.PASSWORD_RESET_SUBMIT_PASSWORD)}function toPasswordResetConfirmation(url){var stateParams={returnUrl:url};$state.go(states.PASSWORD_RESET_RESET_CONFIRMATION,stateParams)}return{toPreviousState:toPreviousState,setPreviousState:setPreviousState,toHome:toHome,toHomePastHero:toHomePastHero,toEntree:toEntree,toEntreeEdit:toEntreeEdit,toCheckout:toCheckout,toOrderConfirmation:toOrderConfirmation,toRegisterAccount:toRegisterAccount,toEditAccount:toEditAccount,toFavoritesRecents:toFavoritesRecents,toAccountPayment:toAccountPayment,toGroupOrderInviteeHome:toGroupOrderInviteeHome,toGroupOrderInviteeEntree:toGroupOrderInviteeEntree,toDeclineGroupOrder:toDeclineGroupOrder,toGroupOrderDeclined:toGroupOrderDeclined,toGroupOrderInactive:toGroupOrderInactive,toInviteeMealSubmitted:toInviteeMealSubmitted,toGroupOrderHostHome:toGroupOrderHostHome,toPasswordResetEnterEmail:toPasswordResetEnterEmail,toPasswordResetEmailSent:toPasswordResetEmailSent,toPasswordResetSubmitPassword:toPasswordResetSubmitPassword,toPasswordResetConfirmation:toPasswordResetConfirmation}}angular.module("app.services").factory("navigate",navigate),navigate.$inject=["$state","states","session"]}(),function(){"use strict";function orderService(api,$q,entreeService,navigate,session,menu,$filter,mealService,bag,restaurant,customer,analyticsService){function getOrder(){return order.orderId===session.get("orderId")?$q.when(order):getBag()}function cancelOrder(id){var orderId=id?id:getOrderId();return api.cancelOrder(orderId).then(function(){session.set("orderId",0);var emptyOrder={meals:[],orderId:0};angular.copy(emptyOrder,order)})}function getDefaultMealName(){function getMealName(){var mealCounter=order.meals.length+1;return"Meal "+mealCounter}var deferred=$q.defer();return deferred.resolve(getMealName()),deferred.promise}function addMeal(){return customer.isAuthenticated()?addToBag():api.getGuestSession().then(function(){return addToBag()})}function refreshBag(){return getBag()}function removeMeal(mealId){return api.removeMeal(mealId).then(function(){return getBag()})}function getOrderId(){return session.get("orderId")}function submitOrder(){var orderId=session.get("orderId"),storeId=restaurant.getId(),submitCommand={paymentCard:orderDetails.paymentCard,paymentType:orderDetails.paymentType,storeId:storeId};return api.setPickupTime(orderId,timeslot).then(function(){return api.submitOrder(order.orderId,submitCommand).then(function(response){session.remove("previousOrder"),session.set("previousOrder",{order:order,orderDetails:orderDetails,timeslot:getPickupTime()}),session.remove("orderId");var emptyOrder={meals:[],orderId:0};return angular.copy(emptyOrder,order),response})})}function getTotals(restaurantId){var orderId=session.get("orderId");return api.getTotals(orderId,restaurantId).then(function(response){var totals=response.data;return orderDetails.tax=totals.Tax,orderDetails.total=totals.Total,orderDetails.subtotal=totals.Subtotal,totals})}function getSubTotal(orderId){return getBag(orderId).then(function(bag){var price=0;return bag.meals.length>0&&bag.meals.forEach(function(item){price+=item.mealSummary.subtotal}),price})}function setPickupTime(newTimeslot){timeslot=newTimeslot}function getPickupTime(){return timeslot}function getFavorites(){if(!customer.isAuthenticated()||!restaurant.getId())return $q.when([]);var menuPromise=menu.get().then(function(menu){return menu}),favoritesPromise=api.getFavorites(restaurant.getId()).then(function(data){return data.data});return $q.all([menuPromise,favoritesPromise]).then(function(response){var menuData=response[0],orders=response[1],mappedOrders=[];return angular.forEach(orders,function(item,index){item.OrderName=orders[index].OrderName,mappedOrders.push(mapOrder(menuData,item))}),mappedOrders},function(){return $q.when([])})}function getRecents(){if(!customer.isAuthenticated()||!restaurant.getId())return $q.when([]);var menuPromise=menu.get().then(function(menu){return menu}),recentsPromise=api.getRecents(restaurant.getId()).then(function(data){return data.data});return $q.all([menuPromise,recentsPromise]).then(function(response){var menu=response[0],orders=response[1],mappedOrders=[];return angular.forEach(orders,function(item,index){item.OrderName=orders[index].OrderName,mappedOrders.push(mapOrder(menu,item))}),mappedOrders},function(){return $q.when([])})}function mapOrder(menu,apiBag){var mappedOrder={};return mappedOrder.orderId=apiBag.OrderId,mappedOrder.orderName=apiBag.OrderName,mappedOrder.orderDate=apiBag.OrderDate,mappedOrder.orderType=apiBag.OrderType,mappedOrder.hasUnavailableItems=apiBag.HasUnavailableItems,mappedOrder.meals=[],angular.forEach(apiBag.Meals,function(meal){var createdMeal=entreeService.createMeal(menu,meal.Entree);if(createdMeal.name=meal.Name,createdMeal.email=meal.Email,createdMeal.mealType=meal.MealType,createdMeal.instructions=meal.Instructions,createdMeal.mealId=meal.MealId,createdMeal.mealType=meal.MealType,createdMeal.hasUnavailableItems=meal.HasUnavailableItems,angular.forEach(createdMeal,function(prop){angular.isString(prop)||angular.forEach(prop,function(item){angular.isArray(item)?angular.forEach(item,function(drink){setSelected(meal.Items,drink)}):setSelected(meal.Items,item)})}),mapBothRiceBeans(createdMeal),createdMeal.Toppings){var guac=mealService.getItem("GuacTopping",createdMeal.Toppings);if(guac&&guac.selected){var veggie=mealService.getItem("Veggie",createdMeal.Fillings);veggie&&veggie.selected&&(guac.free=!0)}}var mealSummary=mealService.getMealSummary(createdMeal),orderMeal={
mealSummary:mealSummary,meal:createdMeal,entree:createdMeal.Type};mappedOrder.meals.push(orderMeal)}),mappedOrder}function mapBothRiceBeans(meal){var rice,beans;meal.Rice&&(rice=meal.Rice.filter(function(item){return("RiceWhite"===item.Type||"RiceBrown"===item.Type)&&item.selected===!0})),meal.Beans&&(beans=meal.Beans.filter(function(item){return("BeansBlack"===item.Type||"BeansPinto"===item.Type)&&item.selected===!0})),rice&&2===rice.length&&angular.forEach(rice,function(item){item.portion="half",delete item.Portion}),beans&&2===beans.length&&angular.forEach(beans,function(item){item.portion="half",delete item.Portion})}function setSelected(items,item){item.isDefault&&(item.selected=!1);var selectedItem=$filter("filter")(items,{Type:item.Type},!0);selectedItem.length>0&&(item.selected=!0,item.quantity=selectedItem[0].Quantity,item.portion="Regular"===selectedItem[0].Portion?"single":selectedItem[0].Portion.toLowerCase(),item.customization=selectedItem[0].Customization)}function getBag(id){var orderId=id?id:session.get("orderId"),storeId=restaurant.getId();if(!orderId){var emptyOrder={meals:[],orderId:0};return angular.copy(emptyOrder,order),$q.when(order)}var getMenu=menu.get().then(function(menu){return menu}),getSack=api.getBag(orderId,storeId).then(function(data){return data.data});return $q.all([getSack,getMenu]).then(function(response){var menu=response[1],sack=response[0],mappedOrder=mapOrder(menu,sack);return angular.equals(mappedOrder,order)||angular.copy(mappedOrder,order),order},function(){return session.remove("orderId"),emptyOrder={meals:[],orderId:0},angular.copy(emptyOrder,order),order})}function addToBag(){var meal=entreeService.getMealToSubmit(angular.copy(entreeService.getMeal())),storeId=restaurant.getId(),getMenu=menu.get().then(function(menu){return menu}),addMeal=api.addMeal(order.orderId,meal,storeId).then(function(response){return response.data});return $q.all([addMeal,getMenu]).then(function(response){var bagData={},sack=response[0],menu=response[1];return api.getBag(sack.OrderId,storeId).then(function(response){return bagData=response.data,angular.copy(mapOrder(menu,bagData),order),session.set("orderId",order.orderId),bag.open(!0),analyticsService.addToBag(order.meals[order.meals.length-1]),order})})}function getIndividualMeals(){if(!order.meals)return[];var individualMeals=order.meals.filter(function(meal){return"Regular"===meal.meal.mealType});return individualMeals}function getIndividualGroupOrderMeals(){if(!order.meals)return[];var individualGroupOrderMeals=order.meals.filter(function(meal){var hasEmail=angular.isDefined(meal.meal.email);return("FinishedGroup"===meal.meal.mealType||"Regular"===meal.meal.mealType)&&!hasEmail});return individualGroupOrderMeals}function getFinishedGroupOrderMeals(){if(!order.meals)return[];var finished=order.meals.filter(function(meal){return"FinishedGroup"===meal.meal.mealType});return finished}function isGroupOrder(){return order&&"Group"===order.orderType}var order={meals:[],orderId:0},timeslot={},orderDetails={paymentType:null,storeId:0};return{getDefaultMealName:getDefaultMealName,addMeal:addMeal,refreshBag:refreshBag,getOrder:getOrder,submitOrder:submitOrder,removeMeal:removeMeal,getTotals:getTotals,getSubTotal:getSubTotal,setPickupTime:setPickupTime,getPickupTime:getPickupTime,orderDetails:orderDetails,getFavorites:getFavorites,getRecents:getRecents,getOrderId:getOrderId,cancelOrder:cancelOrder,getIndividualMeals:getIndividualMeals,getFinishedGroupOrderMeals:getFinishedGroupOrderMeals,getIndividualGroupOrderMeals:getIndividualGroupOrderMeals,isGroupOrder:isGroupOrder}}angular.module("app.order-flow").factory("orderService",orderService),orderService.$inject=["api","$q","entreeService","navigate","session","menu","$filter","mealService","bag","restaurant","customer","analyticsService"]}(),function(){"use strict";function payment(api,customer,$q,paymentType){function tokenizeCreditCard(card){return card.number=card.number.replace(/[^0-9]/g,""),card.type=getCardType(card.number),api.tokenizeCreditCard(card).then(function(response){return 201!==response.data.status?$q.reject():response.data.results.token})}function saveCreditCard(card){return tokenizeCreditCard(card).then(function(token){var cardData={cardHolderName:token.cardholder_name,cardToken:token.value,cardType:token.type,cardExpiration:token.exp_date};return api.saveCreditCard(cardData).then(function(response){return response.data})})}function getCreditCards(){return api.getCreditCards().then(function(response){return response.data.WalletTokens})}function getCreditCard(id){return api.getCreditCard(id).then(function(response){return response.data})}function deleteCreditCard(id){return api.deleteCreditCard(id)}function saveGiftCard(card){return card.number=card.number.replace(/[^0-9]/g,""),customer.get().then(function(customer){var customerName=[customer.FirstName,customer.LastName].join(" "),cardData={cardHolderName:customerName,cardNumber:card.number,recaptchaToken:card.recaptcha};return api.saveGiftCard(cardData).then(function(response){return response.data})})}function getGiftCards(){return api.getGiftCards().then(function(response){return response.data.WalletTokens})}function getGiftCard(id){return api.getGiftCard(id).then(function(response){return response.data})}function deleteGiftCard(id){return api.deleteGiftCard(id)}function getDefaultPayment(creditCards,giftCards,restaurant,orderTotals){if(!(creditCards&&giftCards&&restaurant&&orderTotals))return{card:null,type:null};var paymentOptions=getPaymentOptions(restaurant,orderTotals),acceptsCreditCards=paymentOptions.indexOf(paymentType.CREDIT_CARD)>-1,acceptsGiftCards=paymentOptions.indexOf(paymentType.GIFT_CARD)>-1,acceptsInStoreOnly=!acceptsCreditCards&&!acceptsGiftCards;return acceptsInStoreOnly?{card:null,type:paymentType.IN_STORE}:acceptsCreditCards&&creditCards.length?{card:creditCards[0],type:paymentType.CREDIT_CARD}:acceptsGiftCards&&giftCards.length?{card:giftCards[0],type:paymentType.GIFT_CARD}:{card:null,type:null}}function getPaymentOptions(restaurant,orderTotals){var paymentTypes=[paymentType.IN_STORE];return!restaurant||!orderTotals||orderTotals.Tax<=0?paymentTypes:(restaurant.CreditCardAccepted&&(paymentTypes.push(paymentType.SINGLE_USE_CREDIT_CARD),paymentTypes.push(paymentType.CREDIT_CARD)),restaurant.GiftCardAccepted&&paymentTypes.push(paymentType.GIFT_CARD),paymentTypes)}function getCardType(number){var cardType=null,cardTypes=[{name:"Visa",pattern:/^4[0-9]{12}(?:[0-9]{3})?$/},{name:"Mastercard",pattern:/^5[1-5][0-9]{14}$/},{name:"American Express",pattern:/^3[47][0-9]{13}$/},{name:"Discover",pattern:/^6(?:011|5[0-9]{2})[0-9]{12}$/}];return angular.forEach(cardTypes,function(type){type.pattern.test(number)&&(cardType=type.name)}),cardType}return{tokenizeCreditCard:tokenizeCreditCard,saveCreditCard:saveCreditCard,getCreditCards:getCreditCards,getCreditCard:getCreditCard,deleteCreditCard:deleteCreditCard,saveGiftCard:saveGiftCard,getGiftCards:getGiftCards,getGiftCard:getGiftCard,deleteGiftCard:deleteGiftCard,getDefaultPayment:getDefaultPayment,getPaymentOptions:getPaymentOptions}}angular.module("app.services").factory("payment",payment),payment.$inject=["api","customer","$q","paymentType"]}(),function(){"use strict";function RedirectService($stateParams,config,$window){function isReferred(){return returnUrl=$stateParams.returnUrl,referred=isReturnUrlValid(returnUrl)}function toReturnUrl(){referred&&($window.location.href=returnUrl)}function isReturnUrlValid(url){if(!url)return!1;var hostName=getHostName(url);return!!hostName&&isHostValid(hostName)}function getHostName(url){if(!url.match)return null;var match=url.match(/:\/\/(www[0-9]?\.)?(.[^\/:]+)/i);return null!=match&&match.length>2&&angular.isString(match[2])&&match[2].length>0?match[2]:null}function isHostValid(name){var hosts=config.urlWhiteList;return!!hosts&&hosts.indexOf(name)!==-1}var returnUrl=null,referred=!1;return{isReferred:isReferred,toReturnUrl:toReturnUrl}}angular.module("app.services").factory("redirectService",RedirectService),RedirectService.$inject=["$stateParams","config","$window"]}(),function(){"use strict";function restaurant(api,session,$q,event,localStorageService,navigate,tmhDynamicLocale){function set(id){if(getId()===id)return $q.when(currentRestaurant);localStorageService.set("storeId",id);var orderId=session.get("orderId");return orderId&&orderId>0&&api.changeLocation(orderId,id),api.getRestaurant(id).then(function(response){return currentRestaurant=response.data,setLocale(currentRestaurant.Country),event.emit(event.STORE_CHANGE),currentRestaurant},function(){onGetRestaurantError()})}function getId(){return localStorageService.get("storeId")}function get(){var storeId=getId();return storeId?currentRestaurant&&currentRestaurant.Id===storeId?$q.when(angular.copy(currentRestaurant)):api.getRestaurant(storeId).then(function(response){return currentRestaurant=response.data,setLocale(currentRestaurant.Country),currentRestaurant.OnlineOrderingLive?currentRestaurant:(onGetRestaurantError(),$q.reject())},function(){onGetRestaurantError()}):$q.reject(null)}function getPickupTimes(){var orderId=session.get("orderId");return api.getPickupTimes(getId(),orderId).then(function(response){return response.data.Data},function(){})}function onChange(scope,callback){event.on(event.STORE_CHANGE,callback,scope)}function getEPops(){var storeId=getId();return storeId?lastEPopRestaurantId===storeId?$q.when([]):api.getEPops(storeId).then(function(response){return lastEPopRestaurantId=storeId,response.data}):$q.when([])}function onGetRestaurantError(){localStorageService.remove("storeId"),currentRestaurant=null,navigate.toHome()}function setLocale(country){var lcid="";switch(country.toLowerCase()){case"uk":case"gb":lcid="en-gb";break;case"ca":lcid="en-ca";break;case"fr":lcid="fr-fr";break;case"de":lcid="de-de";break;default:lcid="en-us"}tmhDynamicLocale.set(lcid)}var currentRestaurant=null,lastEPopRestaurantId=null,pickupTimeUnavailable=!1;return{set:set,getId:getId,get:get,getPickupTimes:getPickupTimes,onChange:onChange,getEPops:getEPops,pickupTimeUnavailable:pickupTimeUnavailable}}angular.module("app.services").factory("restaurant",restaurant),restaurant.$inject=["api","session","$q","event","localStorageService","navigate","tmhDynamicLocale"]}(),function(){"use strict";function Session(localStorageService){function get(key){var session=localStorageService.get(sessionKey);return session?session[key]:null}function set(key,value){var session=localStorageService.get(sessionKey);session||(session={}),session[key]=value,localStorageService.set(sessionKey,session)}function remove(key){var session=localStorageService.get(sessionKey);session&&(delete session[key],localStorageService.set(sessionKey,session))}function destroy(){localStorageService.remove(sessionKey)}function setReloadOnExpiration(reload){reloadOnExpiration=reload}function getReloadOnExpiration(){return reloadOnExpiration}var sessionKey="session",reloadOnExpiration=!1;return{get:get,set:set,remove:remove,destroy:destroy,setReloadOnExpiration:setReloadOnExpiration,getReloadOnExpiration:getReloadOnExpiration}}angular.module("app.services").factory("session",Session),Session.$inject=["localStorageService"]}(),function(){"use strict";function StateService(){var state={closed:"closed",open:"open",active:"active"};return{state:state}}angular.module("app.services").factory("stateService",StateService),StateService.$inject=[]}(),function(){"use strict";function survey($q,localStorageService,confirmationModal,config,analyticsService,$window){function rooFeedbackSurvey(optout){function isSurveyTaken(){var surveyFlags=localStorageService.get("surveyTaken");if(surveyFlags)return optout===!0?surveyFlags.optout:surveyFlags.orderConfirmation}function setSurveyTaken(optout){var data=localStorageService.get("surveyTaken")||{};optout===!0?(data.optout=!0,localStorageService.set("surveyTaken",data)):(data.orderConfirmation=!0,localStorageService.set("surveyTaken",data))}function survey(){setSurveyTaken(optout),$window.open(surveyLink),optout===!0&&redirectOptOut()}var surveyLink=optout?"https://chipotle.getfeedback.com/r/qlsTMqiI/":"https://chipotle.getfeedback.com/r/rl6BeKx4/",redirectOptOut=function(){analyticsService.fireCustomEvent("Rollout","OptOut",$window.document.title);var optOutUrl=config.legacyOnlineOrderUrl+"/?optOut=true";$window.location.replace(optOutUrl)};if(isSurveyTaken()!==!0){var params={title:"",headingText:"FIRST COME, FIRST SERVED",bodyText:"How'd it feel to order on our new site? Give us your mild, medium, or hot opinions.",confirmButtonText:"TAKE SURVEY",cancelButtonText:"NO THANKS",onConfirm:survey,onCancel:function(){setSurveyTaken(optout),optout===!0&&redirectOptOut()}};confirmationModal.show(params)}else optout===!0&&redirectOptOut()}var service={rooFeedbackSurvey:rooFeedbackSurvey};return service}angular.module("app.widgets").factory("survey",survey),survey.$inject=["$q","localStorageService","confirmationModal","config","analyticsService","$window"]}(),function(){"use strict";angular.module("app.account").component("cmgAccountEdit",{templateUrl:"templates/account/account-edit.html",controller:"AccountEditController"})}(),function(){"use strict";function AccountEditController(customer,navigate,$state,states,session,errors,confirmationModal){function updateAccount(){vm.error=!1,vm.loading=!0,customer.update(vm.account).then(function(){toggleModal()},function(response){response.data.Type===errors.INVALID_PASSWORD?vm.errorMessage="One of the passwords you provided isn't valid, please try again.":response.data.Type===errors.DUPLICATE_EMAIL?vm.errorMessage=response.data.Message:vm.errorMessage=response.data.Message,vm.error=!0}).finally(function(){vm.loading=!1,vm.account.oldpassword="",vm.account.newpassword=""})}function toggleModal(){var params={title:"Account Updated",headingText:"changes saved",bodyText:"Thanks for keeping it current. Feel free to go back to whatever you were doing.",confirmButtonText:"GOT IT"};confirmationModal.show(params)}function completeAccountUpdate(){navigate.toPreviousState()}function backToOrdering(){navigate.toHome()}var vm=this;vm.account={},vm.edit=!0,vm.loading=!1,vm.showModal=!1,vm.error=!1,vm.errorMessage="",vm.updateAccount=updateAccount,vm.toggleModal=toggleModal,vm.completeAccountUpdate=completeAccountUpdate,vm.backToOrdering=backToOrdering,vm.$onInit=function(){customer.isAuthenticated()||navigate.toRegisterAccount(),customer.get().then(function(response){vm.account.firstName=response.FirstName,vm.account.lastName=response.LastName,vm.account.email=response.Email,vm.account.phone=response.HomePhone,vm.account.newpassword="",vm.account.oldpassword=""})}}angular.module("app.account").controller("AccountEditController",AccountEditController),AccountEditController.$inject=["customer","navigate","$state","states","session","errors","confirmationModal"]}(),function(){"use strict";angular.module("app.account").component("cmgAccountPayment",{templateUrl:"templates/account/account-payment.html",controller:"AccountPaymentController"})}(),function(){"use strict";function AccountPaymentController(customer,payment,$q,navigate,$window){function showRemoveGiftCard(card){vm.giftCardToDelete=card,vm.showPaymentModal=!0,vm.paymentModalState="remove-gift-card",vm.paymentModalTitle="remove card"}function showRemoveCreditCard(card){vm.showPaymentModal=!0,vm.creditCardToDelete=card,vm.paymentModalState="remove-credit-card",vm.paymentModalTitle="remove card"}function closePaymentModal(){vm.saveGiftCardFailed=!1,vm.grecaptcha=$window.grecaptcha||null,vm.grecaptcha&&vm.grecaptcha.reset(vm.recaptchaWidgetId),vm.showPaymentModal=!vm.showPaymentModal}function showAddGiftCard(){vm.showPaymentModal=!0,vm.paymentModalState="add-gift-card",vm.paymentModalTitle="add a gift card"}function showAddCreditCard(){vm.showPaymentModal=!0,vm.paymentModalState="add-credit-card",vm.paymentModalTitle="add a credit or debit card"}function removeCreditCard(){vm.creditCardToDelete&&payment.deleteCreditCard(vm.creditCardToDelete.TokenId).then(function(){payment.getCreditCards().then(function(cards){vm.creditCards=cards})}).finally(function(){closePaymentModal()}),vm.creditCardToDelete=null}function removeGiftCard(){vm.giftCardToDelete&&payment.deleteGiftCard(vm.giftCardToDelete.TokenId).then(function(){vm.selectedCard=null,payment.getGiftCards().then(function(cards){vm.giftCards=cards})}).finally(function(){closePaymentModal()}),vm.giftCardToDelete=null}function saveGiftCard(){vm.saveGiftCardFailed=!1,payment.saveGiftCard(vm.giftCard).then(function(){payment.getGiftCards().then(function(cards){vm.giftCard={},vm.giftCards=cards,closePaymentModal()})},function(){vm.saveGiftCardFailed=!0,vm.grecaptcha=$window.grecaptcha||null,vm.grecaptcha&&vm.grecaptcha.reset(vm.recaptchaWidgetId)})}function saveCreditCard(){vm.saveCreditCardFailed=!1,payment.saveCreditCard(vm.creditCard).then(function(){payment.getCreditCards().then(function(cards){vm.creditCard={},vm.creditCards=cards,closePaymentModal()})},function(){vm.saveCreditCardFailed=!0})}function backToOrdering(){navigate.toHome()}var vm=this;vm.giftCards=[],vm.creditCards=[],vm.giftCard={},vm.creditCard={},vm.loading=!0,vm.paymentModalTitle="",vm.showPaymentModal=!1,vm.paymentModalState="",vm.giftCardToDelete=null,vm.creditCardToDelete=null,vm.saveGiftCardFailed=!1,vm.saveCreditCardFailed=!1,vm.recaptchaWidgetId=0,vm.grecaptcha=null,vm.showRemoveCreditCard=showRemoveCreditCard,vm.showRemoveGiftCard=showRemoveGiftCard,vm.removeCreditCard=removeCreditCard,vm.closePaymentModal=closePaymentModal,vm.showAddGiftCard=showAddGiftCard,vm.showAddCreditCard=showAddCreditCard,vm.removeCreditCard=removeCreditCard,vm.removeGiftCard=removeGiftCard,vm.saveGiftCard=saveGiftCard,vm.saveCreditCard=saveCreditCard,vm.backToOrdering=backToOrdering,vm.$onInit=function(){if(vm.loading=!0,customer.isAuthenticated()){var getCreditCards=payment.getCreditCards(),getGiftCards=payment.getGiftCards();$q.all([getCreditCards,getGiftCards]).then(function(responses){var creditCards=responses[0],giftCards=responses[1];creditCards&&(vm.creditCards=creditCards),giftCards&&(vm.giftCards=giftCards)}).finally(function(){vm.loading=!1})}else vm.loading=!1,navigate.toHome()}}angular.module("app.account").controller("AccountPaymentController",AccountPaymentController),AccountPaymentController.$inject=["customer","payment","$q","navigate","$window"]}(),function(){"use strict";angular.module("app.account").component("cmgAccountRegister",{templateUrl:"templates/account/account-register.html",controller:"AccountRegisterController"})}(),function(){"use strict";function AccountRegisterController(customer,navigate,redirectService,errors,$scope,session,analyticsService){function createAccount(){customer.register(vm.account).then(function(){if(vm.isPartnerReferred)redirectService.toReturnUrl();else{var previousState=session.get("previousState");analyticsService.fireCustomEvent("register","success",previousState?previousState.name:"unknown"),navigate.toPreviousState()}},function(response){response.data.Type===errors.INVALID_PASSWORD&&(vm.errorMessage=response.data.Message),response.data.Type===errors.DUPLICATE_EMAIL?vm.errorMessage=response.data.Message:vm.errorMessage=response.data.Message,vm.error=!0})}var vm=this;vm.account={},vm.error=!1,vm.errorMessage="",vm.isPartnerReferred=redirectService.isReferred(),vm.createAccount=createAccount,vm.$onInit=function(){customer.isAuthenticated()?navigate.toEditAccount():customer.onLoginSuccess($scope,navigate.toEditAccount)}}angular.module("app.account").controller("AccountRegisterController",AccountRegisterController),AccountRegisterController.$inject=["customer","navigate","redirectService","errors","$scope","session","analyticsService"]}(),function(){"use strict";angular.module("app.account").component("cmgFavoriteRecentCard",{templateUrl:"templates/account/favorite-recent-card.html",controller:"FavoriteRecentCardController",transclude:{"card-title":"cardTitle","item-title":"itemTitle","card-content":"cardContent"},bindings:{reOrder:"&"}})}(),function(){"use strict";function FavoriteRecentCardController($timeout){function reOrderClick(){vm.reOrderDisabled=!0,vm.reOrder(),reOrderClickTimeout=$timeout(function(){vm.reOrderDisabled=!1},1e3)}var reOrderClickTimeout=null,vm=this;vm.reOrderDisabled=!1,vm.reOrderClick=reOrderClick,vm.$onDestroy=function(){$timeout.cancel(reOrderClickTimeout)}}angular.module("app.account").controller("FavoriteRecentCardController",FavoriteRecentCardController),FavoriteRecentCardController.$inject=["$timeout"]}(),function(){"use strict";angular.module("app.account").component("cmgFavoritesRecents",{templateUrl:"templates/account/favorites-recents.html",controller:"FavoritesRecentsController"})}(),function(){"use strict";function FavoritesRecentsController(orderService,navigate,favoritesRecentsService,restaurant){function reOrder(order){favoritesRecentsService.reOrder(order)}function isFavoritesActive(){return"favorites"===vm.activeTab}function showFavorites(){vm.activeTab="favorites"}function getFavorites(){orderService.getFavorites().then(function(data){vm.favorites=data})}function getRecents(){orderService.getRecents().then(function(data){vm.recents=data})}function showRecents(){vm.activeTab="recents"}function toHome(){navigate.toHomePastHero()}function expandDetails(item){vm.expandedItem=item,vm.showDetails=!0}function closeDetails(){vm.showDetails=!1}function getSidesAndDrinks(meal){if(!meal)return[];var sidesAndDrinks=[];return sidesAndDrinks=meal.mealSummary.sides.concat(meal.mealSummary.drinks)}function addFavorite(name){var recentIndex=vm.recents.findIndex(function(item){return item.orderId===vm.expandedItem.orderId}),recent=vm.recents[recentIndex],isDuplicate=vm.favorites.findIndex(function(item){return item.orderId===recent.orderId});return isDuplicate===-1&&(recent.orderName=name,vm.favorites=vm.favorites.concat([vm.recents[recentIndex]]),navigate.toFavoritesRecents(),vm.activeTab="favorites",!0)}function removeFavorite(orderId){var orderToDeleteIndex=vm.favorites.findIndex(function(order){return order.orderId===orderId});return vm.favorites.splice(orderToDeleteIndex,1)}function displayNameFavorite(){vm.showNameFavorite=!0}function hideNameFavorite(){vm.showNameFavorite=!1}function hideRecentFavoritesModal(){vm.showDetails=!1}var vm=this;vm.isFavoritesActive=isFavoritesActive,vm.showFavorites=showFavorites,vm.showRecents=showRecents,vm.reOrder=reOrder,vm.toHome=toHome,vm.showDetails=!1,vm.expandDetails=expandDetails,vm.closeDetails=closeDetails,vm.expandedItem,vm.getSidesAndDrinks=getSidesAndDrinks,vm.removeFavorite=removeFavorite,vm.showNameFavorite=!1,vm.displayNameFavorite=displayNameFavorite,vm.hideNameFavorite=hideNameFavorite,vm.hideRecentFavoritesModal=hideRecentFavoritesModal,vm.addFavorite=addFavorite,vm.noPrices=new RegExp(" \\([^A-z\\)]+\\)","g"),vm.activeTab="favorites",vm.favorites=[],vm.recents=[],vm.$onInit=function(){getFavorites(),getRecents(),restaurant.get().then(function(store){store||navigate.toHome()},function(){navigate.toHome()})}}angular.module("app.account").controller("FavoritesRecentsController",FavoritesRecentsController),FavoritesRecentsController.$inject=["orderService","navigate","favoritesRecentsService","restaurant"]}(),function(){"use strict";function favoritesRecentsService(orderService,$q,restaurant,entreeService,bag,session,api,$filter,analyticsService){function addFavorite(orderId,name){return api.addfavoriteorder(orderId,name).then(function(data){return data.data})}function deleteFavorite(orderId){return api.removeFavoriteOrder(orderId)}function getFavorites(count){return orderService.getFavorites().then(function(data){return data.slice(0,count)})}function getRecents(count){return orderService.getRecents().then(function(data){return angular.forEach(data,function(recent){recent.orderName=buildOrderDate(recent)}),data.slice(0,count)})}function buildOrderDate(order){var title="";if(order)return title=$filter("date")(order.orderDate,"M/dd/yy"),title+=" AT ",title+=$filter("date")(order.orderDate,"shortTime")}function getFavoritesRecents(count){return $q.all([getFavorites(count),getRecents(count)]).then(function(data){var result=data[0].concat(data[1]).slice(0,count);return result})}function reOrder(order){var orderId=orderService.getOrderId(),storeId=restaurant.getId(),updateSessionid=!1;orderId||(orderId=0,updateSessionid=!0),order.orderId=orderId;var _meals=order.meals.map(function(item){var mealToSubmit=entreeService.getMealToSubmit(item.meal);return mealToSubmit.mealId=0,mealToSubmit});return analyticsService.fireCustomEvent("order","reorder","fav-recent"),analyticsService.addMultipleMealsToBag(order),api.addMeals(orderId,_meals,storeId).then(function(data){updateSessionid&&session.set("orderId",data.data.OrderId),orderService.refreshBag().then(function(){bag.open(!1)})})}return{getFavoritesRecents:getFavoritesRecents,reOrder:reOrder,buildOrderDate:buildOrderDate,addFavorite:addFavorite,deleteFavorite:deleteFavorite}}angular.module("app.account").factory("favoritesRecentsService",favoritesRecentsService),favoritesRecentsService.$inject=["orderService","$q","restaurant","entreeService","bag","session","api","$filter","analyticsService"]}(),function(){"use strict";angular.module("app.account").component("cmgFavoritesRecentsExpanded",{templateUrl:"templates/account/favorites-recents-expanded.html",controller:"FavoritesRecentsExpandedController",bindings:{item:"<",title:"@",show:"<",hide:"&",addFavorite:"&",removeFavorite:"&",addToBag:"&",itemType:"@",popEditName:"<",hideControlls:"<?"}})}(),function(){"use strict";function FavoritesRecentsExpandedController(api,navigate,favoritesRecentsService,$anchorScroll,$location,mealService,$scope){function buildSummary(){vm.meals=[],angular.forEach(vm.item.meals,function(meal){vm.meals.push(mealService.filterSelected(meal.meal))})}function closeModal(){vm.nameFavorite=!1,vm.hide(),vm.duplicateError=!1}function favoriteRecent(){vm.favoriteName&&vm.addFavorite({name:vm.favoriteName})===!0?(vm.duplicateError=!1,favoritesRecentsService.addFavorite(vm.item.orderId,vm.favoriteName).then(function(){navigate.toFavoritesRecents()}),vm.hide()):vm.duplicateError=!0}function deleteFavorite(){favoritesRecentsService.deleteFavorite(vm.item.orderId),vm.hide(),vm.removeFavorite({orderId:vm.item.orderId})}function getTitle(){return vm.title?vm.title:buildOrderDate()}function buildOrderDate(){return favoritesRecentsService.buildOrderDate(vm.item)}function addFavoriteClick(){vm.favoriteName=getTitle(),vm.nameFavorite=!0,$location.hash("favorites-recents-modal-top"),$anchorScroll(),$location.hash("")}function hasEntree(meal){return!!meal&&mealService.hasEntree(meal)}var vm=this;vm.closeModal=closeModal,vm.favoriteRecent=favoriteRecent,vm.deleteFavorite=deleteFavorite,vm.buildOrderDate=buildOrderDate,vm.getTitle=getTitle,vm.duplicateError=!1,vm.faroriteName=getTitle(),vm.nameFavorite=!1,vm.addFavoriteClick=addFavoriteClick,vm.noPrices=new RegExp(" \\([^A-z\\)]+\\)","g"),vm.hasEntree=hasEntree,vm.meals=[];var watcher;vm.$onInit=function(){buildSummary(),watcher=$scope.$watch(function(){return vm.show},function(){buildSummary()})},vm.$onDestroy=function(){watcher()}}angular.module("app.account").controller("FavoritesRecentsExpandedController",FavoritesRecentsExpandedController),FavoritesRecentsExpandedController.$inject=["api","navigate","favoritesRecentsService","$anchorScroll","$location","mealService","$scope"]}(),function(){"use strict";angular.module("app.checkout-flow").component("card",{templateUrl:"templates/checkout-flow/card.html",transclude:!0})}(),function(){"use strict";angular.module("app.checkout-flow").component("checkout",{templateUrl:"templates/checkout-flow/checkout.html",controller:"CheckoutController",bindings:{onComplete:"&"}})}(),function(){"use strict";function CheckoutController(navigate,customer,$anchorScroll,analyticsService){function register(){analyticsService.checkoutOption(2,"register"),navigate.toRegisterAccount()}function signIn(){vm.customer=customer.login({username:vm.email,password:vm.password,persist:vm.rememberMe}).then(function(){analyticsService.checkoutOption(2,"signIn"),completeIfAuthenticated()},function(){badCredentials()})}function signOut(){vm.showConfirmSignOut=!1,analyticsService.checkoutOption(2,"signOut"),customer.logout()}function toggleConfirmSignOut(){vm.showConfirmSignOut=!vm.showConfirmSignOut}function completeIfAuthenticated(){vm.isAuthenticated=customer.isAuthenticated(),vm.isAuthenticated&&customer.get().then(function(customer){vm.customer=customer,$anchorScroll(),vm.onComplete()})}function badCredentials(){vm.password="",vm.error=!0}var vm=this;vm.register=register,vm.signIn=signIn,vm.signOut=signOut,vm.showConfirmSignOut=!1,vm.toggleConfirmSignOut=toggleConfirmSignOut,vm.customer=null,vm.isAuthenticated=!1,vm.error=!1,vm.$onInit=function(){completeIfAuthenticated()}}angular.module("app.checkout-flow").controller("CheckoutController",CheckoutController),CheckoutController.$inject=["navigate","customer","$anchorScroll","analyticsService"]}(),function(){"use strict";angular.module("app.checkout-flow").component("checkoutLanding",{templateUrl:"templates/checkout-flow/checkout-landing.html",controller:"CheckoutLandingController"})}(),function(){"use strict";function CheckoutLandingController(orderService,$q,navigate,restaurant,$scope,analyticsService,customer){function completeCreateAccount(){analyticsService.checkout(angular.copy(vm.order),2),vm.states.createAccountState="complete",vm.states.restaurantSelectState="active"}function completeRestaurantSelect(){analyticsService.checkout(angular.copy(vm.order),3),vm.states.restaurantSelectState="complete",vm.order.hasUnavailableItems||(vm.states.pickupTimeState="active")}function completePickupTimeStep(){analyticsService.checkout(angular.copy(vm.order),4),vm.states.pickupTimeState="complete",vm.states.paymentState="active"}function completePayment(){analyticsService.checkout(angular.copy(vm.order),5),vm.states.paymentState="complete",vm.states.summaryState="active"}function completeSummary(){}function setPickupTimeStepActive(){vm.states.pickupTimeState="active",vm.states.paymentState="closed",vm.states.summaryState="closed"}function getOrderTotals(){return orderService.getTotals(restaurant.getId()).then(function(totals){vm.orderTotals=totals})}function isAuthenticated(){return customer.isAuthenticated()}var vm=this;vm.restaurant=null,vm.orderTotals=null,vm.order={},vm.states={createAccountState:"active",restaurantSelectState:"closed",pickupTimeState:"closed",paymentState:"closed",summaryState:"closed"},vm.completeCreateAccount=completeCreateAccount,vm.completeRestaurantSelect=completeRestaurantSelect,vm.completePickupTimeStep=completePickupTimeStep,vm.completePayment=completePayment,vm.completeSummary=completeSummary,vm.setPickupTimeStepActive=setPickupTimeStepActive,vm.isAuthenticated=isAuthenticated,vm.$onInit=function(){restaurant.get().then(function(restaurant){vm.restaurant=restaurant}),customer.isAuthenticated()?getOrderTotals():customer.onLoginSuccess($scope,function(){getOrderTotals()}),restaurant.onChange($scope,function(){restaurant.get().then(function(restaurant){vm.restaurant=restaurant}),getOrderTotals(),"complete"===vm.states.pickupTimeState&&setPickupTimeStepActive()}),orderService.getOrder().then(function(data){vm.order=data,data.meals.length<1&&navigate.toHome()},function(){navigate.toHome()})}}angular.module("app.checkout-flow").controller("CheckoutLandingController",CheckoutLandingController),CheckoutLandingController.$inject=["orderService","$q","navigate","restaurant","$scope","analyticsService","customer"]}(),function(){"use strict";angular.module("app.checkout-flow").component("cmgCheckoutPayment",{templateUrl:"templates/checkout-flow/checkout-payment.html",controller:"CheckoutPaymentController",bindings:{state:"<",restaurant:"<",isAuthenticated:"<",orderTotals:"<",onComplete:"&"}})}(),function(){"use strict";function CheckoutPaymentController(customer,api,payment,$window,$q,$scope,paymentType,orderService){
function showChangePaymentMethod(){vm.showPaymentModal=!0,vm.giftCard={},vm.creditCard={};var grecaptcha=$window.grecaptcha||null;grecaptcha&&grecaptcha.reset(vm.recaptchaWidgetId),vm.paymentModalState="payment-methods",vm.paymentModalTitle="choose payment method"}function showAddCreditCard(){vm.paymentModalState="add-credit-card",vm.paymentModalTitle="add a debit or credit card",vm.saveCreditCardFailed=!1}function showAddGiftCard(){vm.paymentModalState="add-gift-card",vm.paymentModalTitle="add a gift card",vm.saveGiftCardFailed=!1}function showRemoveCreditCard(card){vm.creditCardToDelete=card,vm.paymentModalState="remove-credit-card",vm.paymentModalTitle="Remove card"}function showRemoveGiftCard(card){vm.giftCardToDelete=card,vm.paymentModalState="remove-gift-card",vm.paymentModalTitle="Remove card"}function saveCreditCard(fromModal){var card=angular.copy(vm.creditCard),saveCardPromise=card.shouldSave?saveCreditCardToWallet(card):saveSingleUseCreditCard(card);saveCardPromise.then(function(){vm.saveCreditCardFailed=!1,fromModal?closePaymentModal():completePayment()},function(){vm.saveCreditCardFailed=!0})}function selectCard(card,isGiftCard){vm.selectedCard=card,vm.selectedPaymentType=isGiftCard?paymentType.GIFT_CARD:paymentType.CREDIT_CARD,completePayment()}function saveGiftCard(){var card=angular.copy(vm.giftCard);return payment.saveGiftCard(card).then(function(cardId){vm.saveGiftCardFailed=!1,payment.getGiftCards().then(function(cards){vm.giftCards=cards;var newCard=cards.find(function(card){return card.TokenId===cardId});newCard&&(vm.selectedCard=newCard,vm.selectedPaymentType=paymentType.GIFT_CARD),closePaymentModal()})},function(){vm.saveGiftCardFailed=!0})}function removeCreditCard(){if(vm.creditCardToDelete)return payment.deleteCreditCard(vm.creditCardToDelete.TokenId).then(function(){vm.selectedCard=null,vm.selectedPaymentType=null,vm.creditCardToDelete=null,payment.getCreditCards().then(function(cards){vm.creditCards=cards,setSelectedPayment(),showChangePaymentMethod()})})}function removeGiftCard(){if(vm.giftCardToDelete)return payment.deleteGiftCard(vm.giftCardToDelete.TokenId).then(function(){vm.selectedCard=null,vm.selectedPaymentType=null,vm.giftCardToDelete=null,payment.getGiftCards().then(function(cards){vm.giftCards=cards,setSelectedPayment(),showChangePaymentMethod()})})}function selectInStore(){vm.selectedCard=null,vm.selectedPaymentType=paymentType.IN_STORE,completePayment()}function completePayment(){closePaymentModal(),orderService.orderDetails.paymentCard=vm.selectedCard,orderService.orderDetails.paymentType=vm.selectedPaymentType,vm.onComplete()}function showModalBackArrow(){return["add-credit-card","add-gift-card"].indexOf(vm.paymentModalState)>-1}function showSelectedCreditCard(){return[paymentType.CREDIT_CARD,paymentType.SINGLE_USE_CREDIT_CARD].indexOf(vm.selectedPaymentType)>-1}function closePaymentModal(){vm.showPaymentModal=!1}function getAllCards(){return vm.isAuthenticated?$q.all([payment.getCreditCards(),payment.getGiftCards()]).then(function(responses){vm.creditCards=responses[0],vm.giftCards=responses[1]}):$q.when()}function setSelectedPayment(){var paymentOptions=payment.getPaymentOptions(vm.restaurant,vm.orderTotals);vm.creditCardsAccepted=paymentOptions.indexOf(paymentType.CREDIT_CARD)>-1,vm.giftCardsAccepted=paymentOptions.indexOf(paymentType.GIFT_CARD)>-1;var defaultPayment=payment.getDefaultPayment(vm.creditCards,vm.giftCards,vm.restaurant,vm.orderTotals);vm.selectedCard=defaultPayment.card,vm.selectedPaymentType=defaultPayment.type}function saveCreditCardToWallet(newCard){return payment.saveCreditCard(newCard).then(function(cardId){return payment.getCreditCards().then(function(cards){vm.creditCards=cards;var newCard=cards.find(function(card){return card.TokenId===cardId});newCard&&(vm.selectedCard=newCard,vm.selectedPaymentType=paymentType.CREDIT_CARD)})})}function saveSingleUseCreditCard(newCard){return payment.tokenizeCreditCard(newCard).then(function(token){vm.selectedCard={CardExpiration:token.exp_date.slice(0,2)+"/"+token.exp_date.slice(2,4),CardHolderName:token.cardholder_name,CardType:token.type,MaskedTokenizedAccountNumber:token.value.slice(-4),TokenId:token.value},vm.selectedPaymentType=paymentType.SINGLE_USE_CREDIT_CARD})}var vm=this;vm.showPaymentModal=!1,vm.showAddCreditCardModal=!1,vm.showAddGiftCardModal=!1,vm.paymentModalTitle="choose payment method",vm.showPaymentMethods=!0,vm.saveCreditCardFailed=!1,vm.saveGiftCardFailed=!1,vm.paymentModalState="payment-methods",vm.selectedCard=null,vm.selectedPaymentType=null,vm.creditCard={},vm.creditCards=[],vm.giftCard={},vm.restaurant=null,vm.giftCards=[],vm.recaptchaWidgetId=0,vm.creditCardToDelete=null,vm.giftCardToDelete=null,vm.paymentType=paymentType,vm.creditCardsAccepted=!0,vm.giftCardsAccepted=!0,vm.showChangePaymentMethod=showChangePaymentMethod,vm.showAddCreditCard=showAddCreditCard,vm.showAddGiftCard=showAddGiftCard,vm.showRemoveCreditCard=showRemoveCreditCard,vm.saveCreditCard=saveCreditCard,vm.removeCreditCard=removeCreditCard,vm.showRemoveGiftCard=showRemoveGiftCard,vm.saveGiftCard=saveGiftCard,vm.removeGiftCard=removeGiftCard,vm.selectCard=selectCard,vm.showModalBackArrow=showModalBackArrow,vm.closePaymentModal=closePaymentModal,vm.selectInStore=selectInStore,vm.showSelectedCreditCard=showSelectedCreditCard,vm.completePayment=completePayment,vm.$onInit=function(){$scope.$watch(function(){return vm.selectedCard},function(){orderService.orderDetails.paymentCard=vm.selectedCard}),$scope.$watch(function(){return vm.selectedPaymentType},function(){orderService.orderDetails.paymentType=vm.selectedPaymentType})},vm.$onChanges=function(changes){changes.orderTotals&&(vm.orderTotals=angular.copy(changes.orderTotals.currentValue),setSelectedPayment()),changes.restaurant&&(vm.restaurant=angular.copy(changes.restaurant.currentValue),setSelectedPayment()),changes.isAuthenticated&&(vm.isAuthenticated=angular.copy(changes.isAuthenticated.currentValue),getAllCards().then(function(){setSelectedPayment()}))}}angular.module("app.checkout-flow").controller("CheckoutPaymentController",CheckoutPaymentController),CheckoutPaymentController.$inject=["customer","api","payment","$window","$q","$scope","paymentType","orderService"]}(),function(){"use strict";angular.module("app.checkout-flow").component("cmgCheckoutRestaurant",{templateUrl:"templates/checkout-flow/checkout-restaurant.html",controller:"CheckoutRestaurantController",bindings:{state:"=",onComplete:"&"}})}(),function(){"use strict";function CheckoutRestaurantController(){function toggleModal(){vm.showChangeRestaurant=!vm.showChangeRestaurant}var vm=this;vm.showChangeRestaurant=!1,vm.toggleModal=toggleModal}angular.module("app.checkout-flow").controller("CheckoutRestaurantController",CheckoutRestaurantController),CheckoutRestaurantController.$inject=[]}(),function(){"use strict";angular.module("app.checkout-flow").component("cmgCheckoutSummary",{templateUrl:"templates/checkout-flow/checkout-summary.html",controller:"CheckoutSummaryController",bindings:{state:"=",onComplete:"&",forConfirmation:"<"}})}(),function(){"use strict";function CheckoutSummaryController(orderService,api,mealService,analyticsService,restaurant,$q,$scope,customer,navigate,session,paymentType){function mealsCount(){if(vm.order)return vm.order.meals.length}function hasEntree(meal){return!!meal&&mealService.hasEntree(meal)}function mealContent(meal){return mealService.buildEntreeContents(meal,meal.fillings)}function updateTotals(){if(customer.isAuthenticated()){vm.calculatedSubTotal=0,vm.order.meals.forEach(function(meal){vm.calculatedSubTotal+=meal.mealSummary.subtotal});var getRestaurantPromise=restaurant.get(),getTotalsPromise=orderService.getTotals(restaurant.getId(),orderService.getOrderId());$q.all([getRestaurantPromise,getTotalsPromise]).then(function(responses){var restaurant=responses[0],totals=responses[1];totals.Total>0?["UK"].indexOf(restaurant.Country)!==-1?(vm.showTax=!1,vm.subTotal=totals.Subtotal,vm.tax=totals.Tax,vm.total=totals.Total):(vm.showTax=!0,vm.subTotal=vm.calculatedSubTotal,vm.tax=totals.Tax,vm.total=1*(vm.subTotal+vm.tax).toFixed(2)):(vm.showTax=["UK"].indexOf(restaurant.Country)===-1,vm.subTotal=0)},function(){vm.showTax=["UK"].indexOf(restaurant.Country)===-1,vm.subTotal=0})}}function submitOrder(){if(orderService.orderDetails.paymentType===paymentType.GIFT_CARD&&(!orderService.orderDetails.paymentCard||!orderService.orderDetails.paymentCard.AvailableBalance||orderService.orderDetails.paymentCard.AvailableBalance<vm.total))return vm.submitError=!0,void(vm.submitErrorMessage="Oops. We were unable to place your order because your gift card has insufficient funds.Please select another payment method and try again.");analyticsService.checkout(angular.copy(vm.order),6);var orderCopy=angular.copy(vm.order);vm.loading=!0,orderService.submitOrder().then(function(){vm.loading=!1,analyticsService.purchase(orderCopy,vm.total,vm.tax),addFloodLightPixel(vm.order.orderId,vm.subTotal),navigate.toOrderConfirmation()},function(error){"UnavailablePickupTime"===error.data.Type?restaurant.pickupTimeUnavailable=!0:(vm.submitErrorMessage="We ran into an error submitting your order, please try again.",vm.submitError=!0),vm.loading=!1})}function updateOrder(){vm.meals=[],orderService.refreshBag().then(function(order){vm.order=order,vm.order.meals=removeInProgressGroupMeals(order.meals),angular.forEach(vm.order.meals,function(meal){vm.meals.push(mealService.filterSelected(meal.meal))}),updateTotals()})}function addFloodLightPixel(orderId,subTotal){vm.flooded||(vm.flooded=!0,vm.ele=document.createElement("iframe"),vm.ele.src="https://4451427.fls.doubleclick.net/activityi;src=4451427;type=chip00;cat=order0;qty=1;cost="+subTotal+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+orderId+"?",vm.ele.width=1,vm.ele.height=1,vm.ele.frameborder=0,vm.ele.className="hidden",document.body.appendChild(vm.ele))}function showInstructions(){return!mealService.hasCustomizations()}function removeInProgressGroupMeals(meals){return meals=meals.filter(function(meal){return"UnfinishedGroup"!==meal.meal.mealType}),meals=meals.filter(function(meal){return"DeclinedGroup"!==meal.meal.mealType})}var vm=this;vm.order=null,vm.tax=0,vm.subTotal=0,vm.calculatedSubTotal=0,vm.loading=!1,vm.submitError=!1,vm.submitErrorMessage="",vm.flooded=!1,vm.ele=null,vm.showTax=!0,vm.mealsCount=mealsCount,vm.mealContent=mealContent,vm.submitOrder=submitOrder,vm.showInstructions=showInstructions,vm.hasEntree=hasEntree,vm.meals=[],vm.$onInit=function(){if(vm.forConfirmation){var previousOrder=session.get("previousOrder");if(!previousOrder)return void navigate.toHome();vm.order=previousOrder.order,vm.order.meals=removeInProgressGroupMeals(vm.order.meals),angular.forEach(vm.order.meals,function(meal){vm.meals.push(mealService.filterSelected(meal.meal))}),vm.subTotal=previousOrder.orderDetails.subtotal,vm.tax=previousOrder.orderDetails.tax,vm.total=previousOrder.orderDetails.total}else updateOrder();restaurant.onChange($scope,updateOrder),customer.onLoginSuccess($scope,updateTotals)},vm.$onDestroy=function(){null!==vm.ele&&(document.body.removeChild(vm.ele),vm.ele=null)}}angular.module("app.checkout-flow").controller("CheckoutSummaryController",CheckoutSummaryController),CheckoutSummaryController.$inject=["orderService","api","mealService","analyticsService","restaurant","$q","$scope","customer","navigate","session","paymentType"]}(),function(){"use strict";angular.module("app.checkout-flow").component("cmgOrderConfirmation",{templateUrl:"templates/checkout-flow/order-confirmation.html",controller:"OrderConfirmationController",bindings:{}})}(),function(){"use strict";function OrderConfirmationController(restaurant,orderService,navigate,session){function addToFavorites(){return!0}function toggleFavoritesModal(){vm.showFavoritesModal=!0}function hideFavoritesModal(){vm.showFavoritesModal=!1}function isGroupOrder(){return orderService.isGroupOrder()}var vm=this;vm.showMap=!1,vm.timeslot=null,vm.order={},vm.showFavoritesModal=!1,vm.test=!0,vm.isGroupOrder=isGroupOrder,vm.hideFavoritesModal=hideFavoritesModal,vm.addToFavorites=addToFavorites,vm.toggleFavoritesModal=toggleFavoritesModal,vm.$onInit=function(){restaurant.get().then(function(location){vm.location=location,vm.showMap=!0});var previousOrder=session.get("previousOrder");return previousOrder?(vm.timeslot=previousOrder.timeslot,void(vm.order=previousOrder.order)):void navigate.toHome()}}angular.module("app.checkout-flow").controller("OrderConfirmationController",OrderConfirmationController),OrderConfirmationController.$inject=["restaurant","orderService","navigate","session"]}(),function(){"use strict";angular.module("app.checkout-flow").component("cmgPickupTime",{templateUrl:"templates/checkout-flow/pickup-time.html",controller:"PickupTimeController",bindings:{state:"<",onComplete:"&",setActive:"&"}})}(),function(){"use strict";function PickupTimeController(api,restaurant,orderService,$scope,$document){function setPickupTime(){orderService.setPickupTime(vm.selectedTime)}function onContinue(){vm.showUnavailableMessage=!1,orderService.setPickupTime(vm.selectedTime),vm.onComplete()}function isClosed(){return"closed"===vm.state.pickupTimeState}function isComplete(){return"complete"===vm.state.pickupTimeState}function getPickupTimes(){restaurant.getPickupTimes().then(function(pickupTimes){pickupTimes&&pickupTimes.length>0?(vm.pickupTimes=pickupTimes,vm.selectedTime=vm.pickupTimes[0]):trackJs.track("Empty pickup times for store "+restaurant.getId())},function(){})}var vm=this,ele=null;vm.selectedTime=null,vm.showUnavailableMessage=!1,vm.setPickupTime=setPickupTime,vm.onContinue=onContinue,vm.isClosed=isClosed,vm.isComplete=isComplete,vm.$onInit=function(){getPickupTimes(),restaurant.onChange($scope,getPickupTimes),ele=angular.element(document.getElementById("pickup-time-anchor"))},vm.$onDestroy=function(){watcher(),ele=null};var watcher=$scope.$watch(function(){return restaurant.pickupTimeUnavailable},function(){restaurant.pickupTimeUnavailable&&(restaurant.pickupTimeUnavailable=!1,getPickupTimes(),vm.showUnavailableMessage=!0,$document.scrollTo(ele,150,500),vm.setActive())})}angular.module("app.checkout-flow").controller("PickupTimeController",PickupTimeController),PickupTimeController.$inject=["api","restaurant","orderService","$scope","$document"]}(),function(){"use strict";angular.module("app.checkout-flow").component("cmgUnavailableItems",{templateUrl:"templates/checkout-flow/unavailable-items.html",controller:"UnavailableItemsController"})}(),function(){"use strict";function UnavailableItemsController(orderService,mealService,restaurant,$scope,navigate){function mealsCount(){return vm.order&&vm.order.meals?vm.order.meals.length:0}function mealContent(meal){return mealService.buildEntreeContents(meal,meal.fillings)}function onMealRemoved(){orderService.getOrder().then(function(order){vm.order=order,mealsCount()<1&&navigate.toHome()})}var vm=this;vm.onMealRemoved=onMealRemoved,vm.order=null,vm.mealsCount=mealsCount,vm.mealContent=mealContent,vm.$onInit=function(){orderService.getOrder().then(function(order){vm.order=order}),restaurant.onChange($scope,function(){orderService.refreshBag(),orderService.getOrder().then(function(order){vm.order=order})})}}angular.module("app.checkout-flow").controller("UnavailableItemsController",UnavailableItemsController),UnavailableItemsController.$inject=["orderService","mealService","restaurant","$scope","navigate"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgGroupOrder",{controller:"GroupOrderController",templateUrl:"templates/group-order/group-order.html"})}(),function(){"use strict";function GroupOrderController($stateParams,restaurant,groupOrderService,$state,analyticsService,entreeService,error,$window,$scope,navigate,confirmationModal){function decline(){analyticsService.fireCustomEvent("decline","button-click","Chipotle - Group Order"),groupOrderService.declineGroupInvitation()}function showDeclineModal(){var params={title:"DECLINE INVITATION",headingText:"ARE YOU SURE?",bodyText:"Just double-checking before we let the organizer know.",confirmButtonText:"YES, DECLINE",cancelButtonText:"NO, GO BACK",onConfirm:decline,preventClose:!0};confirmationModal.show(params)}function updateLoading(){vm.loading===(vm.invitiLoaded&&vm.documentLoaded)&&(vm.loading=!(vm.invitiLoaded&&vm.documentLoaded),$scope.$evalAsync())}var vm=this;vm.inviteeEmail="",vm.inviterEmail="",vm.inviterName="",vm.invalidToken=!1,vm.invitiLoaded=!1,vm.documentLoaded=!1,vm.loading=!0,vm.showDeclineModal=showDeclineModal,vm.decline=decline,vm.showErrorModal=error.showErrorModal,vm.hideErrorModal=error.hideErrorModal,vm.getErrorTitle=error.getErrorTitle,vm.getErrorMessage=error.getErrorMessage,vm.$onInit=function(){$stateParams.decline&&$stateParams.decline===!0&&(showDeclineModal(),analyticsService.fireCustomEvent("decline","email-decline","Chipotle - Group Order")),$stateParams.storeid&&restaurant.set($stateParams.storeid);var inviteeId=$stateParams.inviteeid;inviteeId&&groupOrderService.setInviteeId(inviteeId),groupOrderService.getInviteeInfo(inviteeId).then(function(data){vm.inviteeEmail=data.InviteeEmail,vm.inviterEmail=data.InviterEmail,vm.inviterName=data.InviterName,vm.invitiLoaded=!0,updateLoading()},function(){navigate.toGroupOrderInactive()}),angular.element(document).ready(function(){vm.documentLoaded=!0,updateLoading()})}}angular.module("app.order-flow").controller("GroupOrderController",GroupOrderController),GroupOrderController.$inject=["$stateParams","restaurant","groupOrderService","$state","analyticsService","entreeService","error","$window","$scope","navigate","confirmationModal"]}(),function(){"use strict";function GroupOrderService(api,$window,$filter,navigate,$q,localStorageService,entreeService,session){function getInviteeInfo(id){var inviteeId="";return inviteeId=id?id:getInviteeId(),inviteeId?api.getInviteeInfo(inviteeId).then(function(response){return response.data},function(){return clearGroupOrderInfo(),navigate.toGroupOrderInactive(),$q.reject()}):(navigate.toGroupOrderInactive(),$q.reject())}function getInviteeId(){return localStorageService.get("inviteeId","sessionStorage")}function setInviteeId(id){localStorageService.set("inviteeId",id,"sessionStorage")}function submitMealToHost(){var meal=entreeService.getMealToSubmit(entreeService.getMeal());return api.addInviteeMeal(getInviteeId(),meal).then(function(response){return clearGroupOrderInfo(),navigate.toInviteeMealSubmitted(),response.data})}function getDefaultMealName(){return getInviteeInfo().then(function(response){var email=response.InviteeEmail;return email.split("@")[0]})}function declineGroupInvitation(){api.declineGroupInvitation(getInviteeId()),navigate.toGroupOrderDeclined()}function sendInvites(storeId,friends,orderId){return api.sendGroupOrderInvites(storeId,friends,orderId).then(function(response){return session.set("orderId",response.data.OrderId),response.data})}function clearGroupOrderInfo(){localStorageService.remove("inviteeId")}return{getInviteeId:getInviteeId,setInviteeId:setInviteeId,getInviteeInfo:getInviteeInfo,getDefaultMealName:getDefaultMealName,submitMealToHost:submitMealToHost,declineGroupInvitation:declineGroupInvitation,sendInvites:sendInvites}}angular.module("app.order-flow").factory("groupOrderService",GroupOrderService),GroupOrderService.$inject=["api","$window","$filter","navigate","$q","localStorageService","entreeService","session"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgGroupOrderCreate",{controller:"GroupOrderCreateController",templateUrl:"templates/group-order/group-order-create.html"})}(),function(){"use strict";function GroupOrderCreateController(customer,$filter,groupOrderService,orderService,restaurant,navigate,$scope,$q,existingOrder){function completeCreateAccount(){vm.states.restaurantSelectState="active"}function completeRestaurantSelect(){vm.states.restaurantSelectState="complete",vm.guestListActive=!0}function createNewFriendsList(){if(vm.newFriendError=!1,!vm.newFriendsString)return void(newFriendList=[]);var friendArray=vm.newFriendsString.replace(/\s+/g,"").split(/[,;]/);if(angular.forEach(friendArray,function(friend){if(friend.match){var match=friend.match(emailRegex);match||(vm.newFriendError=!0)}}),!vm.newFriendError){var i=friendArray.indexOf(vm.hostEmail);i>-1&&(friendArray.splice(i,1),vm.selfFriending=!0),newFriendList=friendArray}}function guestListValid(){return!vm.newFriendError&&(newFriendList.length>0||getSelectedFriends().length>0)}function sendInvitations(){newFriendList.length>0?addFriends().then(function(addedFriends){selectAll(addedFriends),createGroupOrder()}):createGroupOrder()}function toggleSelectFriends(){getSelectedFriends().length<vm.friends.length?(vm.toggleText="select none",selectAll(vm.friends)):(vm.toggleText="select all",selectNone())}function selectFriend(friend){friend.selected=!friend.selected,getSelectedFriends().length<vm.friends.length?vm.toggleText="select all":vm.toggleText="select none"}function toggleEditAddressBook(){vm.newFriendsString="",vm.newFriendError=!1,vm.showEditAddress=!vm.showEditAddress,angular.forEach(vm.friends,function(friend){friend.markedToDelete=!1})}function saveAddressBookChanges(){var addFriendsPromise,deleteFriendsPromise,friendsToDelete=[],selectedFriends=getSelectedFriends();newFriendList.length>0&&(addFriendsPromise=addFriends()),angular.forEach(vm.friends,function(friend){friend.markedToDelete&&friendsToDelete.push(friend.Id)}),friendsToDelete.length>0&&(deleteFriendsPromise=customer.removeFriends(friendsToDelete)),$q.all([addFriendsPromise,deleteFriendsPromise]).then(function(){getFriends().then(function(){angular.forEach(selectedFriends,function(selectedFriend){var friendToSelect=vm.friends.find(function(friend){return friend.Email===selectedFriend.Email});friendToSelect&&(friendToSelect.selected=!0)})}),toggleEditAddressBook()})}function addFriendsWithSelect(){createNewFriendsList(),newFriendList.length>0&&addFriends().then(function(addedFriends){var friendEmails=vm.friends.map(function(f){return f.Email});angular.forEach(addedFriends,function(friend){friendEmails.indexOf(friend.Email)>-1?vm.friends.find(function(vmFriend){return vmFriend.Email===friend.Email}).selected=!0:(friend.selected=!0,vm.friends.push(friend))}),vm.newFriendsString=""})}function createGroupOrder(){var orderId=orderService.getOrderId();groupOrderService.sendInvites(restaurant.getId(),getSelectedFriends(),orderId).then(function(){orderId?orderService.refreshBag().then(function(){navigate.toHome()}):navigate.toHome()})}function getSelectedFriends(){var selectedFriends=$filter("filter")(vm.friends,{selected:!0});return selectedFriends}function selectAll(array){angular.forEach(array,function(item){item.selected=!0})}function selectNone(){angular.forEach(vm.friends,function(item){item.selected=!1})}function getFriends(){return customer.getFriends().then(function(friends){vm.friends=friends,selectNone(),0===vm.friends.length&&(vm.showAddFriends=!0);var i=vm.friends.indexOf(vm.hostEmail);return i>-1&&vm.friends.splice(i,1),vm.loading=!1,vm.friends})}function addFriends(){return customer.addFriends(newFriendList).then(function(response){newFriendList="";var addedFriends=response.data;return addedFriends})}function getMeAndFriends(){customer.get().then(function(customer){vm.hostEmail=customer.Email.toLowerCase()},function(){}).finally(function(){getFriends()})}var vm=this,emailRegex=customer.emailRegex,newFriendList=[];vm.loading=!0,vm.states={restaurantSelectState:"closed"},vm.isAuthenticated=customer.isAuthenticated,vm.guestListActive=!1,vm.newFriendsString="",vm.hostEmail="",vm.newFriendError=!1,vm.friends=[],vm.showAddFriends=!1,vm.toggleText="select all",vm.showEditAddress=!1,vm.selfFriending=!1,vm.completeCreateAccount=completeCreateAccount,vm.completeRestaurantSelect=completeRestaurantSelect,vm.createNewFriendsList=createNewFriendsList,vm.guestListValid=guestListValid,vm.sendInvitations=sendInvitations,vm.toggleSelectFriends=toggleSelectFriends,vm.selectFriend=selectFriend,vm.toggleEditAddressBook=toggleEditAddressBook,vm.saveAddressBookChanges=saveAddressBookChanges,vm.addFriends=addFriendsWithSelect,vm.$onInit=function(){customer.isAuthenticated()&&getMeAndFriends(),customer.onLoginSuccess($scope,getMeAndFriends),customer.onLoginSuccess($scope,existingOrder.checkExistingOrder)}}angular.module("app.order-flow").controller("GroupOrderCreateController",GroupOrderCreateController),GroupOrderCreateController.$inject=["customer","$filter","groupOrderService","orderService","restaurant","navigate","$scope","$q","existingOrder"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgGroupOrderFlow",{controller:"GroupOrderFlowController",templateUrl:"templates/group-order/group-order-flow.html"})}(),function(){"use strict";function GroupOrderFlowController(groupOrderService){function getDefaultMealName(){return groupOrderService.getDefaultMealName()}function submitMealToHost(){return groupOrderService.submitMealToHost()}var vm=this;vm.getDefaultMealName=getDefaultMealName,vm.submitMealToHost=submitMealToHost}angular.module("app.order-flow").controller("GroupOrderFlowController",GroupOrderFlowController),GroupOrderFlowController.$inject=["groupOrderService"]}(),function(){"use strict";angular.module("app.order-flow").component("customizationItem",{templateUrl:"templates/meal-customizations/customization-item.html",controller:"customizationItemController",bindings:{title:"<",onClick:"&",onReset:"&",disabled:"<",diehard:"<",open:"<"},transclude:!0})}(),function(){"use strict";function customizationItemController(){function click(){vm.onClick()}function reset(){vm.onReset()}var vm=this;vm.collapsed=!0,vm.click=click,vm.reset=reset}angular.module("app.order-flow").controller("customizationItemController",customizationItemController)}(),function(){"use strict";angular.module("app.order-flow").component("customizations",{templateUrl:"templates/meal-customizations/customizations.html",controller:"CustomizationsController",bindings:{show:"<"}})}(),function(){"use strict";function CustomizationsController($scope,customizationsModal,customizations,entreeService,$anchorScroll,$location){function openItemsWithMc(items){items&&angular.forEach(items,function(item){item.customization&&(item.open=!0)})}function closeNotCustomizedItems(items){items&&angular.forEach(items,function(item){angular.isUndefined(item.customization)&&(item.open=!1)})}function scrollToLastSelected(items){var lastSelected=entreeService.lastSelected();if(items&&lastSelected){var item=items.find(function(item){return item.Name===lastSelected.Name});item&&(item.open=!0,$location.hash(item.Name.replace(/ /g,"-").toLowerCase()),$anchorScroll())}return items}function clickItem(item){return item.open=!item.open,item.open}function selectItem(item,type,selected){selected?item.customization=type:delete item.customization}function resetItem(item){customizations.reset(item)}function closeModal(){customizationsModal.hide()}function itemsAvailable(){if(vm.items)return vm.items.length>0}function getItemTitle(item){var title=item.Name;return item.customization&&(title+=" ("+item.customization+")"),title}function availableCustomizations(){return customizations.availableCustomizations(entreeService.getMeal())}function isDisabled(item){var disabled=customizations.isDisabled(item);return disabled&&(item.open=!1),disabled}function createId(item){var id=item.Name.replace(/ /g,"-");return id=id.toLowerCase()}var vm=this;vm.clickItem=clickItem,vm.resetItem=resetItem,vm.selectItem=selectItem,vm.closeModal=closeModal,vm.itemsAvailable=itemsAvailable,vm.getItemTitle=getItemTitle,vm.availableCustomizations=availableCustomizations,vm.maxCustomizations,vm.isDisabled=isDisabled,vm.createId=createId;var watcher,itemsStateWatch;vm.$onInit=function(){watcher=$scope.$watch(function(){return vm.show},function(){vm.items=customizations.get(entreeService.getMeal()),vm.maxCustomizations=customizations.maxCustomizations(entreeService.getMeal()),openItemsWithMc(vm.items),closeNotCustomizedItems(vm.items),scrollToLastSelected(vm.items)}),itemsStateWatch=$scope.$watch(function(){return customizations.availableCustomizations(entreeService.getMeal())},function(newVal){0===newVal&&customizations.disableNotCustomizedItems(entreeService.getMeal()),newVal>0&&customizations.enableItems(entreeService.getMeal())})},vm.$onDestroy=function(){watcher(),itemsStateWatch()}}angular.module("app.order-flow").controller("CustomizationsController",CustomizationsController),CustomizationsController.$inject=["$scope","customizationsModal","customizations","entreeService","$anchorScroll","$location"]}(),function(){"use strict";function customizations(){function getSelectedItems(meal){try{var _selectedItems=getSelected(meal);return _selectedItems}catch(e){return[]}}function maxCustomizations(meal){return meal&&meal.MaxCustomizations&&(_maxCustomizations=meal.MaxCustomizations),_maxCustomizations}function availableCustomizations(meal){var _selectedItems=getSelected(meal);if(_selectedItems){var customizedItems=_selectedItems.filter(function(item){return angular.isDefined(item.customization)&&"GuacTopping"!==item.Type}),availableCustomizations=maxCustomizations(meal)-customizedItems.length;return availableCustomizations<0&&(availableCustomizations=0),availableCustomizations}}function isDisabled(item){return item.customizationDisabled===!0}function reset(item){delete item.customization}function maxCustomizationsReached(meal){return 0===availableCustomizations(meal)}function getRiceBeansToppings(meal){if(meal&&meal.Beans&&meal.Toppings&&meal.Rice){var items=meal.Rice;return items=items.concat(meal.Beans),items=items.concat(meal.Toppings)}}function disableNotCustomizedItems(meal){angular.forEach(meal.Rice,function(item){item.customization||(item.customizationDisabled=!0)}),angular.forEach(meal.Beans,function(item){item.customization||(item.customizationDisabled=!0)}),angular.forEach(meal.Toppings,function(item){item.customization||(item.customizationDisabled=!0)}),guacCustomizationAlwaysEnabled(meal.Toppings)}function enableItems(meal){angular.forEach(meal.Rice,function(item){item.customization||(item.customizationDisabled=!1)}),angular.forEach(meal.Beans,function(item){item.customization||(item.customizationDisabled=!1)}),angular.forEach(meal.Toppings,function(item){item.customization||(item.customizationDisabled=!1)})}function getSelected(meal){if(meal){var items=getRiceBeansToppings(meal);if(items){var _selectedItems=items.filter(function(item){return item.selected===!0});return _selectedItems=riceBeansMcRule(_selectedItems),_selectedItems=hideNoRiceNoBeans(_selectedItems),_selectedItems=removeItemsWithoutMc(_selectedItems),_selectedItems=removeGuacFromOneTwoTacos(_selectedItems,meal)}}}function riceBeansMcRule(items){var twoRice={Customizations:null,Name:"White and Brown Rice",selected:!0,diehard:!0,description:"Selecting both types of rice or beans counts as 1 of your 3 customizations.",customization:"BOTH",customizationDisabled:!1},twoBeans=angular.copy(twoRice);twoBeans.Name="Black and Pinto Beans";var rice=items.filter(function(item){return"RiceBrown"===item.Type||"RiceWhite"===item.Type}),beans=items.filter(function(item){return"BeansBlack"===item.Type||"BeansPinto"===item.Type});return rice&&2===rice.length&&(items=_.without(items,rice[0],rice[1]),items.unshift(twoRice)),beans&&2===beans.length&&(items=_.without(items,beans[0],beans[1]),items.unshift(twoBeans)),items}function hideNoRiceNoBeans(items){var noRice=items.find(function(rice){return"NoRice"===rice.Type}),noBeans=items.find(function(bean){return"NoBeans"===bean.Type});return items=_.without(items,noRice,noBeans)}function guacCustomizationAlwaysEnabled(items){if(items){var guac=items.find(function(item){return"GuacTopping"===item.Type});guac&&(guac.customizationDisabled=!1)}return items}function removeItemsWithoutMc(items){return items&&(items=items.filter(function(item){
return angular.isDefined(item.Customizations)})),items}function removeGuacFromOneTwoTacos(items,meal){if(items&&"Tacos"===meal.Type){var qty=meal.Quantities.find(function(item){return item.selected===!0});if(qty&&qty.Name)switch(qty.Name){case"2 Tacos":items=items.filter(function(item){return"GuacTopping"!==item.Type});break;case"1 Taco":items=items.filter(function(item){return"GuacTopping"!==item.Type})}}return items}var _maxCustomizations=0,service={get:getSelectedItems,maxCustomizations:maxCustomizations,availableCustomizations:availableCustomizations,isDisabled:isDisabled,reset:reset,disableNotCustomizedItems:disableNotCustomizedItems,enableItems:enableItems,maxCustomizationsReached:maxCustomizationsReached};return service}angular.module("app.order-flow").factory("customizations",customizations),customizations.$inject=[]}(),function(){"use strict";angular.module("app.order-flow").component("cmgOrderEntree",{controller:"OrderEntreeController",templateUrl:"templates/order/order-entree.html"})}(),function(){"use strict";function OrderEntreeController(restaurant,$scope,session,$window,$timeout,favoritesRecentsService,customer,navigate,$stateParams,$location,$anchorScroll,orderService,bag,existingOrder,confirmationModal,accountDrawer){function isStoreSelected(){return restaurant.getId()>0}function isGroupOrder(){return"Group"===vm.order.orderType}function getStore(){restaurant.get().then(function(store){vm.store=store},function(){vm.store=null,vm.favoritesAndRecents=[]})}function toggleModal(){vm.show=!vm.show}function find(){vm.show=!0,vm.search()}function reOrder(order){favoritesRecentsService.reOrder(order)}function navigateToYourOrder(){navigate.toFavoritesRecents()}function hideFind(){var hide=vm.isStoreSelected()||vm.show;return hide}function getFavoritesRecents(){return favoritesRecentsService.getFavoritesRecents(2).then(function(data){vm.favoritesAndRecents=data})}var expiredSessionTimer=null,vm=this;vm.address="",vm.store=null,vm.isStoreSelected=isStoreSelected,vm.toggleModal=toggleModal,vm.find=find,vm.reOrder=reOrder,vm.isGroupOrder=isGroupOrder,vm.hideFind=hideFind,vm.navigateToYourOrder=navigateToYourOrder,vm.order={},vm.search={},vm.favoritesAndRecents=[],vm.$onInit=function(){if(orderService.getOrder().then(function(order){vm.order=order}),getStore(),restaurant.onChange($scope,getStore),getFavoritesRecents(),restaurant.onChange($scope,getFavoritesRecents),customer.onLoginSuccess($scope,getFavoritesRecents),customer.onLoginSuccess($scope,existingOrder.checkExistingOrder),session.get("ExpiredSession")){var modalOptions={title:"You’ve been signed out",headingText:"Doh! You’ve been signed out of your account due to inactivity.",bodyText:"Maybe you got distracted or fell asleep. If you’d like to continue with your order, please sign back in.",confirmButtonText:"SIGN IN",cancelButtonText:"CANCEL",onConfirm:function(){session.remove("ExpiredSession"),accountDrawer.open()},onCancel:function(){session.remove("ExpiredSession")}};confirmationModal.show(modalOptions)}},vm.$onDestroy=function(){$timeout.cancel(expiredSessionTimer)}}angular.module("app.order-flow").controller("OrderEntreeController",OrderEntreeController),OrderEntreeController.$inject=["restaurant","$scope","session","$window","$timeout","favoritesRecentsService","customer","navigate","$stateParams","$location","$anchorScroll","orderService","bag","existingOrder","confirmationModal","accountDrawer"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgOrderFlow",{controller:"OrderFlowController",templateUrl:"templates/order/order-flow.html"})}(),function(){"use strict";function OrderFlowController(orderService,$stateParams){function getDefaultMealName(){return orderService.getDefaultMealName()}function addMeal(entree){return orderService.addMeal(entree)}function getMealCompleteText(){return $stateParams.mealId?"save meal":"add meal to bag"}var vm=this;vm.getDefaultMealName=getDefaultMealName,vm.addMeal=addMeal,vm.getMealCompleteText=getMealCompleteText}angular.module("app.order-flow").controller("OrderFlowController",OrderFlowController),OrderFlowController.$inject=["orderService","$stateParams"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgBag",{controller:"BagController",templateUrl:"templates/order-flow/bag.html"})}(),function(){"use strict";function BagController($state,states,orderService,navigate,bag,$scope,$filter,$interval,analyticsService,confirmationModal,restaurant){function getPendingOrders(){if(!vm.order||!vm.order.meals)return vm.tabs[1].title="0 PENDING",vm.pendingOrders;var pending=vm.order.meals.filter(function(meal){return"UnfinishedGroup"===meal.meal.mealType});return angular.equals(pending,vm.pendingOrders)?vm.pendingOrders:(angular.copy(pending,vm.pendingOrders),vm.tabs[1].title=vm.pendingOrders.length+" PENDING",vm.pendingOrders)}function getDeclinedOrders(){if(!vm.order||!vm.order.meals)return vm.tabs[2].title="0 DECLINED",vm.declinedOrders;var declined=vm.order.meals.filter(function(meal){return"DeclinedGroup"===meal.meal.mealType});return angular.equals(declined,vm.declinedOrders)?vm.declinedOrders:(angular.copy(declined,vm.declinedOrders),vm.tabs[2].title=vm.declinedOrders.length+" DECLINED",vm.declinedOrders)}function getHostMeals(){return orderService.getIndividualMeals()}function getFinishedGroupOrderMeals(){return orderService.getFinishedGroupOrderMeals()}function getIndividualGroupOrderMeals(){var meals=orderService.getIndividualGroupOrderMeals();return meals}function cancelOrder(){orderService.cancelOrder()}function onCancelOrder(){orderService.cancelOrder().then(function(){bag.close(),orderService.refreshBag(),$state.current.name!==states.GROUP_HOST_HOME&&navigate.toHome()})}function cancelOrderModal(){bag.cancelGroupOrder(onCancelOrder)}function getMeals(){if(!vm.order.meals)return[];var meals;return meals=vm.order.meals.filter(function(meal){return"FinishedGroup"===meal.meal.mealType||"Regular"===meal.meal.mealType}),vm.tabs[0].title=meals.length+" IN BAG",meals}function getTotal(){var price=0;return vm.order.meals&&vm.order.meals.forEach(function(item){price+=item.mealSummary.subtotal}),price}function isGroupOrder(){return vm.order&&"Group"===vm.order.orderType}function addAnotherMeal(){bag.close(),navigate.toHome()}function goCheckout(){analyticsService.checkout(angular.copy(vm.order),1),bag.close(),navigate.toCheckout()}function closeModal(){bag.isLocked()||bag.close()}function isBagLocked(){return bag.isLocked()}function backToOrdering(){bag.close(),navigate.toHome()}var vm=this;vm.getTotal=getTotal,vm.order={},vm.addAnotherMeal=addAnotherMeal,vm.goCheckout=goCheckout,vm.closeModal=closeModal,vm.backToOrdering=backToOrdering,vm.isBagLocked=isBagLocked,vm.isGroupOrder=isGroupOrder,vm.groupOrder=!1,vm.getMeals=getMeals,vm.cancelOrder=cancelOrder,vm.cancelOrderModal=cancelOrderModal,vm.getHostMeals=getHostMeals,vm.getFinishedGroupOrderMeals=getFinishedGroupOrderMeals,vm.getIndividualGroupOrderMeals=getIndividualGroupOrderMeals,vm.getPendingOrders=getPendingOrders,vm.getDeclinedOrders=getDeclinedOrders,vm.pendingOrders=[],vm.declinedOrders=[],vm.showCancelOrderModal=!1,vm.activeTab="",vm.tabs=[{title:"",click:function(){vm.activeTab="bag"}},{title:"0 PENDING",click:function(){vm.activeTab="pending"}},{title:"0 DECLINED",click:function(){vm.activeTab="declined"}}],vm.$onInit=function(){vm.activeTab="bag",orderService.getOrder().then(function(order){vm.order=order,"Group"===vm.order.orderType?vm.interval=$interval(orderService.refreshBag,3e4):vm.interval&&$interval.cancel(vm.interval)}),vm.host={}},$scope.$watch(function(){return bag.isOpen()},function(){vm.show=bag.isOpen(),vm.bagLocked=bag.isLocked()}),restaurant.onChange($scope,orderService.refreshBag),vm.$onDestroy=function(){$interval.cancel(vm.interval)}}angular.module("app.order-flow").controller("BagController",BagController),BagController.$inject=["$state","states","orderService","navigate","bag","$scope","$filter","$interval","analyticsService","confirmationModal","restaurant"]}(),function(){"use strict";function bag($state,navigate,confirmationModal,event){function _open(lock){locked=!!lock&&lock,openned=!0,event.emit("bag","open")}function _close(){openned=!1,locked=!1,event.emit("bag","close")}function isOpen(){return openned}function isLocked(){return locked}function cancelGroupOrder(onConfirm,onCancel){var options={title:"Cancel Group Order",headingText:"Are you sure?",bodyText:"This is kind of big deal. Canceling will delete allmeals from your bag, including the ones in progress, and cannot be undone.",confirmButtonText:"YES, CANCEL",cancelButtonText:"NO, GO BACK",onConfirm:onConfirm,onCancel:onCancel};confirmationModal.show(options)}var openned=!1,locked=!1,service={isOpen:isOpen,isLocked:isLocked,open:_open,close:_close,cancelGroupOrder:cancelGroupOrder};return service}angular.module("app.services").factory("bag",bag),bag.$inject=["$state","navigate","confirmationModal","event"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgBagPendingDeclined",{templateUrl:"templates/order-flow/bag-pending-declined.html",bindings:{meals:"<",cancel:"&"},controller:"bagPendingDeclinedController",transclude:{emptySlot:"empty",textSlot:"text"}})}(),function(){"use strict";function BagPendingDeclinedController(){function showCancelOrderModal(){vm.cancel()}var vm=this;vm.showCancelOrderModal=showCancelOrderModal,vm.cancelModalShow=!1}angular.module("app.order-flow").controller("bagPendingDeclinedController",BagPendingDeclinedController),BagPendingDeclinedController.$inject=[]}(),function(){"use strict";angular.module("app.order-flow").component("cmgDecline",{controller:"DeclineController",bindings:{},templateUrl:"templates/order-flow/decline.html"})}(),function(){"use strict";function DeclineController(groupOrderService,$window,analyticsService){function decline(){analyticsService.fireCustomEvent("decline","button-click",$window.document.title),groupOrderService.declineGroupInvitation(),vm.showModal=!1}var vm=this;vm.showModal=!1,vm.decline=decline}angular.module("app.order-flow").controller("DeclineController",DeclineController),DeclineController.$inject=["groupOrderService","$window","analyticsService"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgElevator",{controller:"ElevatorController",bindings:{meal:"<",readyToSubmit:"<",entree:"@",continueText:"@",submit:"&"},templateUrl:"templates/order-flow/elevator.html"})}(),function(){"use strict";function ElevatorController(mealService,customizationsModal,entreeService){function getEntreeName(){return entreeService.getEntreeName()}function customize(){customizationsModal.show()}function customizationsAvailable(){return mealService.hasCustomizations(entreeService.getMeal())}var vm=this;vm.customize=customize,vm.customizationsAvailable=customizationsAvailable,vm.getEntreeName=getEntreeName}angular.module("app.order-flow").controller("ElevatorController",ElevatorController),ElevatorController.$inject=["mealService","customizationsModal","entreeService"]}(),function(){"use strict";function stickIt($window){function link(scope,element,attrs){function doWork(){initialTop||(initialTop=element[0].getBoundingClientRect().top);var elementHeight=element[0].offsetHeight,clientHeight=$window.document.body.clientHeight,pageOffset=$window.pageYOffset;if(pageOffset>initialTop-params.topOffset?(element.css({position:"fixed"}),element.css({top:params.topOffset+"px"}),element.css({bottom:"initial"})):(element.css({position:"initial"}),element.css({top:"initial"}),element.css({bottom:"initial"})),pageOffset+params.topOffset+elementHeight>clientHeight-params.bottom){element.css({position:"fixed"});var offset=$window.innerHeight-(clientHeight-params.bottom-pageOffset);element.css({bottom:offset.toString()+"px"}),element.css({top:"initial"})}}function throttled_doWork(){$window.requestAnimationFrame(function(){doWork(last_known_position)})}var last_known_position=0,params=scope.$eval(attrs.stickIt),initialTop=null,res=angular.element($window).bind("scroll",_.throttle(throttled_doWork,16));element.on("$destroy",function(){res.off("scroll"),res=null})}var directive={link:link,restrict:"A"};return directive}angular.module("app.widgets").directive("stickIt",stickIt),stickIt.$inject=["$window"]}(),function(){"use strict";function entreeRiceBeans(){function select(_item_,_items_){clearMC(_items_);var fsm=new riceBeansFSM(_items_,_item_);fsm.start()}function whichState(items,fsm){var selectedItems=getSelected(items);return 0===selectedItems.length?new noSelection(fsm):1===selectedItems.length&&isNoSelectionType(selectedItems[0].Type)?new noSelected(fsm):1===selectedItems.length?new oneSelected(fsm):2===selectedItems.length?new halfAndHalfSelected(fsm):void 0}function clearMC(items){angular.forEach(items,function(rice){delete rice.customization})}function getSelected(items){var selectedItems=items.filter(function(item){return item.selected===!0});return selectedItems}function removeSelection(items){angular.forEach(items,function(item){item.selected=!1,item.portion=""})}function isNoSelectionType(type){return"NoRice"===type||"NoBeans"===type}var service={select:select},riceBeansFSM=function(_items_,_item_){this.item=_item_,this.items=_items_;var state=whichState(_items_,this);this.start=function(){state.go()},this.change=function(newState){state=newState}},noSelection=function(fsm){this.go=function(){return"NoRice"===fsm.item.Type?(fsm.item.selected=!0,void fsm.change(new noSelected(fsm))):(fsm.item.selected=!0,void fsm.change(new oneSelected(fsm)))}},oneSelected=function(fsm){this.go=function(){if(isNoSelectionType(fsm.item.Type))return removeSelection(fsm.items),void(fsm.item.selected=!0);if(!fsm.item.selected){fsm.item.selected=!0;var selectedItems=getSelected(fsm.items);angular.forEach(selectedItems,function(item){item.portion="half"}),fsm.change(new halfAndHalfSelected(fsm))}}},noSelected=function(fsm){this.go=function(){removeSelection(fsm.items),fsm.item.selected=!0,fsm.change(new oneSelected(fsm))}},halfAndHalfSelected=function(fsm){this.go=function(){if(isNoSelectionType(fsm.item.Type))return removeSelection(fsm.items),fsm.item.selected=!0,void fsm.change(new noSelected(fsm));fsm.item.selected=!1,fsm.item.portion="";var selectedItems=getSelected(fsm.items);angular.forEach(selectedItems,function(item){item.selected=!0,item.portion="single"})}};return service}angular.module("app.order-flow").factory("entreeRiceBeans",entreeRiceBeans)}(),function(){"use strict";angular.module("app.order-flow").component("cmgEntree",{controller:"EntreeController",templateUrl:"templates/order-flow/entree.html",bindings:{getDefaultMealName:"&",addMeal:"&",groupOrder:"@",mealCompleteText:"@"}})}(),function(){"use strict";function EntreeController($stateParams,entreeService,$state,navigate,error,restaurant,analyticsService,menu,fillingsService,orderService){function selectKidsByo(item,group){entreeService.selectKidsByo(item,group),vm.meal&&analyticsService.productClick(vm.meal.Name,"Entree")}function selectKidsMeal(type){vm.meal&&vm.meal.Type&&type!==vm.meal.Type.toLowerCase()&&entreeService.clearMeal(),$state.go($state.current.name,{type:type,scroll:!1,mealId:null})}function selectKidsSide(item){entreeService.selectKidsSide(item)}function selectKidsDrink(item){entreeService.selectKidsDrink(item)}function selectQuantity(item){entreeService.selectQuantity(item)}function selectTortilla(item){entreeService.selectTortilla(item)}function selectFillings(item){vm.meal&&analyticsService.productClick(vm.meal.Name,"Entree"),entreeService.selectFillings(item)}function selectRice(item){entreeService.selectRice(item)}function selectBeans(item){entreeService.selectBeans(item)}function selectToppings(item){entreeService.selectToppings(item)}function selectSidesDrinks(item,params){entreeService.selectSidesDrinks(item,params)}function extra(){entreeService.setExtra()}function showExtra(){return vm.entree.indexOf("kids")<0}function completeMeal(){"true"===vm.groupOrder?displayMealSummary():addMealToBag()}function addMealToBag(){vm.addMeal({entree:vm.entree}).then(function(){analyticsService.fireCustomEvent("build-meal","meal-added",vm.entree)})}function needsMealName(){return!vm.meal||!vm.meal.name||0===vm.meal.name.length}function getEntreeDisplayPrefix(){return entreeService.getEntreeDisplayPrefix()}function toggleModal(){vm.showMealSummaryModal=vm.showMealSummaryModal?vm.showMealSummaryModal=!1:vm.showMealSummaryModal=!0}function getNextText(){return"add meal to bag"}function displayMealSummary(){analyticsService.fireCustomEvent("build-meal","show-meal-summary",vm.entree),vm.mealSummary=entreeService.getMealSummary(vm.meal),toggleModal(),vm.mealSummaryMeal=angular.copy(vm.meal)}function initializeMeal(){if($stateParams.mealId)vm.editing=!0,vm.menuLoaded=!0,orderService.getOrder().then(function(order){vm.loading=!1;var find=order.meals.find(function(item){return item.meal.mealId.toString()===$stateParams.mealId});if(find){var editMeal=find.meal;entreeService.initializeMealToEdit(editMeal),vm.meal=editMeal,entreeService.setupSteps(vm.meal),vm.meal&&analyticsService.productView(vm.meal.Name,"sides-drinks"===vm.entree?"Sides":"Entree")}else navigate.toHome()});else{var existingMeal=entreeService.getMeal();existingMeal?(vm.loading=!1,vm.meal=existingMeal,vm.menuLoaded=!0,entreeService.setupSteps(vm.meal),vm.meal&&analyticsService.productView(vm.meal.Name,"sides-drinks"===vm.entree?"Sides":"Entree")):(vm.menuLoaded=!1,menu.get().then(function(menu){vm.loading=!1;var newMeal=entreeService.createMeal(menu,$stateParams.type);newMeal&&fillingsService.init(newMeal),vm.meal=newMeal,entreeService.setMeal(newMeal),vm.meal&&vm.getDefaultMealName().then(function(email){vm.meal.name=email}),vm.menuLoaded=!0,entreeService.setupSteps(vm.meal),vm.meal&&analyticsService.productView(vm.meal.Name,"sides-drinks"===vm.entree?"Sides":"Entree")}))}}var vm=this;vm.meal,vm.entree="",vm.steps=entreeService.steps,vm.selected=entreeService.selectedItems,vm.readyToSubmit=entreeService.readyToSubmit,vm.name="",vm.showMealSummaryModal=!1,vm.mealSummary={},vm.instructions="",vm.showModal=!1,vm.entreeWithoutCount="",vm.menuLoaded=!1,vm.documentLoaded=!1,vm.loading=!0,vm.editing=!1,vm.selectKidsByo=selectKidsByo,vm.selectKidsMeal=selectKidsMeal,vm.selectKidsSide=selectKidsSide,vm.selectKidsDrink=selectKidsDrink,vm.selectQuantity=selectQuantity,vm.selectTortilla=selectTortilla,vm.selectFillings=selectFillings,vm.selectRice=selectRice,vm.selectBeans=selectBeans,vm.selectToppings=selectToppings,vm.selectSidesDrinks=selectSidesDrinks,vm.addMealToBag=addMealToBag,vm.needsMealName=needsMealName,vm.extra=extra,vm.showExtra=showExtra,vm.getEntreeDisplayPrefix=getEntreeDisplayPrefix,vm.toggleModal=toggleModal,vm.completeMeal=completeMeal,vm.getNextText=getNextText,vm.$onInit=function(){restaurant.getId()||navigate.toHome(),vm.entree=$stateParams.type,initializeMeal()}}angular.module("app.order-flow").controller("EntreeController",EntreeController),EntreeController.$inject=["$stateParams","entreeService","$state","navigate","error","restaurant","analyticsService","menu","fillingsService","orderService"]}(),function(){"use strict";function EntreeService($document,$filter,$stateParams,$timeout,bag,entreeRiceBeans,fillingsService,mealService,navigate,customizations){function extraPrice(){return fillingsService.extraPrice()}function setExtra(){fillingsService.setExtra()}function extraSelected(){return fillingsService.extraSelected()}function extraEnabled(){var isEnabled=!0;if(fillingsService.isVeggieSelected()&&(isEnabled=!1),meal&&meal.Quantities){var tacoQuantity=getSelectedItems(meal.Quantities)[0];tacoQuantity&&"TacosThree"!==tacoQuantity.Type&&(isEnabled=!1)}return isEnabled}function getMeal(){return meal}function setMeal(newMeal){meal=newMeal}function clearMeal(){meal=null}function createMeal(menu,entreeType){var mealToCreate=null;switch(entreeType.toLowerCase()){case"burrito":mealToCreate=buildStandardMeal(menu.Burrito,menu.Sides,menu.Drinks);break;case"bowl":case"burritobowl":mealToCreate=buildStandardMeal(menu.Bowl,menu.Sides,menu.Drinks);break;case"salad":mealToCreate=buildStandardMeal(menu.Salad,menu.Sides,menu.Drinks);break;case"tacos":mealToCreate=buildStandardMeal(menu.Tacos,menu.Sides,menu.Drinks);break;case"kidsquesadilla":mealToCreate={},mealToCreate=angular.merge(menu.KidsQuesadilla),mealToCreate.KidsSides=angular.copy(menu.KidsSides),mealToCreate.KidsDrinks=angular.copy(menu.KidsDrinks),angular.forEach(mealToCreate,initializeItemState);break;case"kidsbuildyourown":mealToCreate={},mealToCreate=angular.merge(menu.KidsBuildYourOwn),mealToCreate.KidsSides=angular.copy(menu.KidsSides),mealToCreate.KidsDrinks=angular.copy(menu.KidsDrinks),angular.forEach(mealToCreate,initializeItemState);break;case"sides-drinks":case"sidesdrinks":mealToCreate={},mealToCreate.Type="SidesDrinks",mealToCreate.Sides=angular.copy(menu.Sides),mealToCreate.Drinks=angular.copy(menu.Drinks)}return angular.copy(mealToCreate)}function editMeal(entreeType,stateChange,groupOrder,meal){"true"!==groupOrder&&(bag.close(),navigate.toEntreeEdit(entreeType,meal.mealId))}function initializeMealToEdit(meal){if(clearMeal(),setMeal(meal),fillingsService.init(meal),meal.Fillings){var fillings=meal.Fillings.filter(function(i){return i.selected});2===fillings.length?"single"===fillings[0].portion&&"single"===fillings[1].portion&&fillingsService.setExtra():1===fillings.length&&"extra"===fillings[0].portion&&fillingsService.setExtra(),angular.forEach(fillings,function(filling){filling.selected=!1,fillingsService.selectItem(filling)})}"KidsBuildYourOwn"===meal.Type&&setKidsByoItemState()}function selectKidsByo(item,group){switch(group){case"fillings":selectFillings(item);break;case"rice":case"beans":case"toppings":toggleSelect(item)}steps.kidsSides="open",setKidsByoItemState()}function selectKidsSide(item){item.quantity="NoSide"===item.Type?null:1,radioSelect(item,meal.KidsSides),steps.kidsDrinks="open"}function selectKidsDrink(item){item.quantity="NoDrink"===item.Type?null:1,radioSelect(item,meal.KidsDrinks)}function selectQuantity(item){radioSelect(item,meal.Quantities),mealService.assignPrices(item.Prices,meal.Fillings),mealService.assignPrices(item.Prices,meal.Toppings);var selectedFilling=meal.Fillings.find(function(i){return i.selected});if(selectedFilling&&(fillingsService.init(meal),fillingsService.selectItem(selectedFilling)),steps.tortilla="open","TacosOne"===item.Type,!0){var guac=meal.Toppings.find(function(item){return"GuacTopping"===item.Type});guac&&guac.customization&&delete guac.customization}}function lastSelected(){return _lastSelected}function selectTortilla(item){radioSelect(item,meal.Tortillas),steps.fillings="open",steps.kidsbyo="open"}function selectFillings(item){fillingsService.selectItem(item),steps.rice="open",item.selected&&(_lastSelected=item)}function selectRice(item){mealService.hasCustomizations(meal)&&!customizations.maxCustomizationsReached(meal)?entreeRiceBeans.select(item,meal.Rice):radioSelect(item,meal.Rice),steps.beans="open",item.selected&&(_lastSelected=item)}function selectBeans(item){mealService.hasCustomizations(meal)&&!customizations.maxCustomizationsReached(meal)?entreeRiceBeans.select(item,meal.Beans):radioSelect(item,meal.Beans),steps.toppings="open",steps.sidesDrinks="open",steps.kidsSides="open",item.selected&&(_lastSelected=item)}function selectToppings(item){toggleSelect(item),item.selected&&(_lastSelected=item)}function selectSidesDrinks(item,params){switch(params){case"select":if(item.selected)break;item.selected=!0,item.state="number",item.quantity=1;break;case"add":addItem(item);break;case"subtract":subtractItem(item)}}function getMealToSubmit(mealToSubmit){return{entree:{type:mealToSubmit.Type},quantities:getSelectedItems(mealToSubmit.Quantities),tortillas:getSelectedItems(mealToSubmit.Tortillas),fillings:getSelectedItems(mealToSubmit.Fillings),rice:getSelectedItems(mealToSubmit.Rice),beans:getSelectedItems(mealToSubmit.Beans),toppings:getSelectedItems(mealToSubmit.Toppings),sides:getSelectedItems(mealToSubmit.Sides),drinks:getSelectedItems(getAllDrinks(mealToSubmit.Drinks)),kidssides:getSelectedItems(mealToSubmit.KidsSides),kidsdrinks:getSelectedItems(mealToSubmit.KidsDrinks),mealName:mealToSubmit.name,mealId:mealToSubmit.mealId,instructions:mealToSubmit.instructions}}function readyToSubmit(){function baseMealComplete(){return hasSelected(meal.Fillings)&&hasSelected(meal.Rice)&&hasSelected(meal.Beans)}if(meal)switch(meal.Type){case"KidsBuildYourOwn":return(hasSelected(meal.Fillings)||hasSelected(meal.Rice)||hasSelected(meal.Beans)||hasSelected(meal.Toppings))&&hasSelected(meal.KidsSides)&&hasSelected(meal.KidsDrinks);case"KidsQuesadilla":return baseMealComplete()&&hasSelected(meal.Tortillas)&&hasSelected(meal.KidsSides)&&hasSelected(meal.KidsDrinks);case"Tacos":return baseMealComplete()&&hasSelected(meal.Tortillas)&&hasSelected(meal.Quantities);case"SidesDrinks":return hasSelected(meal.Sides)||hasSelected(getAllDrinks(meal.Drinks));default:return baseMealComplete()}}function getMealSummary(){return mealService.getMealSummary(meal)}function getEntreeName(){return mealService.getEntreeName(meal)}function scrollToStep(step){$timeout(function(){var ele=angular.element(document.getElementById(step));ele&&$document.scrollTo(ele,80,1e3)},0)}function setupSteps(meal){function setQuantityStep(){return"Tacos"===meal.Type?"open":"closed"}function setTortillaStep(){return hasSelected(meal.Tortillas)||"KidsBuildYourOwn"===meal.Type||"KidsQuesadilla"===meal.Type?"open":"closed"}function setKidsbyoStep(){return hasSelected(meal.Fillings)||hasSelected(meal.Rice)||hasSelected(meal.Beans)||hasSelected(meal.Toppings)?"open":"closed"}function setFillingsStep(){return hasSelected(meal.Fillings)||["Burrito","Salad","BurritoBowl","KidsQuesadilla"].indexOf(meal.Type)>-1?"open":"closed"}function setRiceStep(){return hasSelected(meal.Rice)||hasSelected(meal.Fillings)?"open":"closed"}function setBeansStep(){return hasSelected(meal.Beans)||hasSelected(meal.Rice)?"open":"closed"}function setToppingsStep(){return hasSelected(meal.Toppings)||hasSelected(meal.Beans)?"open":"closed"}function setSidesDrinksStep(){return hasSelected(meal.Beans)||"SidesDrinks"===meal.Type?"open":"closed"}function setKidsSidesStep(){return"KidsBuildYourOwn"===meal.Type?hasSelected(meal.Fillings)||hasSelected(meal.Rice)||hasSelected(meal.Beans)||hasSelected(meal.Toppings)?"open":"closed":hasSelected(meal.Beans)?"open":"closed"}function setKidsDrinksStep(){return hasSelected(meal.KidsSides)?"open":"closed"}meal&&(steps.quantity=setQuantityStep(),steps.tortilla=setTortillaStep(),steps.kidsbyo=setKidsbyoStep(),steps.fillings=setFillingsStep(),steps.rice=setRiceStep(),steps.beans=setBeansStep(),steps.toppings=setToppingsStep(),steps.sidesDrinks=setSidesDrinksStep(),steps.kidsSides=setKidsSidesStep(),steps.kidsDrinks=setKidsDrinksStep())}function getPortionDisplayTitle(portion){return mealService.getPortionDisplayTitle(portion)}function initializeItemState(items,value,meal){items.map&&angular.forEach(items,function(item){item.portion="",item.isDefault=isItemDefault(item,meal),item.selected=item.isDefault,item.isNone=isItemNone(item),item.isProminent=isItemProminent(item),item.free=!1,item.disabled=!1})}function isItemNone(item){return["NoRice","NoBeans","NoDrink","NoSide"].indexOf(item.Type)>-1}function isItemProminent(item){return"GuacTopping"===item.Type||"TacosThree"===item.Type}function isItemDefault(item,meal){if(meal)return"Vinaigrette"===item.Type&&"Salad"===meal.Type||"TortillaFlour"===item.Type&&"KidsQuesadilla"===meal.Type}function hasSelected(items){if(!items)return!1;var selected=items.filter(function(item){return item.selected===!0&&"Vinaigrette"!==item.Type});return selected.length>0}function addItem(item){10!==item.quantity&&item.quantity++}function subtractItem(item){return 1===item.quantity?(item.selected=!1,void(item.state="unchecked")):void item.quantity--}function toggleSelect(item){item.selected=!item.selected,item.selected||resetMc(item)}function radioSelect(item,items){var selectedItems=items.filter(function(obj){return obj.selected===!0});if(0===selectedItems.length&&(item.selected=!0),1===selectedItems.length&&(selectedItems[0].selected=!1,resetMc(selectedItems[0]),item.selected=!0),2===selectedItems.length){angular.forEach(selectedItems,function(item){resetMc(item),item.portion="single",item.selected=!0});var selectedItem=selectedItems.find(function(selected){return item===selected});selectedItem?selectedItem.selected=!1:(item.selected=!0,angular.forEach(selectedItems,function(item){item.selected=!1}))}}function getSelectedItems(items){return mealService.getSelectedItems(items)}function getAllDrinks(drinkGroups){var items=[];return angular.forEach(drinkGroups,function(group){items=items.concat(group)}),items}function buildStandardMeal(entree,sides,drinks){var newMeal={};return angular.merge(newMeal,entree),newMeal.Sides=angular.copy(sides),angular.forEach(newMeal,initializeItemState),newMeal.Drinks=angular.copy(drinks),angular.forEach(newMeal.Drinks,initializeItemState),newMeal}function setKidsByoItemState(){var byoItems=meal.Fillings.concat(meal.Beans,meal.Rice,meal.Toppings),itemCount=getSelectedItems(byoItems).length,disableSelections=!1;itemCount>=3&&(disableSelections=!0),angular.forEach(byoItems,function(item){item.selected||(item.disabled=disableSelections)});var selectedFilling=meal.Fillings.find(function(i){return i.selected});selectedFilling&&meal.Fillings.forEach(function(item){item.selected||(item.disabled=!0)})}function resetMc(item){item.customization&&delete item.customization}var _lastSelected,meal=null,steps={quantity:"closed",tortilla:"closed",kidsbyo:"closed",fillings:"closed",rice:"closed",beans:"closed",toppings:"closed",sidesDrinks:"closed",kidsSides:"closed",kidsDrinks:"closed"};return{extraPrice:extraPrice,setExtra:setExtra,extraSelected:extraSelected,extraEnabled:extraEnabled,clearMeal:clearMeal,getMeal:getMeal,setMeal:setMeal,createMeal:createMeal,editMeal:editMeal,initializeMealToEdit:initializeMealToEdit,selectKidsByo:selectKidsByo,selectKidsSide:selectKidsSide,selectKidsDrink:selectKidsDrink,selectQuantity:selectQuantity,selectTortilla:selectTortilla,selectFillings:selectFillings,selectBeans:selectBeans,selectRice:selectRice,selectToppings:selectToppings,selectSidesDrinks:selectSidesDrinks,getMealToSubmit:getMealToSubmit,hasSelected:hasSelected,getMealSummary:getMealSummary,getSelectedItems:getSelectedItems,getPortionDisplayTitle:getPortionDisplayTitle,getEntreeName:getEntreeName,scrollTo:scrollToStep,readyToSubmit:readyToSubmit,steps:steps,setupSteps:setupSteps,lastSelected:lastSelected}}angular.module("app.order-flow").factory("entreeService",EntreeService),EntreeService.$inject=["$document","$filter","$stateParams","$timeout","bag","entreeRiceBeans","fillingsService","mealService","navigate","customizations"]}(),function(){angular.module("app.order-flow").component("cmgEntreeTile",{templateUrl:"templates/order-flow/entree-tile.html",transclude:{imgSlot:"img"},bindings:{name:"@"}})}(),function(){"use strict";angular.module("app.order-flow").component("cmgEntrees",{controller:"EntreesController",templateUrl:"templates/order-flow/entrees.html",bindings:{groupOrder:"<"}})}(),function(){"use strict";function EntreesController(entreesService,analyticsService,$scope,menu,restaurant){function selectEntree(entree){analyticsService.fireCustomEvent("build-meal","select-entree",entree),entreesService.navigateTo(entree,vm.groupOrder)}function getMenu(){menu.get().then(function(m){vm.menu=m})}function showKidsMeals(){return!vm.menu||vm.menu.KidsBuildYourOwn&&vm.menu.KidsQuesadilla}var vm=this;vm.loading=!0,vm.menu=null,vm.selectEntree=selectEntree,vm.showKidsMeals=showKidsMeals,vm.$onInit=function(){getMenu(),angular.element(document).ready(function(){vm.loading=!1,$scope.$evalAsync()}),restaurant.onChange($scope,getMenu),vm.loading=!1}}angular.module("app.order-flow").controller("EntreesController",EntreesController),
EntreesController.$inject=["entreesService","analyticsService","$scope","menu","restaurant"]}(),function(){"use strict";function EntreesService(navigate,entreeService){function navigateTo(entree,groupOrder){entreeService.clearMeal(),groupOrder===!0?navigate.toGroupOrderInviteeEntree(entree):navigate.toEntree(entree)}return{navigateTo:navigateTo}}angular.module("app.order-flow").factory("entreesService",EntreesService),EntreesService.$inject=["navigate","entreeService"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgExtraPortion",{controller:"ExtraPortionController",templateUrl:"templates/order-flow/extra-portion.html"})}(),function(){"use strict";function ExtraPortionController($scope,entreeService){function click(){vm.isEnabled&&entreeService.setExtra()}var vm=this;vm.click=click,vm.extraPrice=null,vm.isEnabled=!0,vm.isExtra=!1,$scope.$watch(entreeService.extraPrice,function(price){vm.extraPrice=price}),$scope.$watch(entreeService.extraEnabled,function(isEnabled){vm.isEnabled=isEnabled}),$scope.$watch(entreeService.extraSelected,function(isExtra){vm.isExtra=isExtra})}angular.module("app.order-flow").controller("ExtraPortionController",ExtraPortionController),ExtraPortionController.$inject=["$scope","entreeService"]}(),function(){"use strict";function FillingsService(){function init(meal){fsm=new FillingsFSM(meal)}function setExtra(){fsm&&fsm.setExtra()}function selectItem(item){fsm&&fsm.selectItem(item)}function extraPrice(){return fsm?fsm.extraPrice():null}function totalPrice(selectedItems,extra){return getTotalPrice(selectedItems,extra)}function extraSelected(){return!!fsm&&fsm.extraSelected()}function isVeggieSelected(){return!!fsm&&fsm.isVeggieSelected()}function reset(){fsm&&fsm.reset()}function FillingsFSM(meal){function setTwoMeatPriceDisplay(){var cheapestFilling=getCheapestFilling(selectedItems),mostExpensiveFilling=getMostExpensiveFilling(selectedItems);extra?(cheapestFilling.hidePrice=!1,mostExpensiveFilling.hidePrice=!0):(cheapestFilling.hidePrice=!0,mostExpensiveFilling.hidePrice=!1)}function setItemState(item,state){switch(state){case"checked":item.portion="single",item.selected=!0;break;case"unchecked":item.selected=!1,item.portion="single";break;case"half":item.portion="half",item.selected=!0;break;case"extra":item.portion="extra",item.selected=!0;break;case"double":item.portion="double",item.selected=!0;break;case"disabled":item.disabled=!0;break;case"enabled":item.disabled=!1}}function resetFillings(){"SidesDrinks"!==entreeType&&(currentState=states.noselect,selectedItems=[],angular.forEach(fillings,function(item){setItemState(item,"enabled"),setItemState(item,"unchecked")}),extra=!1,extraPrice={price:0},"KidsBuildYourOwn"!==entreeType&&setGroupsState([rice,beans,toppings,sides,drinks],"disabled"))}function toggleVeggieDisable(){setVeggieState(extra?"disabled":"enabled")}function resetDisabledFillings(excludeVeggie){angular.forEach(fillings,function(item){excludeVeggie?"Veggie"!==item.Type&&setItemState(item,"enabled"):setItemState(item,"enabled")})}function disableNotSelected(items){angular.forEach(items,function(item){item.selected||setItemState(item,"disabled")})}function setGroupsState(groups,state){angular.forEach(groups,function(group){angular.forEach(group,function(item){setItemState(item,state)})})}function setVeggieState(state){var veggie=fillings.find(function(item){return"Veggie"===item.Type});veggie&&setItemState(veggie,state)}function setExtraOneFilling(){var obj=selectedItems[0];if(obj.ExtraPrice>0)if(extra)setItemState(obj,"extra");else{setItemState(obj,"checked");var excludeVeggie="Tacos"!==entreeType;"Tacos"!==entreeType?resetDisabledFillings(fillings,excludeVeggie):disableNotSelected(fillings)}}var toppings=meal.Toppings?meal.Toppings:[],fillings=meal.Fillings?meal.Fillings:[],rice=meal.Rice,beans=meal.Beans,sides=[];meal.Sides?sides=meal.Sides:meal.KidsSides&&(sides=meal.KidsSides);var drinks=[];meal.Drinks?angular.forEach(meal.Drinks,function(drink){drinks=drinks.concat(drink)}):meal.KidsDrinks&&(drinks=meal.KidsDrinks);var currentState=null,entreeType=meal.Type,selectedItems=[],extra=!1,extraPrice={price:0},states={noselect:{selectItem:function(item){if(setGroupsState([rice,beans,toppings,sides,drinks],"enabled"),setItemState(item,"checked"),selectedItems.push(item),extraPrice.price=item.ExtraPrice,["Tacos","KidsQuesadilla","KidsBuildYourOwn"].indexOf(entreeType)>-1&&disableNotSelected(fillings),"Veggie"===item.Type){angular.forEach(fillings,function(item){"Veggie"!==item.Type&&setItemState(item,"disabled")}),currentState=states.veggieSelected;var guac=toppings.find(function(obj){return"GuacTopping"===obj.Type});guac&&(guac.free=!0)}else setExtraOneFilling(),setVeggieState("disabled"),currentState=states.oneselected},setExtra:function(){extra=!extra,toggleVeggieDisable()}},oneselected:{selectItem:function(item){if(selectedItems[0]===item)reset();else{var enforceSingleFilling=["Tacos","KidsQuesadilla","KidsBuildYourOwn"].indexOf(entreeType)>-1;if("Veggie"===item.Type||enforceSingleFilling)return;selectedItems.push(item),angular.forEach(selectedItems,function(selectedFilling){setItemState(selectedFilling,extra?"double":"half")}),setTwoMeatPriceDisplay(),extraPrice.price=getMostExpensiveFilling(selectedItems).ExtraPrice,currentState=states.halfandhalf,disableNotSelected(fillings)}},setExtra:function(){extra=!extra,setExtraOneFilling(this)}},halfandhalf:{selectItem:function(item){var selectedIndex=selectedItems.findIndex(function(obj){return obj.Type===item.Type}),selected=selectedItems.find(function(obj){return obj.Type===item.Type});selected&&(setItemState(selected,"unchecked"),selectedItems=selectedItems.map(function(obj){return obj.hidePrice=!1,obj}),selectedItems.splice(selectedIndex,1),extra?(setItemState(selectedItems[0],"extra"),resetDisabledFillings(fillings,!0)):(setItemState(selectedItems[0],"checked"),resetDisabledFillings(fillings,!0)),extraPrice.price=selectedItems[0].ExtraPrice,currentState=states.oneselected)},setExtra:function(){extra=!extra,extra?(angular.forEach(selectedItems,function(obj){setItemState(obj,"double")}),disableNotSelected(fillings)):angular.forEach(selectedItems,function(obj){setItemState(obj,"half")}),setTwoMeatPriceDisplay()}},veggieSelected:{selectItem:function(item){var toppingGuac=toppings.find(function(obj){return"GuacTopping"===obj.Type});toppingGuac&&(toppingGuac.free=!1),"Veggie"===item.Type&&reset()},setExtra:function(){}}};currentState=states.noselect,this.reset=function(){resetFillings()},this.selectItem=function(item){currentState.selectItem(item)},this.setExtra=function(){currentState.setExtra()},this.extraPrice=function(){return extraPrice.price},this.totalPrice=function(selectedItems,extra){return getTotalPrice(selectedItems,extra)},this.extraSelected=function(){return extra},this.isVeggieSelected=function(){var veggie=selectedItems.find(function(item){return"Veggie"===item.Type});return angular.isDefined(veggie)}}function getTotalPrice(selectedItems,extra){if(1===selectedItems.length){var filling=selectedItems[0];return extra?filling.Price+filling.ExtraPrice:filling.Price}if(2===selectedItems.length){var cheapestFilling=getCheapestFilling(selectedItems),mostExpensiveFilling=getMostExpensiveFilling(selectedItems),halfAndHalfPrice=mostExpensiveFilling.Price,doublePrice=cheapestFilling.Price+mostExpensiveFilling.ExtraPrice;return extra?doublePrice:halfAndHalfPrice}return null}function getCheapestFilling(selectedItems){return 2===selectedItems.length?selectedItems[0].Price>=selectedItems[1].Price?selectedItems[1]:selectedItems[0]:void 0}function getMostExpensiveFilling(selectedItems){return 2===selectedItems.length?selectedItems[0].Price<selectedItems[1].Price?selectedItems[1]:selectedItems[0]:void 0}var fsm;return{init:init,setExtra:setExtra,selectItem:selectItem,extraPrice:extraPrice,totalPrice:totalPrice,extraSelected:extraSelected,isVeggieSelected:isVeggieSelected,reset:reset}}angular.module("app.order-flow").factory("fillingsService",FillingsService)}(),function(){"use strict";angular.module("app.order-flow").component("cmgHero",{controller:"HeroController",templateUrl:"templates/order-flow/hero.html",bindings:{currentStep:"<",type:"@"}})}(),function(){"use strict";function HeroController(navigate,$stateParams,entreeService){function activate(){switch(vm.type){case"burrito":vm.bigText="BURRITO",vm.smallText="FLOUR TORTILLA WITH YOUR CHOICE OF MEAT OR SOFRITAS, RICE, BEANS OR FAJITA VEGGIES, SALSA, GUACAMOLE, AND SOUR CREAM OR CHEESE.",vm.imgClass="hero-burrito";break;case"sides-drinks":vm.bigText="SIDES & DRINKS",vm.smallText="everything else you need to round out your meal.",vm.imgClass="hero-sides-drinks";break;case"group-order":vm.bigText="LET'S DO THIS TOGETHER",vm.imgClass="entree-img";break;case"salad":vm.bigText="salad",vm.smallText="chopped romaine lettuce with your choice of meat or sofritas, beans, salsa, guacamole, sour cream or cheese, with freshly made chipotle-honey vinaigrette.",vm.imgClass="hero-salad";break;case"tacos":vm.bigText="tacos",vm.smallText="your choice of tortilla filled with meat or sofritas, salsa, guacamole, sour cream or cheese, and romaine lettuce.",vm.imgClass="hero-tacos";break;case"kids":case"kidsquesadilla":case"kidsbuildyourown":vm.bigText="kid's menu",vm.smallText="build your own meal or enjoy a quesadilla, both served with a drink and seasonal fruit or chips.",vm.imgClass="hero-kids";break;case"bowl":vm.bigText="burrito bowl",vm.smallText="served in a bowl with your choice of meat or sofritas, rice, beans, or fajita veggies, salsa, guacamole, and sour cream or cheese.",vm.imgClass="hero-bowl";break;case"order":vm.bigText="no queue for you",vm.smallText="order now to skip the restaurant line",vm.imgClass="hero-order";break;case"group-order-link":vm.bigText="feeding a team?",vm.smallText="group ordering lets you build an order together",vm.imgClass="entree-img"}}function classes(){var theClasses=vm.imgClass;return null!==entreeService.getMeal()&&(theClasses=""+vm.imgClass),theClasses}function goToGroupOrder(){navigate.toGroupOrderHostHome()}var vm=this;vm.bigText="",vm.smallText="",vm.imgClass="",vm.goToGroupOrder=goToGroupOrder,vm.classes=classes,activate()}angular.module("app.order-flow").controller("HeroController",HeroController),HeroController.$inject=["navigate","$stateParams","entreeService"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgHeroProgress",{controller:"HeroProgressController",bindings:{submit:"&",meal:"<",readyToSubmit:"<",entree:"@",mealCompleteText:"@"},templateUrl:"templates/order-flow/hero-progress.html"})}(),function(){"use strict";function HeroProgressController($stateParams,customizationsModal,entreeService,analyticsService,mealService){function showHeroProgress(){analyticsService.fireCustomEvent("mobile-meal","meal-progress",$stateParams.step),vm.showingProgress=!0}function hideHeroProgress(){vm.showingProgress=!1}function toggleHeroProgress(){vm.showingProgress=!vm.showingProgress}function show(){return!0}function showOpen(){return!vm.showingProgress}function getEntreeName(){return entreeService.getEntreeName()}function customize(){customizationsModal.show()}function canCustomize(){return mealService.hasCustomizations(entreeService.getMeal())}function isKidsMeal(meal){if(meal)return"KidsQuesadilla"===meal.Type||"KidsBuildYourOwn"===meal.Type}var vm=this;vm.showingProgress=!1,vm.show=show,vm.showOpen=showOpen,vm.getEntreeName=getEntreeName,vm.showHeroProgress=showHeroProgress,vm.hideHeroProgress=hideHeroProgress,vm.toggleHeroProgress=toggleHeroProgress,vm.customize=customize,vm.canCustomize=canCustomize,vm.isKidsMeal=isKidsMeal}angular.module("app.order-flow").controller("HeroProgressController",HeroProgressController),HeroProgressController.$inject=["$stateParams","customizationsModal","entreeService","analyticsService","mealService"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgKidsMealSelect",{controller:"KidsMealSelectController",templateUrl:"templates/order-flow/kids-meal-select.html",bindings:{onSelect:"&",type:"<",groupOrder:"<"}})}(),function(){"use strict";function KidsMealSelectController(menu,entreeService,error){function click(type){vm.onSelect({type:type})}function selectQuesadilla(){vm.byoSelected=!1,vm.quesadillaSelected=!0,vm.showNavBar=!0}function selectByo(){vm.quesadillaSelected=!1,vm.byoSelected=!0,vm.showNavBar=!0}function getByoPrice(){vm.byoPrice=findMinPrice(vm.menu.KidsBuildYourOwn.Fillings)}function getQuesPrice(){vm.quesPrice=findMinPrice(vm.menu.KidsQuesadilla.Fillings)}function next(){vm.showNavBar=!1,vm.quesadillaSelected?vm.onSelect({type:"kidsquesadilla"}):vm.byoSelected&&vm.onSelect({type:"kidsbuildyourown"})}function findMinPrice(array){var minPrice=null;return angular.forEach(array,function(item){null===minPrice?minPrice=item.Price:minPrice>item.Price&&(minPrice=item.Price)}),minPrice}var vm=this;vm.quesadillaSelected=!1,vm.byoSelected=!1,vm.byoPrice="",vm.quesPrice="",vm.menu={},vm.navText="Build Meal",vm.showNavBar=!1,vm.showErrorModal=error.showErrorModal,vm.hideErrorModal=error.hideErrorModal,vm.getErrorTitle=error.getErrorTitle,vm.getErrorMessage=error.getErrorMessage,vm.selectByo=selectByo,vm.click=click,vm.selectQuesadilla=selectQuesadilla,vm.next=next,vm.$onInit=function(){if(menu.get().then(function(menu){vm.menu=menu,getByoPrice(),getQuesPrice()},function(){error.showUser("UNABLE TO RETRIEVE MENU","Oops! Something went wrong. Please refresh the page and try again.")}),"kidsquesadilla"===vm.type)vm.quesadillaSelected=!0;else if("kidsbuildyourown"===vm.type)vm.byoSelected=!0;else if("kids"===vm.type){var meal=entreeService.getMeal();meal&&meal.Type&&("KidsQuesadilla"===meal.Type?(vm.quesadillaSelected=!0,vm.showNavBar=!0):"KidsBuildYourOwn"===meal.Type&&(vm.byoSelected=!0,vm.showNavBar=!0))}}}angular.module("app.order-flow").controller("KidsMealSelectController",KidsMealSelectController),KidsMealSelectController.$inject=["menu","entreeService","error"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgProgressKids",{controller:"ProgressKidsController",bindings:{meal:"<",readyToSubmit:"<",hideHeroProgress:"&",allowLinks:"=",entree:"@"},templateUrl:"templates/order-flow/meal-progress-kids.html"})}(),function(){"use strict";function ProgressKidsController(mealProgressKids){function getTortillas(){return mealProgressKids.tortillas(vm.meal)}function getFillingsAndToppings(){return showFeature("fillings-toppings")?vm.fillingsAndToppings:null}function getFillings(){return showFeature("fillings")?mealProgressKids.fillings(vm.meal):null}function getDrinks(){return mealProgressKids.drinks(vm.meal)}function getSides(){return mealProgressKids.sides(vm.meal)}function hasSelected(items){return!!items&&items.findIndex(function(item){return item.selected===!0})!==-1}function showFeature(name){return mealProgressKids.hasFeature(vm.meal,name)}var vm=this;vm.getTortillas=getTortillas,vm.getFillingsAndToppings=getFillingsAndToppings,vm.getDrinks=getDrinks,vm.getSides=getSides,vm.getFillings=getFillings,vm.hasSelected=hasSelected,vm.showFeature=showFeature,vm.$onInit=function(){vm.fillingsAndToppings=[],vm.fillingsAndToppings=vm.fillingsAndToppings.concat(vm.meal.Fillings,vm.meal.Toppings,vm.meal.Rice,vm.meal.Beans)}}angular.module("app.order-flow").controller("ProgressKidsController",ProgressKidsController),ProgressKidsController.$inject=["mealProgressKids"]}(),function(){"use strict";function mealProgressKids(){function getSides(meal){return meal.KidsSides}function getFillings(meal){return meal.Fillings}function getDrinks(meal){return meal.KidsDrinks}function getTortillas(meal){return meal.Tortillas}function hasFeature(meal,name){switch(name){case"rice":if("KidsQuesadilla"===meal.Type)return!0;break;case"beans":if("KidsQuesadilla"===meal.Type)return!0;break;case"fillings":if("KidsQuesadilla"===meal.Type)return!0;break;case"fillings-toppings":if("KidsBuildYourOwn"===meal.Type)return!0}}var service={sides:getSides,drinks:getDrinks,tortillas:getTortillas,hasFeature:hasFeature,fillings:getFillings};return service}angular.module("app.order-flow").factory("mealProgressKids",mealProgressKids)}(),function(){"use strict";angular.module("app.order-flow").component("cmgProgress",{controller:"ProgressController",bindings:{meal:"<",readyToSubmit:"<",hideHeroProgress:"&",allowLinks:"=",entree:"@"},templateUrl:"templates/order-flow/meal-progress.html"})}(),function(){"use strict";function ProgressController($log,entreeService){function getPortionName(portion){return"single"===portion?"":entreeService.getPortionDisplayTitle(portion)}function getFillings(){if(vm.meal&&vm.meal.Fillings)return angular.forEach(vm.meal.Fillings,function(filling){filling.displayPortion=entreeService.getPortionDisplayTitle(filling.portion)}),vm.meal.Fillings}function getRice(){if(vm.meal&&vm.meal.Rice)return getCombinedBeansorRice("RiceWhite","RiceBrown",bothRice,vm.meal.Rice)}function getBeans(){if(vm.meal&&vm.meal.Beans)return getCombinedBeansorRice("BeansBlack","BeansPinto",bothBeans,vm.meal.Beans)}function getCombinedBeansorRice(type1,type2,fakeItem,items){var item1,item2;return items&&(item1=items.find(function(rice){return rice.Type===type1}),item2=items.find(function(rice){return rice.Type===type2})),item1&&item2&&item1.selected&&item2.selected?fakeItem:items}function getSidesDrinks(){return sidesAndDrinks.length>0?(angular.forEach(sidesAndDrinks,function(item){item.displayPortion=item.quantity}),sidesAndDrinks):vm.meal&&vm.meal.Drinks?(sidesAndDrinks=sidesAndDrinks.concat(vm.meal.Sides),angular.forEach(vm.meal.Drinks,function(drinks){angular.forEach(drinks,function(drink){sidesAndDrinks.push(drink)})}),sidesAndDrinks):null}function hasSelected(items){return!!items&&items.findIndex(function(item){return item.selected===!0})!==-1}var vm=this;vm.getPortionName=getPortionName,vm.steps=entreeService.steps,vm.getRice=getRice,vm.getBeans=getBeans,vm.getFillings=getFillings,vm.getSidesDrinks=getSidesDrinks,vm.hasSelected=hasSelected;var bothRice=[{Name:"White & Brown Rice",SummaryName:"White & Brown Rice",portion:"Single",selected:!0}],bothBeans=[{Name:"Black and Pinto Beans",SummaryName:"Black and Pinto Beans",portion:"Single",selected:!0}],sidesAndDrinks=[]}angular.module("app.order-flow").controller("ProgressController",ProgressController),ProgressController.$inject=["$log","entreeService"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgMealSummary",{controller:"MealSummaryController",bindings:{meal:"<",mealSummary:"<",entree:"@",groupOrder:"<",hideDetails:"<",showUnavailableItems:"<",hideContainer:"&",onMealRemoved:"&"},templateUrl:"templates/order-flow/meal-summary.html"})}(),function(){"use strict";function MealSummaryController(entreeService,navigate,$timeout,bag,$document,api,session,orderService,restaurant,$window,$stateParams,confirmationModal,customizations,mealService){function entreePrice(){return _filteredMeal.basePrice}function hasEntree(){return mealService.hasEntree(_filteredMeal)}function getMeal(){return _filteredMeal}function editMeal(stateChange){vm.hideContainer(),entreeService.editMeal(vm.entree,stateChange,vm.groupOrder,vm.meal)}function restartMeal(){navigate.toGroupOrderInviteeHome()}function toggleInstructions(){vm.showInstructions?vm.showInstructions=!1:vm.showInstructions=!0}function hasInstructions(){return customizations.availableCustomizations(entreeService.getMeal())<=0}function saveMealName(){vm.editMode=!1,api.addMeal(session.get("orderId"),entreeService.getMealToSubmit(vm.meal),restaurant.getId())}function saveSpecialInstructions(){vm.groupOrder||api.addMeal(session.get("orderId"),entreeService.getMealToSubmit(vm.meal),restaurant.getId())}function instructionsKey(event){$window.innerWidth<768&&13===event.keyCode&&toggleInstructions()}function allowInstructions(){if(vm.meal)return!("SidesDrinks"===vm.meal.Type||vm.meal.Type.indexOf("Kids")>-1)&&!mealService.hasCustomizations(vm.meal)}function removeMeal(){vm.removeMealModal=!1,orderService.removeMeal(vm.meal.mealId).then(function(){vm.onMealRemoved(),$stateParams.mealId&&(bag.close(),navigate.toHome())})}function openEditMode(){vm.editMode=!0}function removeMealModal(){var params={title:"REMOVE MEAL?",headingText:"REMOVE THIS MEAL?",bodyText:"Are you sure you want to remove this meal from your bag?",confirmButtonText:"confirm",cancelButtonText:"cancel",onConfirm:removeMeal};confirmationModal.show(params)}var vm=this;vm.showInstructions=!1,vm.mealName="test name",vm.chipsAndDrinks=[],vm.chipsAndDrinks=[],vm.removeMealModal=removeMealModal,vm.editMode=!1,vm.editMeal=editMeal,vm.restartMeal=restartMeal,vm.toggleInstructions=toggleInstructions,vm.saveMealName=saveMealName,vm.saveSpecialInstructions=saveSpecialInstructions,vm.instructionsKey=instructionsKey,vm.allowInstructions=allowInstructions,vm.removeMeal=removeMeal,vm.openEditMode=openEditMode,vm.hasInstructions=hasInstructions,vm.getMeal=getMeal,vm.entreePrice=entreePrice,vm.hasEntree=hasEntree;var _filteredMeal;vm.$onInit=function(){_filteredMeal=mealService.filterSelected(vm.meal)}}angular.module("app.order-flow").controller("MealSummaryController",MealSummaryController),MealSummaryController.$inject=["entreeService","navigate","$timeout","bag","$document","api","session","orderService","restaurant","$window","$stateParams","confirmationModal","customizations","mealService"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgMenuItem",{controller:"MenuItemController",transclude:!0,bindings:{onSelect:"&",title:"@",item:"<",price:"@"},templateUrl:"templates/order-flow/menu-item.html"})}(),function(){"use strict";function MenuItemController(){function isItemSelected(){return vm.item.selected}function getItemClass(){return""!==vm.item.customization&&angular.isDefined(vm.item.customization)?customizationToCssClass(vm.item.customization):""!==vm.item.portion?portionToCssClass(vm.item.portion):vm.item.selected?"item-circle-check":void 0}function portionToCssClass(portion){switch(portion){case"half":return"item-circle-half";case"extra":return"item-circle-2x";case"double":return"item-circle-1x";case"single":return"item-circle-check"}}function customizationToCssClass(customization){switch(customization){case"Light":return"item-mc item-mc-light";case"Extra":return"item-mc item-mc-extra";case"Side":return"item-mc item-mc-side"}}var vm=this;vm.isItemSelected=isItemSelected,vm.getItemClass=getItemClass,vm.itemValue,vm.class="",vm.click=function(){vm.item.disabled||vm.onSelect({item:vm.item})}}angular.module("app.order-flow").controller("MenuItemController",MenuItemController)}(),function(){"use strict";angular.module("app.order-flow").component("cmgMenuItemQty",{controller:"MenuItemQtyController",transclude:!0,bindings:{onSelect:"&",title:"@",item:"<"},templateUrl:"templates/order-flow/menu-item-qty.html"})}(),function(){"use strict";function MenuItemQtyController(){function render(){}var vm=this;vm.class="",vm.change=function(action){vm.item.disabled||vm.onSelect({item:vm.item,params:action})},vm.$onChanges=function(){render()},vm.$onInit=function(){render()}}angular.module("app.order-flow").controller("MenuItemQtyController",MenuItemQtyController)}(),function(){"use strict";angular.module("app.order-flow").component("cmgNext",{controller:"NextController",templateUrl:"templates/order-flow/next.html",transclude:!0,bindings:{text:"@",onNext:"&"}})}(),function(){"use strict";function NextController(entreeService,$stateParams){function next(){vm.onNext()}function showExtra(){var isKidsEntree=$stateParams.type.indexOf("kids")>-1;return!isKidsEntree}var vm=this;vm.next=next,vm.showExtra=showExtra}angular.module("app.order-flow").controller("NextController",NextController),NextController.$inject=["entreeService","$stateParams"]}(),function(){"use strict";angular.module("app.order-flow").component("cmgStep",{templateUrl:"templates/order-flow/step.html",transclude:!0,bindings:{state:"<",step:"@"}})}(),function(){"use strict";function StepController(){}angular.module("app.order-flow").controller("StepController",StepController),StepController.$inject=[]}(),function(){"use strict";angular.module("app.order-flow").component("cmgStepSection",{controller:"StepSectionController",templateUrl:"templates/order-flow/step-section.html",transclude:!0,bindings:{itemList:"<",title:"@",selectionType:"@",showPriceDiffs:"@",hidePrices:"@",onSelect:"&",addItem:"&",subtractItem:"&"}})}(),function(){"use strict";function StepSectionController($filter,$window){function click(item,params){vm.onSelect({item:item,params:params})}function getScaleFactor(){return $window.devicePixelRatio>1?"@2x":""}function getContainerClass(item){var style="col-lg-4 col-md-4 col-sm-4 col-xs-6";return item.isNone&&(style="col-lg-4 col-md-4 col-sm-4 col-xs-12 item-none"),item.isProminent&&(style="col-lg-4 col-md-4 col-sm-4 col-xs-12 prominent"),style}function getImageClass(item){var style="img-responsive";return item.isNone&&(style="img-none"),item.isProminent&&(style+=" img-default"),style}function getItemPriceDisplay(item){if(vm.hidePrices)return"";if(item.free)return"No Charge";if(!item.Price)return"";if("true"===vm.showPriceDiffs){var minPrice=findMinPrice(vm.itemList),diff=(parseFloat(item.Price)-parseFloat(minPrice)).toFixed(2);return diff>0?"+ "+$filter("currency")(diff):""}return item.Price>0?$filter("currency")(item.Price):""}function findMinPrice(array){var minPrice=null;return angular.forEach(array,function(item){null===minPrice?minPrice=item.Price:minPrice>item.Price&&(minPrice=item.Price)}),minPrice}var vm=this;vm.click=click,vm.getContainerClass=getContainerClass,vm.getImageClass=getImageClass,vm.getItemPriceDisplay=getItemPriceDisplay,vm.getScaleFactor=getScaleFactor}angular.module("app.order-flow").controller("StepSectionController",StepSectionController),StepSectionController.$inject=["$filter","$window"]}(),function(){"use strict";function ConfirmationController(confirmationService,analyticsService,redirectService){function goToLogin(){analyticsService.fireCustomEvent("forgotPassword","confirmation","signInClick"),redirectService.isReferred()?redirectService.toReturnUrl():confirmationService.returnToLogin()}var vm=this;vm.email=null,vm.goToLogin=goToLogin}angular.module("app.password-reset").controller("ConfirmationController",ConfirmationController),ConfirmationController.$inject=["confirmationService","analyticsService","redirectService"]}(),function(){"use strict";angular.module("app.password-reset").component("passwordResetConfirmation",{templateUrl:"templates/password-reset/confirmation.html",controller:"ConfirmationController"})}(),function(){"use strict";function ConfirmationService($window,navigate){function returnToLogin(){navigate.toHome()}return{returnToLogin:returnToLogin}}angular.module("app.password-reset").factory("confirmationService",ConfirmationService),ConfirmationService.$inject=["$window","navigate"]}(),function(){"use strict";function EmailSentController($stateParams){function activate(){vm.email=$stateParams.email}var vm=this;vm.email=null,activate()}angular.module("app.password-reset").controller("EmailSentController",EmailSentController),EmailSentController.$inject=["$stateParams"]}(),function(){"use strict";angular.module("app.password-reset").component("passwordResetEmailSent",{controller:"EmailSentController",templateUrl:"templates/password-reset/email-sent.html"})}(),function(){"use strict";function EnterEmailController(enterEmailService,$stateParams,analyticsService,redirectService){function initiateReset(form){form.$valid&&(vm.loading=!0,enterEmailService.initiateReset(vm.email,vm.returnUrl).then(initiateResetSuccess,initiateResetFailure))}function cancelReset(){analyticsService.fireEvent("forgotPasswordEnterEmailCancel"),vm.isPartnerReferred?redirectService.toReturnUrl():enterEmailService.cancelReset()}function gaIsEmailValid(valid){analyticsService.fireCustomEvent("forgotPassword","submitEmailIsValid",valid.toString())}function hasValidationErrors(form){return form.$submitted&&form.$invalid&&!vm.serverErrorMessage}function initiateResetSuccess(){vm.loading=!1,vm.serverErrorMessage=null,analyticsService.fireEvent("forgotPasswordEnterEmailSuccess"),enterEmailService.goToEmailSent(vm.email)}function initiateResetFailure(response){vm.loading=!1,vm.serverErrorMessage=response.data.Message,analyticsService.fireEvent("forgotPasswordEnterEmailFailure")}var vm=this;vm.email=null,vm.serverErrorMessage=null,vm.loading=!1,vm.tokenInvalid=$stateParams.tokenInvalid,vm.isPartnerReferred=redirectService.isReferred(),vm.returnUrl=$stateParams.returnUrl,vm.initiateReset=initiateReset,vm.cancelReset=cancelReset,vm.gaIsEmailValid=gaIsEmailValid,vm.hasValidationErrors=hasValidationErrors}angular.module("app.password-reset").controller("EnterEmailController",EnterEmailController),EnterEmailController.$inject=["enterEmailService","$stateParams","analyticsService","redirectService"]}(),function(){"use strict";angular.module("app.password-reset").component("passwordResetEnterEmail",{controller:"EnterEmailController",templateUrl:"templates/password-reset/enter-email.html"})}(),function(){"use strict";function EnterEmailService(api,navigate,$window,config){function initiateReset(email,returnUrl){return api.initiatePasswordReset(email,returnUrl)}function goToEmailSent(email){navigate.toPasswordResetEmailSent(email)}function cancelReset(){$window.location.href=config.legacyOnlineOrderUrl}return{initiateReset:initiateReset,cancelReset:cancelReset,goToEmailSent:goToEmailSent}}angular.module("app.password-reset").factory("enterEmailService",EnterEmailService),EnterEmailService.$inject=["api","navigate","$window","config"]}(),function(){"use strict";function SubmitPasswordController(submitPasswordService,$stateParams){function activate(){"true"!==submitPasswordService.getValidationOverride()&&submitPasswordService.validateToken()}function resetPassword(form){form.$valid&&(vm.loading=!0,submitPasswordService.resetPassword(vm.password).then(passwordResetSuccess,passwordResetFailure))}function hasValidationErrors(form){return form.$invalid&&form.$submitted&&!vm.serverErrorMessage}function passwordResetSuccess(){vm.loading=!1,vm.serverErrorMessage=null,vm.passwordInvalid=!1,submitPasswordService.goToSuccessState(vm.returnUrl)}function passwordResetFailure(error){vm.loading=!1,vm.serverErrorMessage=error.Message,vm.passwordInvalid=!0}var vm=this;vm.password=null,vm.serverErrorMessage=null,vm.passwordInvalid=!1,vm.loading=!1,vm.returnUrl=$stateParams.returnUrl,vm.resetPassword=resetPassword,vm.hasValidationErrors=hasValidationErrors,activate()}angular.module("app.password-reset").controller("SubmitPasswordController",SubmitPasswordController),SubmitPasswordController.$inject=["submitPasswordService","$stateParams"]}(),function(){"use strict";angular.module("app.password-reset").component("passwordResetSubmitPassword",{controller:"SubmitPasswordController",templateUrl:"templates/password-reset/submit-password.html"})}(),function(){"use strict";function SubmitPasswordService(api,navigate,$location,analyticsService,$q){function resetPassword(password){var token=getResetToken();return api.resetPassword(token,password).then(passwordResetSuccess,passwordResetFailure)}function getResetToken(){return $location.search().id}function getValidationOverride(){return $location.search().ignoreValidation}function validateToken(){var token=getResetToken();return api.getPasswordResetInfo(token).then(function(){},validateTokenFailure)}function goToSuccessState(returnUrl){navigate.toPasswordResetConfirmation(returnUrl)}function goToEnterEmail(){analyticsService.fireCustomEvent("forgotPassword","submitPassword","invalidToken"),navigate.toPasswordResetEnterEmail(!0)}function passwordResetSuccess(response){return analyticsService.fireCustomEvent("forgotPassword","submitPassword","success"),response.data}function passwordResetFailure(response){analyticsService.fireCustomEvent("forgotPassword","submitPassword","failure");var error=response.data;
return error&&error.Type&&"InvalidPasswordResetToken"===error.Type&&goToEnterEmail(),$q.reject(error)}function validateTokenFailure(){goToEnterEmail()}return{resetPassword:resetPassword,getResetToken:getResetToken,goToSuccessState:goToSuccessState,validateToken:validateToken,goToEnterEmail:goToEnterEmail,getValidationOverride:getValidationOverride}}angular.module("app.password-reset").factory("submitPasswordService",SubmitPasswordService),SubmitPasswordService.$inject=["api","navigate","$location","analyticsService","$q"]}(),function(){"use strict";angular.module("app.widgets").component("cmgArrowButton",{templateUrl:"templates/widgets/arrow-button.html",transclude:!0,bindings:{small:"<",disabled:"<",click:"&",block:"<"}})}(),function(){"use strict";function autoFocus($timeout){function postLink(scope,element,attrs){function doFocus(condition){condition&&(timeoutPromise=$timeout(function(){},0))}var watchRes=null,timeoutPromise=null;attrs.autoFocus&&(watchRes=scope.$watch(attrs.autoFocus,doFocus)),element.on("$destroy",function(){watchRes&&watchRes(),timeoutPromise&&$timeout.cancel(timeoutPromise)})}return{link:{post:postLink},restrict:"A"}}angular.module("app.widgets").directive("autoFocus",autoFocus),autoFocus.$inject=["$timeout"]}(),function(){"use strict";angular.module("app.widgets").component("cmgBackArrow",{templateUrl:"templates/widgets/back-arrow.html",controller:"BackArrowController"})}(),function(){"use strict";function BackArrowController($window,$stateParams,analyticsService){function back(){analyticsService.fireCustomEvent("mobile-meal","back-arrow",$stateParams.type+" - "+$stateParams.step),$window.history.back()}var vm=this;vm.back=back}angular.module("app.widgets").controller("BackArrowController",BackArrowController),BackArrowController.$inject=["$window","$stateParams","analyticsService"]}(),function(){"use strict";angular.module("app.widgets").component("cmgConfirmationModal",{templateUrl:"templates/widgets/confirmation-modal.html",controller:"ConfirmationModalController",bindings:{}})}(),function(){"use strict";function ConfirmationModalController(confirmationModal){function showModal(){return vm.options.show}function closeModal(){vm.options.onClose&&vm.options.onClose(),cancel()}function cancel(){vm.options.show=!1,vm.options.onCancel&&vm.options.onCancel()}function confirm(){vm.options.show=!1,vm.options.onConfirm&&vm.options.onConfirm()}function preventClose(){return Boolean(vm.options.preventClose)}function showCancelButton(){return angular.isDefined(vm.options.cancelButtonText)}var vm=this;vm.showModal=showModal,vm.cancel=cancel,vm.closeModal=closeModal,vm.confirm=confirm,vm.preventClose=preventClose,vm.showCancelButton=showCancelButton,vm.options=confirmationModal.getOptions()}angular.module("app.widgets").controller("ConfirmationModalController",ConfirmationModalController),ConfirmationModalController.$inject=["confirmationModal"]}(),function(){"use strict";function ConfirmationModal(){function show(params){angular.copy(params,options),options.show=!0}function getOptions(){return options}var options={},service={show:show,getOptions:getOptions};return service}angular.module("app.widgets").factory("confirmationModal",ConfirmationModal)}(),function(){"use strict";angular.module("app.widgets").component("cmgCreditCardInput",{templateUrl:"templates/widgets/credit-card-input.html",controller:"CreditCardInputController",transclude:!0,bindings:{card:"=",error:"<",allowSave:"<"}})}(),function(){"use strict";function CreditCardInputController(){function getcard(obj){var card={};if(angular.isDefined(obj)&&null!==obj){for(var prop in obj)obj.hasOwnProperty(prop)&&angular.isDefined(obj[prop])&&null!==obj[prop]&&obj[prop].cvv&&(card=obj[prop]);card==={}&&obj.$parent&&(card=getcard(obj.$parent))}return card}var vm=this;vm.getcard=getcard,vm.$onInit=function(){vm.error=!1}}angular.module("app.widgets").controller("CreditCardInputController",CreditCardInputController),CreditCardInputController.$inject=[]}(),function(){"use strict";angular.module("app.widgets").component("customizationButtonGroup",{templateUrl:"templates/widgets/customization-button-group.html",controller:"customizationButtonGroupController",bindings:{item:"<",customizations:"<",onSelect:"&",description:"<"}})}(),function(){"use strict";function customizationButtonGroupController(){function select(item){vm.onSelect({type:item,selected:!0})}function isSelected(selection){if(angular.isDefined(vm.item.customization)){var res=vm.item.customization===selection;return res}return!1}var vm=this;vm.select=select,vm.isSelected=isSelected,vm.activeButton=null}angular.module("app.widgets").controller("customizationButtonGroupController",customizationButtonGroupController)}(),function(){"use strict";function customizationModal(customizationsModal){function link(scope,element,attrs,controller){scope.$watch(function(){return customizationsModal.get()},function(newVal){controller.showModal=newVal})}function customizationModalController(){function closeModal(){customizationsModal.hide()}var vm=this;vm.closeModal=closeModal,vm.showModal=!1}var directive={link:link,restrict:"A",templateUrl:"templates/widgets/customization-modal.html",controllerAs:"$ctrl",bindToController:!0,controller:customizationModalController,scope:{}};return directive}angular.module("app.widgets").directive("customizationModal",customizationModal),customizationModal.$inject=["customizationsModal"]}(),function(){"use strict";function customizationsModal(){function show(){return _show=!0}function hide(){return _show=!1}function get(){return _show}var _show=!1,service={show:show,hide:hide,get:get};return service}angular.module("app.widgets").factory("customizationsModal",customizationsModal)}(),function(){"use strict";function debounceClick($timeout){function link(scope,element){element.bind("click",function(){element[0].classList&&(element[0].classList.add("debounceing"),$timeout(function(){element[0].classList.remove("debounceing")},3e3))})}var directive={restrict:"A",link:link};return directive}angular.module("app.widgets").directive("debounceClick",debounceClick),debounceClick.$inject=["$timeout"]}(),function(){"use strict";angular.module("app.widgets").component("cmgEmailInput",{templateUrl:"templates/widgets/email-input.html",controller:"EmailInputController",bindings:{error:"<",email:"=",placeholder:"@"}})}(),function(){"use strict";function EmailInputController(customer){var vm=this;vm.emailRegex=customer.emailRegex}angular.module("app.widgets").controller("EmailInputController",EmailInputController),EmailInputController.$inject=["customer"]}(),function(){"use strict";angular.module("app.widgets").component("entreeDetails",{templateUrl:"templates/widgets/entree-details.html",controller:"entreeDetailsController",bindings:{meal:"<"}})}(),function(){"use strict";function EntreeDetailsController(){function getItems(){return _entreeDetails}function renderPortion(item){if(item&&item.portion)switch(item.portion){case"double":return"1x";case"half":return"½";case"single":return"";case"extra":return"2x"}}var vm=this;vm.renderPortion=renderPortion,vm.getItems=getItems;var _entreeDetails;vm.$onInit=function(){_entreeDetails=[],vm.meal.Fillings&&(_entreeDetails=_entreeDetails.concat(vm.meal.Fillings)),vm.meal.Rice&&(_entreeDetails=_entreeDetails.concat(vm.meal.Rice)),vm.meal.Beans&&(_entreeDetails=_entreeDetails.concat(vm.meal.Beans)),vm.meal.Toppings&&(_entreeDetails=_entreeDetails.concat(vm.meal.Toppings))}}angular.module("app.widgets").controller("entreeDetailsController",EntreeDetailsController),EntreeDetailsController.inject=[""]}(),function(){"use strict";angular.module("app.widgets").component("entreeHeading",{templateUrl:"templates/widgets/entree-heading.html",controller:"entreeHeadingController",bindings:{meal:"<",entreePrice:"<"}})}(),function(){"use strict";function EntreeHeadingController(){function getQuantity(){return vm.meal.quantity?vm.meal.quantity:1}function getName(){if(!vm.meal||!vm.meal.Type)return null;switch(vm.meal.Type){case"SidesDrinks":return"sides & drinks";case"KidsQuesadilla":return"Kid's Quesadilla";case"KidsBuildYourOwn":return"Kid's Build Your Own";case"BurritoBowl":return fillingsPrefix(vm.meal)+" Bowl";case"Tacos":return vm.meal.Fillings[0].SummaryName+" Tacos";case"Burrito":return fillingsPrefix(vm.meal)+" Burrito";case"Salad":return fillingsPrefix(vm.meal)+" Salad";default:return vm.meal.Name}}function fillingsPrefix(){if(vm.meal&&vm.meal.Fillings){if(1===vm.meal.Fillings.length)return vm.meal.Fillings[0].SummaryName;if(2===vm.meal.Fillings.length)return vm.meal.Fillings[0].SummaryName+" & "+vm.meal.Fillings[1].SummaryName}return""}var vm=this;vm.getName=getName,vm.getQuantity=getQuantity}angular.module("app.widgets").controller("entreeHeadingController",EntreeHeadingController)}(),function(){angular.module("app.widgets").component("cmgEpop",{templateUrl:"templates/widgets/epop.html",controller:"ePopController"})}(),function(){function ePopController(restaurant,$scope){function getEPops(){restaurant.getEPops().then(function(ePops){vm.ePops=ePops,ePops.length&&(vm.showEPop=!0)})}var vm=this;vm.ePops=[],vm.showEPop=!1,vm.$onInit=function(){getEPops(),restaurant.onChange($scope,getEPops)}}angular.module("app.widgets").controller("ePopController",ePopController),ePopController.$inject=["restaurant","$scope"]}(),function(){"use strict";angular.module("app.widgets").component("footer",{templateUrl:"templates/widgets/footer.html"})}(),function(){"use strict";angular.module("app.widgets").component("cmgGiftCardInput",{templateUrl:"templates/widgets/gift-card-input.html",controller:"GiftCardInputController",bindings:{card:"=",widgetId:"=",error:"<"}})}(),function(){"use strict";function GiftCardInputController($window,config,$scope){var vm=this;vm.ele=null,$window.recaptchaCallback=function(){vm.widgetId=$window.grecaptcha.render("grecaptcha",{sitekey:config.recaptchaKey,callback:$window.recaptchaSuccess})},$window.recaptchaSuccess=function(response){vm.card.recaptcha=response,$scope.$apply()},vm.$onInit=function(){vm.ele=document.createElement("script"),vm.ele.type="text/javascript",vm.ele.src="https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit",document.body.appendChild(vm.ele)},vm.$onDestroy=function(){document.body.removeChild(vm.ele),vm.ele=null}}angular.module("app.widgets").controller("GiftCardInputController",GiftCardInputController),GiftCardInputController.$inject=["$window","config","$scope"]}(),function(){"use strict";angular.module("app.widgets").component("header",{templateUrl:"templates/widgets/header.html",controller:"HeaderController",bindings:{optOut:"<"}})}(),function(){"use strict";function HeaderController(analyticsService,navigate,$window,customer,localStorageService,orderService,$state,states,bag,$scope,redirectService,$timeout,confirmationModal,header,survey,config,accountDrawer,event){function showAccount(){return accountDrawer.isOpen()}function toggleBag(){bag.isLocked()||(bag.isOpen()?bag.close():bag.open(!1))}function isOptOut(){return!orderService.isGroupOrder()&&vm.optOut}function hideOptOut(){vm.optOut=!1,header.showOptOut=!1}function getOrdersCount(){return orderService.getIndividualMeals().length+orderService.getFinishedGroupOrderMeals().length}function toggleAccount(){bag.isLocked()||(accountDrawer.toggle(),bag.close())}function home(){analyticsService.fireCustomEvent("header","home-click",$window.document.title),navigate.toHome()}function closeAll(){accountDrawer.close(),bag.isLocked()||bag.close()}function showHeadAndBag(){return $state.current.name.indexOf("invitee")===-1&&"root.checkout"!==$state.current.name&&"root.order-confirmation"!==$state.current.name&&"group-host-home"!==$state.current.name}var vm=this;vm.home=home,vm.order={},vm.showHeadAndBag=showHeadAndBag,vm.closeAll=closeAll,vm.customer=null,vm.showBag=!1,vm.bagLocked=!1,vm.isPartnerReferred=!1,vm.invited=!1,vm.showGreeting=!1,vm.lastCheck=null,vm.showAccount=showAccount,vm.getOrdersCount=getOrdersCount,vm.isOptOut=isOptOut,vm.hideOptOut=hideOptOut,vm.toggleBag=toggleBag,vm.toggleAccount=toggleAccount,vm.$onInit=function(){function bagEventHandler(scope,data){"open"===data&&(accountDrawer.close(),vm.showBag=!0),"close"===data&&(vm.showBag=!1)}accountDrawer.close(),orderService.getOrder().then(function(order){vm.order=order}),vm.isPartnerReferred=redirectService.isReferred(),customer.onLoginSuccess($scope,function(){$state.current.name!==states.CHECKOUT&&customer.get().then(function(customer){vm.customer=customer,$timeout(function(){vm.showGreeting=!1},5e3),vm.showGreeting=!0})}),header.showOptOut===!1&&(vm.optOut=!1),vm.showBag=bag.isOpen(),event.on("bag",bagEventHandler,$scope)}}angular.module("app.order-flow").controller("HeaderController",HeaderController),HeaderController.$inject=["analyticsService","navigate","$window","customer","localStorageService","orderService","$state","states","bag","$scope","redirectService","$timeout","confirmationModal","header","survey","config","accountDrawer","event"]}(),function(){"use strict";function header(){var showOptOut=!0;return{showOptOut:showOptOut}}angular.module("app.order-flow").factory("header",header)}(),function(){"use strict";function infiniteScroll(){function link(scope,elem){function doWork(){base.scrollTop+base.offsetHeight+5>=base.scrollHeight&&scope.infiniteScroll()}var base=elem[0];elem.bind("scroll",_.throttle(doWork,128))}return{restrict:"A",link:link,scope:{infiniteScroll:"&"}}}angular.module("app.widgets").directive("infiniteScroll",infiniteScroll),infiniteScroll.$inject=[]}(),function(){"use strict";angular.module("app.widgets").component("loader",{templateUrl:"templates/widgets/loader.html"})}(),function(){"use strict";angular.module("app.widgets").component("cmgModal",{templateUrl:"templates/widgets/modal.html",bindings:{title:"@",show:"<",onClose:"&",showX:"<",onBack:"&",onPagginate:"&"},transclude:{header:"?modalHeader",body:"?modalBody",footer:"?modalFooter"},controller:"ModalController"})}(),function(){"use strict";function ModalController(){function closeModal(){return vm.onClose()}function pagginate(){vm.onPagginate()}var vm=this;vm.closeModal=closeModal,vm.pagginate=pagginate}angular.module("app.widgets").controller("ModalController",ModalController)}(),function(){"use strict";function modalInit(){function link(scope,element){headerElement=element.find("modal-header"),headerElement&&headerElement.length>0&&(_watch=scope.$watch(function(){return element.find("modal-header")[0].getBoundingClientRect().height},function(val){val>0&&updateElements(scope,element)})),footerElement=element.find("modal-footer"),footerElement&&footerElement.length>0&&scope.$watch(function(){return element.find("modal-footer")[0].getBoundingClientRect().height},function(val){val>0&&updateElements(scope,element)}),element.on("$destroy",function(){headingElement&&(headingElement=null),headerElement&&(headerElement=null),footerElement&&(footerElement=null),bodyElement&&(bodyElement=null),_watch&&_watch()}),updateElements(scope,element)}function updateElements(scope,element){var headingHeight=0,headerHeight=0,footerHeight=0;headingElement=element[0].getElementsByClassName("modal-heading"),headerElement=element.find("modal-header"),bodyElement=element.find("modal-body"),footerElement=element.find("modal-footer"),headerElement.length>0&&(headerHeight=headerElement[0].getBoundingClientRect().height),headingElement.length>0&&(headingHeight=headingElement[0].getBoundingClientRect().height),footerElement.length>0&&(footerHeight=footerElement[0].getBoundingClientRect().height);var offSet=headerHeight+headingHeight;bodyElement.parent().css({top:offSet+"px"}),bodyElement.parent().css({height:"calc(100% - "+(offSet+footerHeight)+"px)"})}var headingElement,headerElement,footerElement,bodyElement,_watch,directive={restrict:"A",link:link};return directive}angular.module("app.widgets").directive("modalInit",modalInit)}(),function(){"use strict";function noScroll(noscroll){function link(scope,element,attrs){function disableScroll(newVal){if(""!==element[0].id&&noscroll.isOwner(element[0].id)){noscroll.id(element[0].id);var rootElement=angular.element(document.querySelector("html")),bodyElement=angular.element(document.querySelector("body"));newVal===!0?(rootElement.css({overflowY:"hidden"}),bodyElement.addClass("stop-scroll")):(rootElement.css({overflowY:"auto"}),bodyElement.removeClass("stop-scroll"),noscroll.id(null))}}attrs.noScroll&&scope.$watch(attrs.noScroll,disableScroll)}var directive={link:link,restrict:"A"};return directive}angular.module("app.widgets").directive("noScroll",noScroll),noScroll.$inject=["noscroll"]}(),function(){"use strict";function noscroll(){function id(elementId){_id=elementId}function get(){return _id}function isOwner(id){return id===_id||null==_id}var _id=null;return{id:id,isOwner:isOwner,get:get}}angular.module("app.widgets").factory("noscroll",noscroll)}(),function(){"use strict";angular.module("app.widgets").component("passwordInput",{bindings:{password:"=?password",state:"=?state",error:"=",autocomplete:"@",enableRules:"@",strengthScore:"=?strengthScore",onScoreChange:"&",placeholderText:"@"},transclude:!0,controller:"PasswordInputController",templateUrl:"templates/widgets/password-input.html"})}(),function(){"use strict";function PasswordInputController($scope,passwordInputService){function change(){if(vm.enableRules){if(angular.isUndefined(vm.password)||null===vm.password)return void(vm.state="wrong");null!=passwordRules&&evaluatePassword(passwordRules)}}function showPassword(){"show"===vm.showPasswordText?(vm.type="text",vm.showPasswordText="hide"):"hide"===vm.showPasswordText&&(vm.type="password",vm.showPasswordText="show")}function getPasswordCriteriaSuccess(rules){passwordRules=rules,evaluatePassword(rules)}function evaluatePassword(rules){vm.strengthScore=passwordInputService.evaluatePassword(rules,vm.password).score,vm.onScoreChange({value:vm.strengthScore})}var vm=this,passwordRules=null;vm.scoreValue=0,vm.type="password",vm.togglePasword=!1,vm.state="wrong",vm.enableRules=!1,vm.passwordRegex=/(?:((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[^a-zA-Z0-9]))|((?=.*[A-Z])(?=.*[^a-zA-Z0-9]))|((?=.*[0-9])(?=.*[^a-zA-Z0-9])))(?:^[^\n\t\r\v\f]{8,50}$)(?![\r\n])/,vm.showPasswordText="show",vm.autocomplete="on",vm.showPassword=showPassword,vm.change=change,vm.$onInit=function(){passwordInputService.getPasswordCriteria().then(getPasswordCriteriaSuccess),$scope.$watch(function(){return vm.password},function(){change()})}}angular.module("app.widgets").controller("PasswordInputController",PasswordInputController),PasswordInputController.$inject=["$scope","passwordInputService"]}(),function(){"use strict";function PasswordInputService(api,$q){function getEntropy(phrase){for(var L,uniqueSymbols=[],N=0,charSet=[{regex:/[a-z]/,value:26},{regex:/[A-Z]/,value:26},{regex:/[0-9]/,value:10},{regex:/[^a-zA-Z0-9]/,value:32}],i=0;i<charSet.length;i++){var set=charSet[i];set.regex.test(phrase)&&(N+=set.value)}for(var c=0;c<phrase.length;c++)uniqueSymbols.indexOf(phrase[c])===-1&&uniqueSymbols.push(phrase[c]);return L=uniqueSymbols.length,Math.round(Math.log(Math.pow(N,L))/Math.log(2))}function evaluatePassword(rules,password){var regex,match,testSuccess,score=1,scoreSuccess=!0,success=!0,entropy=0;if(!password)return{pass:!1,score:0,maxScore:rules.length};if(entropy=getEntropy(password),rules.length<1)success=!1;else for(var r=0;r<rules.length;r++)regex=new RegExp(rules[r].Pattern,"g"),match=regex.exec(password),testSuccess=null!==match,success&&rules[r].Enforced&&!testSuccess&&(success=!1),scoreSuccess&&(testSuccess&&(testSuccess=entropy>=parseInt(rules[r].Entropy)),testSuccess?score=rules[r].Grade:(score=rules[r].Grade-1,scoreSuccess=!1));return{pass:success,score:score,maxScore:rules.length}}function getPasswordCriteria(){return rules?$q.when(rules):api.getPasswordCriteria().then(function(response){return rules=response.data,rules.splice(2,0,{Description:"At least 32 bit entropy",Enforced:!1,Entropy:48,Grade:3,Pattern:".+"}),rules[3].Grade=4,rules})}var rules=null;return{getPasswordCriteria:getPasswordCriteria,evaluatePassword:evaluatePassword}}angular.module("app.widgets").factory("passwordInputService",PasswordInputService),PasswordInputService.$inject=["api","$q"]}(),function(){"use strict";angular.module("app.widgets").component("passwordInputIndicator",{bindings:{password:"=?password",placeholderText:"@",autocomplete:"@"},controller:"PasswordInputIndicatorController",templateUrl:"templates/widgets/password-input-indicator.html"})}(),function(){"use strict";function PasswordInputController(){function scoreChange(value){vm.strengthValue=value}var vm=this;vm.strengthValue=0,vm.scoreChange=scoreChange}angular.module("app.widgets").controller("PasswordInputIndicatorController",PasswordInputController)}(),function(){"use strict";angular.module("app.widgets").component("cmgPaymentMethod",{templateUrl:"templates/widgets/payment-method.html",bindings:{type:"@",data:"<",isNew:"<",select:"&",remove:"&"}})}(),function(){"use strict";angular.module("app.widgets").component("cmgRestaurant",{templateUrl:"templates/widgets/restaurant.html",controller:"RestaurantController",bindings:{restaurant:"<",hideAddress:"<",hideDistance:"<",hideDetails:"<",hideTitle:"<"}})}(),function(){"use strict";function RestaurantController($scope,restaurant,$window){function getStore(){restaurant.get().then(function(data){vm.restaurant=data})}function getRestaurantString(){if(!vm.restaurant)return"";var addressArray=[];return vm.restaurant.Address&&vm.restaurant.Address.trim().length>0&&addressArray.push(vm.restaurant.Address),vm.restaurant.Address2&&vm.restaurant.Address2.trim().length>0&&addressArray.push(vm.restaurant.Address2),vm.restaurant.City&&vm.restaurant.City.trim().length>0&&addressArray.push("\n"+vm.restaurant.City+","),vm.restaurant.State&&vm.restaurant.Zip&&addressArray.push(vm.restaurant.State+" "+vm.restaurant.Zip),addressArray.join(" ")}function getCateringUrl(){return $window.location.origin+"/catering"}var vm=this;vm.getRestaurantString=getRestaurantString,vm.getCateringUrl=getCateringUrl,vm.fromSearch=!0,vm.$onInit=function(){vm.fromSearch=!0,vm.restaurant||(vm.fromSearch=!1,getStore(),restaurant.onChange($scope,getStore))}}angular.module("app.widgets").controller("RestaurantController",RestaurantController),RestaurantController.$inject=["$scope","restaurant","$window"]}(),function(){"use strict";angular.module("app.widgets").component("cmgRestaurantSearch",{templateUrl:"templates/widgets/restaurant-search.html",controller:"RestaurantSearchController",bindings:{text:"@",show:"=",toggle:"&",address:"@",hideX:"<",search:"="}})}(),function(){"use strict";function RestaurantSearchController($scope,$timeout,api,map,restaurant){function search(){vm.startIndex=1,vm.locations=[],vm.lastSearch="",doSearch()}function select(location){restaurant.set(location.Id),vm.show=!1,resetSearch(location)}function searchMore(){vm.show&&vm.listView&&(vm.startIndex=vm.locations.length,doSearch(!1))}function showBigMap(){vm.listView=!1,$timeout(function(){return vm.map?(google.maps.event.trigger(vm.map,"resize"),vm.map&&vm.currentLocation&&vm.map.setCenter({lat:vm.currentLocation.Latitude,lng:vm.currentLocation.Longitude}),vm.startIndex=0,vm.locations=[],doSearch(),void $scope.$apply()):(vm.mapElement=document.getElementById("bigmap"),vm.map=map.get(vm.mapElement,37.09024,-95.712891),vm.map.setZoom(3),void google.maps.event.trigger(vm.map,"resize"))},500)}function prev(){var index=vm.locations.findIndex(function(item){return item.Id===vm.currentLocation.Id});index--,index===-1&&(index=vm.locations.length-1),vm.currentLocation=vm.locations[index]}function next(){var index=vm.locations.findIndex(function(item){return item.Id===vm.currentLocation.Id});index++,index===vm.locations.length&&(index=0),vm.currentLocation=vm.locations[index]}function closeModal(){vm.show=!1}function resetSearch(location){location&&(vm.restaurant=location),vm.modals=angular.element(document.querySelectorAll(".modal-content"));for(var m=0;m<vm.modals.length;m++)vm.modals[m].scrollTop=0}function carouselToRestaurant(restaurantLocation){var index=vm.locations.findIndex(function(item){return item.Id===restaurantLocation.Id});vm.currentLocation=vm.locations[index],$scope.$apply()}function doSearch(clearSearch){vm.error=!1,(angular.isUndefined(clearSearch)||clearSearch===!0)&&(vm.locations.forEach(function(item){item.marker.setMap(null)}),vm.locations=[]);var thisSearch=vm.address+","+vm.radius+","+vm.startIndex+","+vm.returnCount;vm.searching||vm.lastSearch===thisSearch||(vm.searching=!0,vm.lastSearch=thisSearch,vm.loading=!0,api.restaurantsSearch(vm.address,vm.radius,vm.startIndex,vm.returnCount).then(function(data){data.data.length<1&&(vm.error=!0,vm.carouselIndex=0,vm.locations=[]),vm.mapElement=document.getElementById("bigmap"),vm.map=map.get(vm.mapElement,0,0);var parentNode=vm.mapElement.parentNode;parentNode.replaceChild(map.getmapdiv(),vm.mapElement),data.data.forEach(function(restaurantLocation){if(vm.locations.indexOf(restaurantLocation)===-1){restaurantLocation.marker=new google.maps.Marker({position:{lat:restaurantLocation.Latitude,lng:restaurantLocation.Longitude},map:vm.map,zIndex:1,icon:{url:"https://drpma142ptgxf.cloudfront.net/assets/location-search-marker.png",scaledSize:new google.maps.Size(16,25)}});var listener=google.maps.event.addListener(restaurantLocation.marker,"click",function(){carouselToRestaurant(restaurantLocation)});restaurantLocation.clickEventListener=listener,vm.locations.push(restaurantLocation)}}),vm.currentLocation=vm.locations[0],vm.loading=!1,vm.map&&vm.currentLocation&&(vm.map.setZoom(15),vm.map.setCenter({lat:vm.currentLocation.Latitude,lng:vm.currentLocation.Longitude})),$timeout(function(){vm.searching=!1},500)},function(){vm.error=!0,vm.searching=!1}))}var locationWatch=null,vm=this;vm.restaurant={},vm.address="",vm.radius=300,vm.startIndex=1,vm.returnCount=10,vm.locations=[],vm.searching=!1,vm.lastSearch="",vm.loading=!1,vm.listView=!0,vm.carouselIndex=1,vm.error=!1,vm.next=next,vm.prev=prev,vm.modals=null,vm.closeModal=closeModal,vm.search=search,vm.select=select,vm.searchMore=searchMore,vm.showBigMap=showBigMap,vm.$onInit=function(){locationWatch=$scope.$watch(function(){return vm.currentLocation},function(newVal,oldVal){if(newVal&&vm.map){if(oldVal){var oldMarkerIndex=vm.locations.findIndex(function(item){return item.Id===oldVal.Id});oldMarkerIndex!==-1&&(vm.locations[oldMarkerIndex].marker.setMap(null),oldVal.marker.icon={url:"https://drpma142ptgxf.cloudfront.net/assets/location-search-marker.png",scaledSize:new google.maps.Size(16,25)},oldVal.marker.zIndex=1,oldVal.marker.setMap(vm.map))}var newMarkerIndex=vm.locations.findIndex(function(item){return item.Id===newVal.Id});vm.locations[newMarkerIndex].marker.setMap(null),newVal.marker.icon={url:"https://drpma142ptgxf.cloudfront.net/assets/location-search-marker-2x.png",scaledSize:new google.maps.Size(27,40)},newVal.marker.zIndex=1,newVal.marker.setMap(vm.map),vm.map.panTo({lat:newVal.Latitude,lng:newVal.Longitude})}})},vm.$postLink=function(){restaurant.get().then(function(data){data&&resetSearch(data)})},vm.$onDestroy=function(){locationWatch&&locationWatch()}}angular.module("app.widgets").controller("RestaurantSearchController",RestaurantSearchController),RestaurantSearchController.$inject=["$scope","$timeout","api","map","restaurant"]}(),function(){"use strict";function map(){function get(mapElement,latitude,longitude){return null==_map&&(_map=new google.maps.Map(mapElement,{zoom:15,center:{lat:latitude,lng:longitude}})),mapdiv(mapElement),_map}function mapdiv(mapdiv){_mapdiv||(_mapdiv=mapdiv)}function getmapdiv(){return _mapdiv}var _map=null,_mapdiv=null;return{get:get,getmapdiv:getmapdiv}}angular.module("app.widgets").factory("map",map)}();!function(){"use strict";function scrollHeightResize(){function link(scope,elem,attrs){var e=elem[0];e&&scope.$watch(attrs.ngModel,function(){e.style.overflowY="hidden",e.style.height="auto",e.style.height=e.scrollHeight+"px"})}var directive={restrict:"A",link:link};return directive}angular.module("app.widgets").directive("cmgScrollHeightResize",scrollHeightResize),scrollHeightResize.$inject=[]}();!function(){"use strict";function autoScroll(event,$document){function link(scope){function doScroll(event,data){var targetElement=angular.element(document.getElementById(data));$document.scrollToElementAnimated(targetElement,100)}event.on("scroll-to",doScroll,scope)}var directive={link:link,restrict:"A"};return directive}angular.module("app.widgets").directive("autoScroll",autoScroll),autoScroll.$inject=["event","$document"]}(),function(){"use strict";function scrollTo($log,$document){function link(scope,element,attrs){element.on("click",function(){var targetElement=angular.element(document.getElementById(attrs.scrollTo));$document.scrollToElementAnimated(targetElement,100)}),element.on("$destroy",function(){element.off("click")})}var directive={link:link,restrict:"A"};return directive}angular.module("app.widgets").directive("scrollTo",scrollTo),scrollTo.$inject=["$log","$document"]}(),function(){"use strict";angular.module("app.widgets").component("cmgTabBar",{templateUrl:"templates/widgets/tab-bar.html",controller:"tabBarController",bindings:{tabs:"<"}})}(),function(){"use strict";function TabBarController(){function tabClick(tab){vm.selectedTab=tab,tab.click()}var vm=this;vm.tabClick=tabClick,vm.selectedTab={},vm.$onInit=function(){vm.selectedTab=vm.tabs[0]}}angular.module("app.widgets").controller("tabBarController",TabBarController)}(),function(){"use strict";angular.module("app.order-flow").component("mealProgressItem",{templateUrl:"templates/order-flow/meal-progress-item.html",bindings:{items:"<",title:"@",disabled:"<"}})}(),function(){"use strict";function AccountDrawer(){function open(){_isOpen=!0}function close(){_isOpen=!1}function isOpen(){return _isOpen}function toggle(){_isOpen=!_isOpen}var _isOpen=!1;return{open:open,close:close,isOpen:isOpen,toggle:toggle}}angular.module("app.services").factory("accountDrawer",AccountDrawer)}(),function(){"use strict";angular.module("app.widgets").component("cmgHeadAccount",{controller:"HeadAccountController",bindings:{show:"<",name:"="},templateUrl:"templates/widgets/account.html"})}(),function(){"use strict";function HeadAccountController(navigate,customer,error,$scope,restaurant,accountDrawer){function getCustomer(){customer.get().then(function(customer){vm.name=customer.FirstName,vm.showLinks=!0},function(){vm.name="",vm.showLinks=!1})}function signIn(){vm.customer=customer.login({username:vm.email,password:vm.password,persist:vm.rememberMe}).then(function(){accountDrawer.close(),getCustomer()},function(){badCredentials()})}function logout(){customer.logout()}function createAccount(){navigate.toRegisterAccount()}function toFavoritesRecents(){navigate.toFavoritesRecents()}function forgotPassword(){navigate.toPasswordResetEnterEmail()}function accountInfo(){navigate.toEditAccount()}function toAccountPayment(){navigate.toAccountPayment()}function hide(){accountDrawer.close()}function badCredentials(){vm.password="",vm.error=!0,accountDrawer.open()}function getStore(){restaurant.get().then(function(store){vm.store=store})}var vm=this;vm.email="",vm.password="",vm.rememberMe=!1,vm.showLinks=!1,vm.error=!1,vm.name="",vm.store=null,vm.signIn=signIn,vm.createAccount=createAccount,vm.forgotPassword=forgotPassword,vm.logout=logout,vm.accountInfo=accountInfo,vm.toFavoritesRecents=toFavoritesRecents,vm.toAccountPayment=toAccountPayment,vm.hide=hide,vm.$onInit=function(){customer.isAuthenticated()?getCustomer():customer.onLoginSuccess($scope,getCustomer),restaurant.onChange($scope,getStore),getStore()}}angular.module("app.widgets").controller("HeadAccountController",HeadAccountController),HeadAccountController.$inject=["navigate","customer","error","$scope","restaurant","accountDrawer"]}(),function(){"use strict";
angular.module("app.widgets").component("cmgPasswordStrengthIndicator",{bindings:{state:"<",bars:"<",value:"<"},controller:"cmgPasswordStrengthIndicatorController",templateUrl:"templates/widgets/cmg-password-strength-indicator.html"})}(),function(){"use strict";function CmgPasswordStrengthIndicatorController(){var vm=this;vm.barStates=[],vm.mBars=[],vm.$onChanges=function(changesObj){if(changesObj.value){var newValue=changesObj.value.currentValue;vm.stateText="Password Strength",vm.barStates=vm.barStates.map(function(){return"bar-inactive"});for(var i=0;i<newValue-1;i++)vm.barStates[i]="bar-active";switch(newValue){case 2:vm.stateText="Password Strength: Mild";break;case 3:vm.stateText="Password Strength: Medium";break;case 4:vm.stateText="Password Strength: Hot";break;default:vm.stateText="Password Strength"}}};for(var i=0;i<vm.bars;i++)vm.mBars.push(i)}angular.module("app.widgets").controller("cmgPasswordStrengthIndicatorController",CmgPasswordStrengthIndicatorController),CmgPasswordStrengthIndicatorController.$inject=[]}();
//# sourceMappingURL=app.js.map
