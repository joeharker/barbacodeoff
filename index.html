<!DOCTYPE html>
<html lang="en">
<head>
	<title>Chipotle</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<meta name="format-detection" content="telephone=no" />
	<meta name="msapplication-tap-highlight" content="no" />
	<link rel="shortcut icon" href="favicon.ico?">
	<link href="debug.css" rel="stylesheet" />
	<style>
		#logo {
			max-width: 100%;
			max-height: 100vh;
		}
		.flex-container {
			height: 62vh;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		.center-row {
			width: 100%;
		}
		.center-item {
			text-align: center;
		}
	</style>
	<script src="errorService.js"></script>
	<script src="cordova.js"></script>
</head>
<body>
	<div id="debug">
		<!-- can remove for prod -->
		<a onclick="document.getElementById('debug').style.display = 'none';">[X]</a>
		<script>document.getElementById('debug').style.display = 'none';</script>
	</div>
	<div class="flex-container">
		<div class="center-row">
			<div class="center-item">
				<img id="logo" src="res/logo.svg" />
			</div>
		</div>
	</div>
	<script type="text/javascript">
			var inAppBrowserRef;

			function onInAppBrowserLoadError(params) {
				errorService.log(['InAppBrowser error', params]);
			}

			function onCacheComplete(params) {
				errorService.log(['onCacheComplete', params]);
			}

			function onInAppBrowserLoadStop() {
				errorService.log('onInAppBrowserLoadStop');
				if (inAppBrowserRef != undefined) {
					inAppBrowserRef.show();

					//attempt cache of images
					inAppBrowserRef.executeScript({ file: 'cache.js', onCacheComplete });
				}
			}

			function onInAppBrowserExit() {
				//if they exit too far lets get them back into the InAppBrowser
				onDeviceReady();
			}

			function onDeviceReady() {
				if (typeof cordova !== 'undefined') {
					inAppBrowserRef = cordova.InAppBrowser.open('https://order.chipotle.com/', '_self', 'location=no,hidden=yes,clearcache=no,clearsessioncache=no');
					inAppBrowserRef.addEventListener('loaderror', onInAppBrowserLoadError);
					inAppBrowserRef.addEventListener('loadstop', onInAppBrowserLoadStop);
					inAppBrowserRef.addEventListener('exit', onInAppBrowserExit);
				}
			}

			//cordova is ready
			document.addEventListener('deviceready', onDeviceReady, false);
			errorService.log('script running');
	</script>
</body>
</html>